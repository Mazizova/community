<!doctype html><html lang=en prefix="og: https://ogp.me/ns#"><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1,minimum-scale=1"><title>Create your own Exporter in Go! | Percona Community</title><meta name=description content="Overview Hi, it’s too hot summer in Korea. Today I want to talk about an interesting and exciting topic. Try to making your own exporter in Go language.
If you …"><link rel="shortcut icon" href=/superhero_huf5968b80ec9b386b36835fc6e8ce3113_170434_64x64_resize_lanczos_2.png type=image/png><link rel=canonical href=https://percona.community/blog/2021/07/21/create-your-own-exporter-in-go/><meta name=robots content="index,follow"><meta property="og:title" content="Create your own Exporter in Go!"><meta property="og:description" content="Overview Hi, it’s too hot summer in Korea. Today I want to talk about an interesting and exciting topic. Try to making your own exporter in Go language.
If you register a specific query, it is a simple program that shows the result of this query as an exporter result metrics. Some of you may still be unfamiliar with what Expoter is.
I will explain about Exporter step by step in today’s post."><meta property="og:type" content="article"><meta property="og:url" content="https://percona.community/blog/2021/07/21/create-your-own-exporter-in-go/"><meta name=image property="og:image" content="https://percona.community/blog/2021/07/query-exporter_hu3d46a279a7a200c6a8c0b4187a7a38cc_82920_1200x0_resize_q90_bgffffff_lanczos_2.jpg"><meta property="article:published_time" content="2021-07-21T00:00:00+00:00"><meta property="article:modified_time" content="2021-07-21T00:00:00+00:00"><meta property="article:author" content="https://www.facebook.com/https://www.facebook.com/dongchan.sung"><meta property="article:section" content="blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://percona.community/blog/2021/07/query-exporter.png"><meta name=twitter:title content="Create your own Exporter in Go! | Percona Community"><meta name=twitter:description content="Overview Hi, it’s too hot summer in Korea. Today I want to talk about an interesting and exciting topic. Try to making your own exporter in Go language.
If you register a specific query, it is a simple program that shows the result of this query as an exporter result metrics. Some of you may still be unfamiliar with what Expoter is.
I will explain about Exporter step by step in today’s post."><meta name=twitter:site content="@Percona"><meta name=copyright content="© Percona Community. MySQL, InnoDB, MariaDB and MongoDB are trademarks of their respective owners.
"><meta name=author content="Dongchan Sung"><style>@charset "UTF-8";html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td,article,aside,canvas,details,embed,figure,figcaption,footer,header,hgroup,menu,nav,output,ruby,section,summary,time,mark,audio,video{margin:0;padding:0;border:0;vertical-align:baseline}article,aside,details,figcaption,figure,footer,header,hgroup,menu,nav,section{display:block}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after{content:none}q:before,q:after{content:none}table{border-collapse:collapse;border-spacing:0}html,body{font-family:Arial,sans-serif;scroll-behavior:smooth;text-rendering:optimizeSpeed;-webkit-font-smoothing:antialiased;line-height:1.5rem;font-feature-settings:"liga" 1;font-weight:400;font-size:18px}@media(min-width:900px){html,body{font-size:20px}}@media(min-width:1100px){html,body{font-size:22px}}@media(min-width:1800px){html,body{font-size:24px}}@media print{html,body{font-size:18px}}hr{border:0;height:2px;background-color:#fe7f2d;margin-top:1.5rem;margin-bottom:1.5rem}.text{position:relative}.text .meta{font-variant:small-caps}.text .meta .byline{display:none}.text .meta .line{display:inline-block}.text .meta .calendar{display:none}.text h1,.text h2,.text h3,.text h4,.text h5,.text h6{font-family:Georgia,palatino linotype,book antiqua,Palatino,times new roman,serif;font-weight:400;page-break-after:avoid}.text h1 a,.text h1 a:visited,.text h2 a,.text h2 a:visited,.text h3 a,.text h3 a:visited,.text h4 a,.text h4 a:visited,.text h5 a,.text h5 a:visited,.text h6 a,.text h6 a:visited{color:#333;text-decoration:none}.text p,.text ul,.text ol,.text figure,.text dl,.text hr{margin-top:.75rem;font-size:1rem;line-height:1.75rem}.text q{font-style:italic}.text ul ul{margin-top:0}.text p>code,.text ul>code,.text ol>code,.text dt>code,.text dd>code,.text li>code{color:#004966}.text audio{display:block;width:100%;height:1.5rem;outline:none}.text audio span{line-height:1.5rem}.text dl{overflow:auto;position:relative}.text dt{font-weight:700}.text dd{padding-left:2rem}.text dd+dt{margin-top:1.5rem}.text ul{list-style-type:disc;padding-left:1.5rem}.text ol{list-style-type:decimal;padding-left:1.5rem}.text p{overflow-wrap:break-word;word-wrap:break-word;-webkit-hyphens:auto;-moz-hyphens:auto;-ms-hyphens:auto;hyphens:auto}.text h1{font-size:2rem;font-weight:400;line-height:2.5rem;margin-top:1.5rem;margin-bottom:0}@media screen and (min-width:760px){.text h1{font-size:2rem;line-height:2.5rem;margin-top:1.5rem}}@media screen and (min-width:900px){.text h1{font-size:2.5rem;line-height:3rem;margin-top:3rem}}@media screen and (min-width:1200px){.text h1{font-size:3rem;line-height:4rem;margin-top:3rem}}.text h2{font-size:1.5rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem}.text h3{font-size:1.25rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem}.text h4{font-size:1rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem;font-size:1.1rem}.text h5{font-size:.8rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem}.text h6{font-size:.6rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem}.text strong{font-weight:700}.text em{font-style:italic}.text code{font-family:lucida console,Monaco,monospace;speak:literal-punctuation}.text abbr,.text acronym{speak:spell-out}.text del{text-decoration:line-through}.text ins{text-decoration:none;font-style:italic}.text figure{position:relative;text-align:center}.text figure img{background:#fff;border-radius:.2rem;max-width:100%}.text figure table{min-width:75%;border-radius:.2rem;margin-left:auto;margin-right:auto;border:#004966;border-collapse:separate;border-spacing:0;background:#fff;margin-bottom:-.1em}.text figure table th,.text figure table td{padding-left:.75rem;padding-right:.75rem;line-height:1.3rem;border-left:.1rem solid #004966;border-top:.1rem solid #004966}.text figure table thead{background-color:#fff}.text figure table tr td:last-child,.text figure table tr th:last-child{border-right:.1rem solid #004966}.text figure table tbody:last-child tr:last-child td{border-bottom:.1rem solid #004966}.text figure table thead:first-child tr:first-child th:first-child,.text figure table thead:first-child tr:first-child td:first-child{border-top-left-radius:.2rem}.text figure table thead:first-child tr:first-child,.text figure table thead:first-child tr:first-child th:last-child,.text figure table thead:first-child tr:first-child td:last-child{border-top-right-radius:.2rem}.text figure table tbody:last-child tr:last-child,.text figure table tbody:last-child tr:last-child td:first-child{border-bottom-left-radius:.2rem}.text figure table tbody:last-child tr:last-child,.text figure table tbody:last-child tr:last-child td:last-child{border-bottom-right-radius:.2rem}.text figure ul{text-align:left}.text figure ul.tree{padding-top:1.5em;padding-bottom:1.5em;border-radius:.2rem;background:#fff}.text figure ul.tree li{list-style-type:none}.text figure ul.tree .tree__item--folder::before{content:"📁";margin-right:.2em}.text figure ul.tree .tree__item--file::before{content:"📝";margin-right:.2em}.text figure figcaption{font-style:italic}.text pre{margin-top:1.5rem;font-size:inherit;line-height:1.5rem;padding:1.5rem 1.5rem .75rem;white-space:pre;overflow-x:scroll;overflow-y:hidden;scrollbar-color:#cccccc transparent;scrollbar-width:.75rem}.text pre::-webkit-scrollbar{margin-top:-.75rem;height:.75rem}.text pre::-webkit-scrollbar-track{background:0 0}.text pre::-webkit-scrollbar-thumb{height:.1rem;border-radius:.2rem;background:#ccc}.text hr{border:0;height:.2rem;background:#004966;margin-top:1.3rem}.text .admonition{position:relative}.text .admonition>*{padding-left:2rem}.text .admonition>:first-child::before{display:block;text-align:left;position:absolute;top:0;left:0;width:.75rem;font-size:1rem;line-height:1.5rem;height:1.5rem}.text .admonition--tip>:first-child::before{content:"☛";color:#fefefe;font-size:1.5rem;line-height:1.5rem;height:1.5rem}.text .admonition--warning>:first-child::before{content:"⚠️";color:#fefefe}.text .admonition--info>:first-child::before{content:"ⓘ";color:#004966;font-weight:700}@media print{.text h1{margin-left:auto;margin-right:auto;margin-top:9rem;width:80%;font-variant:small-caps;text-align:center}.text--simple h1{margin-top:0}.text .meta{page-break-after:always;text-align:center;font-size:1.2rem;margin-top:1.5rem}.text .meta a{text-decoration:none}.text .meta time{display:none}.text .body p:first-of-type{margin-top:0}.text pre{padding:0;font-size:inherit;line-height:1.5rem;overflow:hidden;white-space:pre-wrap;word-break:break-all}}.text .podcasts{margin-top:1.5rem;text-align:center}.text a.podcast{display:block;height:3rem}.text a.podcast img{width:50%;max-width:200px}@media screen and (min-width:768px){.text .podcasts{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));grid-gap:1.5rem}.text a.podcast img{width:100%}}.text .tombstone{opacity:0}html,body{min-height:100vh}body{text-align:center}@media screen{body{color:#333;background-color:#fefefe}}@media print{body{color:#000;background:#fff}}@media screen{body{display:flex;flex-direction:column}main.page{width:100%;flex:1}}header.page,main.page,footer.page{text-align:left}.page-main,.contentblock{max-width:1200px;padding-left:1.5rem;padding-right:1.5rem;margin-left:auto;margin-right:auto}@media print{.page-main,.contentblock{padding:0}}@page{size:A4;padding:0;margin:3rem}.highlight{color:#004966}.nobr{white-space:nowrap}.aria-only{display:none}@media aural{.aria-only{display:block}}button{cursor:pointer;display:block;font-weight:700;margin:0 auto;border:.1rem solid #fe7f2d;background-color:#fe7f2d;font-size:1.2rem;border-radius:.9rem;padding:.6rem;transition:color .233s ease-in-out,background-color .233s ease-in-out}button:hover{background-color:#004966;border:.1rem solid #004966}blockquote{padding:0 2rem;margin:0 2rem}blockquote:before{display:block;content:"\1f5e8";font-size:2rem;padding:1rem 0 0;margin:0 0 -1.8rem -2rem;height:max-content;color:#fe7f2d;font-weight:700}a{color:#004966;font-weight:700;text-decoration-color:#004966;transition:color .233s ease-out,text-decoration-color .233s ease-out}a:hover,a:visited:hover{color:#fe7f2d;text-decoration-color:#fe7f2d}a:active{color:#fe7f2d;text-decoration-color:#fe7f2d}a:visited{color:#333}a.downloadbtn{text-decoration:none}html,body{font-family:Arial,sans-serif;scroll-behavior:smooth;text-rendering:optimizeSpeed;-webkit-font-smoothing:antialiased;line-height:1.5rem;font-feature-settings:"liga" 1;font-weight:400;font-size:18px}@media(min-width:900px){html,body{font-size:20px}}@media(min-width:1100px){html,body{font-size:22px}}@media(min-width:1800px){html,body{font-size:24px}}@media print{html,body{font-size:18px}}hr{border:0;height:2px;background-color:#fe7f2d;margin-top:1.5rem;margin-bottom:1.5rem}.text{position:relative}.text .meta{font-variant:small-caps}.text .meta .byline{display:none}.text .meta .line{display:inline-block}.text .meta .calendar{display:none}.text h1,.text h2,.text h3,.text h4,.text h5,.text h6{font-family:Georgia,palatino linotype,book antiqua,Palatino,times new roman,serif;font-weight:400;page-break-after:avoid}.text h1 a,.text h1 a:visited,.text h2 a,.text h2 a:visited,.text h3 a,.text h3 a:visited,.text h4 a,.text h4 a:visited,.text h5 a,.text h5 a:visited,.text h6 a,.text h6 a:visited{color:#333;text-decoration:none}.text p,.text ul,.text ol,.text figure,.text dl,.text hr{margin-top:.75rem;font-size:1rem;line-height:1.75rem}.text q{font-style:italic}.text ul ul{margin-top:0}.text p>code,.text ul>code,.text ol>code,.text dt>code,.text dd>code,.text li>code{color:#004966}.text audio{display:block;width:100%;height:1.5rem;outline:none}.text audio span{line-height:1.5rem}.text dl{overflow:auto;position:relative}.text dt{font-weight:700}.text dd{padding-left:2rem}.text dd+dt{margin-top:1.5rem}.text ul{list-style-type:disc;padding-left:1.5rem}.text ol{list-style-type:decimal;padding-left:1.5rem}.text p{overflow-wrap:break-word;word-wrap:break-word;-webkit-hyphens:auto;-moz-hyphens:auto;-ms-hyphens:auto;hyphens:auto}.text h1{font-size:2rem;font-weight:400;line-height:2.5rem;margin-top:1.5rem;margin-bottom:0}@media screen and (min-width:760px){.text h1{font-size:2rem;line-height:2.5rem;margin-top:1.5rem}}@media screen and (min-width:900px){.text h1{font-size:2.5rem;line-height:3rem;margin-top:3rem}}@media screen and (min-width:1200px){.text h1{font-size:3rem;line-height:4rem;margin-top:3rem}}.text h2{font-size:1.5rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem}.text h3{font-size:1.25rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem}.text h4{font-size:1rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem;font-size:1.1rem}.text h5{font-size:.8rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem}.text h6{font-size:.6rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem}.text strong{font-weight:700}.text em{font-style:italic}.text code{font-family:lucida console,Monaco,monospace;speak:literal-punctuation}.text abbr,.text acronym{speak:spell-out}.text del{text-decoration:line-through}.text ins{text-decoration:none;font-style:italic}.text figure{position:relative;text-align:center}.text figure img{background:#fff;border-radius:.2rem;max-width:100%}.text figure table{min-width:75%;border-radius:.2rem;margin-left:auto;margin-right:auto;border:#004966;border-collapse:separate;border-spacing:0;background:#fff;margin-bottom:-.1em}.text figure table th,.text figure table td{padding-left:.75rem;padding-right:.75rem;line-height:1.3rem;border-left:.1rem solid #004966;border-top:.1rem solid #004966}.text figure table thead{background-color:#fff}.text figure table tr td:last-child,.text figure table tr th:last-child{border-right:.1rem solid #004966}.text figure table tbody:last-child tr:last-child td{border-bottom:.1rem solid #004966}.text figure table thead:first-child tr:first-child th:first-child,.text figure table thead:first-child tr:first-child td:first-child{border-top-left-radius:.2rem}.text figure table thead:first-child tr:first-child,.text figure table thead:first-child tr:first-child th:last-child,.text figure table thead:first-child tr:first-child td:last-child{border-top-right-radius:.2rem}.text figure table tbody:last-child tr:last-child,.text figure table tbody:last-child tr:last-child td:first-child{border-bottom-left-radius:.2rem}.text figure table tbody:last-child tr:last-child,.text figure table tbody:last-child tr:last-child td:last-child{border-bottom-right-radius:.2rem}.text figure ul{text-align:left}.text figure ul.tree{padding-top:1.5em;padding-bottom:1.5em;border-radius:.2rem;background:#fff}.text figure ul.tree li{list-style-type:none}.text figure ul.tree .tree__item--folder::before{content:"📁";margin-right:.2em}.text figure ul.tree .tree__item--file::before{content:"📝";margin-right:.2em}.text figure figcaption{font-style:italic}.text pre{margin-top:1.5rem;font-size:inherit;line-height:1.5rem;padding:1.5rem 1.5rem .75rem;white-space:pre;overflow-x:scroll;overflow-y:hidden;scrollbar-color:#cccccc transparent;scrollbar-width:.75rem}.text pre::-webkit-scrollbar{margin-top:-.75rem;height:.75rem}.text pre::-webkit-scrollbar-track{background:0 0}.text pre::-webkit-scrollbar-thumb{height:.1rem;border-radius:.2rem;background:#ccc}.text hr{border:0;height:.2rem;background:#004966;margin-top:1.3rem}.text .admonition{position:relative}.text .admonition>*{padding-left:2rem}.text .admonition>:first-child::before{display:block;text-align:left;position:absolute;top:0;left:0;width:.75rem;font-size:1rem;line-height:1.5rem;height:1.5rem}.text .admonition--tip>:first-child::before{content:"☛";color:#fefefe;font-size:1.5rem;line-height:1.5rem;height:1.5rem}.text .admonition--warning>:first-child::before{content:"⚠️";color:#fefefe}.text .admonition--info>:first-child::before{content:"ⓘ";color:#004966;font-weight:700}@media print{.text h1{margin-left:auto;margin-right:auto;margin-top:9rem;width:80%;font-variant:small-caps;text-align:center}.text--simple h1{margin-top:0}.text .meta{page-break-after:always;text-align:center;font-size:1.2rem;margin-top:1.5rem}.text .meta a{text-decoration:none}.text .meta time{display:none}.text .body p:first-of-type{margin-top:0}.text pre{padding:0;font-size:inherit;line-height:1.5rem;overflow:hidden;white-space:pre-wrap;word-break:break-all}}.text .podcasts{margin-top:1.5rem;text-align:center}.text a.podcast{display:block;height:3rem}.text a.podcast img{width:50%;max-width:200px}@media screen and (min-width:768px){.text .podcasts{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));grid-gap:1.5rem}.text a.podcast img{width:100%}}.text .tombstone{opacity:0}.cmp-revoke-consent{bottom:0!important;left:0!important;position:relative!important;padding:0!important}.page-header a{display:block;text-decoration:none;height:2.6rem;line-height:2.6rem;border-top:.2rem solid transparent;border-bottom:.2rem solid transparent}.page-header a,.page-header a span{transition:color .233s ease-in-out,border-bottom .233s,margin-bottom .233s}.page-header a:hover{color:#004966;border-bottom:.2rem solid #004966}.page-header a:hover span{color:#004966}.page-header a img{height:2.6rem}.page-header a{color:#333;border-bottom:0 solid #fefefe}.page-header a:hover{color:#004966;border-bottom-color:#004966}.page-header a:visited{color:#333}.page-header a{display:block;border-bottom-width:.2rem;font-weight:400;font-size:.8rem}.page-header .logo{z-index:6;font-size:1.2rem;font-weight:700;font-variant:small-caps}.page-header .logo a{margin-top:.2rem;text-decoration:none;display:block;border:none}#show-mobile-menu{display:none}.mobile-toggle{display:none}@media screen and (max-width:999px){header.page{box-shadow:0 0 3px rgba(168,168,168,.5)}.logo a{position:absolute}.page-header{justify-content:space-between;z-index:1}.page-header a{border-bottom-width:0}.hamburger-bar{height:.2rem;background:#333;margin-top:.2rem;display:block}#show-mobile-menu+.mobile-toggle+.mobile-menu nav{background:#fefefe}#show-mobile-menu+.mobile-toggle .hamburger-bar{transform:translateY(0)rotate(0);opacity:1;transition:transform .233s ease-in-out,opacity .233s ease-in-out}#show-mobile-menu:checked+.mobile-toggle{position:fixed;right:1.5rem}#show-mobile-menu:checked+.mobile-toggle .hamburger-bar:nth-of-type(1){transform:translateY(.4rem)rotate(315deg)}#show-mobile-menu:checked+.mobile-toggle .hamburger-bar:nth-of-type(2){opacity:0}#show-mobile-menu:checked+.mobile-toggle .hamburger-bar:nth-of-type(3){transform:translateY(-.4rem)rotate(405deg)}.mobile-toggle{cursor:pointer;display:block;width:1.2rem;height:1rem;z-index:5;margin-top:.75rem}.mobile-toggle label,.mobile-toggle .hamburger-bar{cursor:pointer}.mobile-menu{overflow:hidden;position:fixed;top:0;left:0;right:0;bottom:100vh;opacity:0;background:rgba(0,0,0,.5);transition:opacity .233s ease-in-out,border-bottom-color .233s ease-in-out}#show-mobile-menu:checked+.mobile-toggle+.mobile-menu{opacity:1;bottom:0}.hide-mobile-menu{display:block;position:absolute;top:0;left:0;right:0;bottom:0;z-index:2}.mobile-menu nav{box-sizing:border-box;max-height:100%;position:absolute;top:0;left:0;right:0;z-index:3;font-size:1rem;line-height:3rem;padding:3rem 1.5rem 1.5rem;display:flex;flex-direction:column}.mobile-menu nav header{display:flex;flex-direction:row;font-size:inherit;line-height:inherit}.mobile-menu nav header h1{margin-top:0;font-size:1.2rem;line-height:1.5rem;flex:1;font-variant:small-caps}.mobile-menu nav header .hide-mobile-menu-aria{display:block;z-index:10;height:1.5rem;width:1.5rem}.mobile-menu nav ul{overflow-y:scroll;flex:1;scrollbar-width:none;-ms-overflow-style:none}.mobile-menu nav ul::-webkit-scrollbar{width:0;background:0 0}.mobile-menu nav a{font-weight:700;font-size:1rem}.mobile-menu nav a:hover{border-bottom:0;margin-bottom:0}}@media screen and (min-width:1000px){.page-header .mobile-toggle{display:none}.page-header .mobile-menu{flex:1}.page-header nav{flex:1}.page-header nav header{display:none}.page-header ul{list-style-type:none}.page-header nav ul{display:flex;align-items:end;justify-content:flex-end;flex-direction:row}.page-header nav li{padding-left:1.5rem}.page-header nav li.active a{border-bottom-width:3px;border-bottom-color:#004966}}@media screen{.page-header{position:relative;max-width:1200px;margin-left:auto;margin-right:auto;padding-left:1.5rem;padding-right:1.5rem;height:3rem;display:flex;flex-direction:row}}@media print{header.page{display:none}}@media screen and (max-width:999px) and (prefers-reduced-motion:reduce){.mobile-menu{transition:none}#show-mobile-menu+.mobile-toggle .hamburger-bar{transition:none}}@media screen and (max-width:999px) and (prefers-reduced-transparency:reduce){.mobile-menu{background:gray}}.page-header nav li{position:relative}.page-header nav li:hover ul.submenu__list{display:flex;z-index:999}.page-header nav ul.submenu__list{display:none;flex-direction:column;background:#fff;position:absolute;left:0}.page-header nav ul.submenu__list li{padding:0 20px}.page-header nav ul.submenu__list li a{white-space:nowrap}@media(max-width:768px){.page-header nav ul.submenu__list{display:flex;position:static}.page-header nav ul.submenu__list li a{font-weight:400}}html,body{font-family:Arial,sans-serif;scroll-behavior:smooth;text-rendering:optimizeSpeed;-webkit-font-smoothing:antialiased;line-height:1.5rem;font-feature-settings:"liga" 1;font-weight:400;font-size:18px}@media(min-width:900px){html,body{font-size:20px}}@media(min-width:1100px){html,body{font-size:22px}}@media(min-width:1800px){html,body{font-size:24px}}@media print{html,body{font-size:18px}}hr{border:0;height:2px;background-color:#fe7f2d;margin-top:1.5rem;margin-bottom:1.5rem}.text{position:relative}.text .meta{font-variant:small-caps}.text .meta .byline{display:none}.text .meta .line{display:inline-block}.text .meta .calendar{display:none}.text h1,.text h2,.text h3,.text h4,.text h5,.text h6{font-family:Georgia,palatino linotype,book antiqua,Palatino,times new roman,serif;font-weight:400;page-break-after:avoid}.text h1 a,.text h1 a:visited,.text h2 a,.text h2 a:visited,.text h3 a,.text h3 a:visited,.text h4 a,.text h4 a:visited,.text h5 a,.text h5 a:visited,.text h6 a,.text h6 a:visited{color:#333;text-decoration:none}.text p,.text ul,.text ol,.text figure,.text dl,.text hr{margin-top:.75rem;font-size:1rem;line-height:1.75rem}.text q{font-style:italic}.text ul ul{margin-top:0}.text p>code,.text ul>code,.text ol>code,.text dt>code,.text dd>code,.text li>code{color:#004966}.text audio{display:block;width:100%;height:1.5rem;outline:none}.text audio span{line-height:1.5rem}.text dl{overflow:auto;position:relative}.text dt{font-weight:700}.text dd{padding-left:2rem}.text dd+dt{margin-top:1.5rem}.text ul{list-style-type:disc;padding-left:1.5rem}.text ol{list-style-type:decimal;padding-left:1.5rem}.text p{overflow-wrap:break-word;word-wrap:break-word;-webkit-hyphens:auto;-moz-hyphens:auto;-ms-hyphens:auto;hyphens:auto}.text h1{font-size:2rem;font-weight:400;line-height:2.5rem;margin-top:1.5rem;margin-bottom:0}@media screen and (min-width:760px){.text h1{font-size:2rem;line-height:2.5rem;margin-top:1.5rem}}@media screen and (min-width:900px){.text h1{font-size:2.5rem;line-height:3rem;margin-top:3rem}}@media screen and (min-width:1200px){.text h1{font-size:3rem;line-height:4rem;margin-top:3rem}}.text h2{font-size:1.5rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem}.text h3{font-size:1.25rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem}.text h4{font-size:1rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem;font-size:1.1rem}.text h5{font-size:.8rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem}.text h6{font-size:.6rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem}.text strong{font-weight:700}.text em{font-style:italic}.text code{font-family:lucida console,Monaco,monospace;speak:literal-punctuation}.text abbr,.text acronym{speak:spell-out}.text del{text-decoration:line-through}.text ins{text-decoration:none;font-style:italic}.text figure{position:relative;text-align:center}.text figure img{background:#fff;border-radius:.2rem;max-width:100%}.text figure table{min-width:75%;border-radius:.2rem;margin-left:auto;margin-right:auto;border:#004966;border-collapse:separate;border-spacing:0;background:#fff;margin-bottom:-.1em}.text figure table th,.text figure table td{padding-left:.75rem;padding-right:.75rem;line-height:1.3rem;border-left:.1rem solid #004966;border-top:.1rem solid #004966}.text figure table thead{background-color:#fff}.text figure table tr td:last-child,.text figure table tr th:last-child{border-right:.1rem solid #004966}.text figure table tbody:last-child tr:last-child td{border-bottom:.1rem solid #004966}.text figure table thead:first-child tr:first-child th:first-child,.text figure table thead:first-child tr:first-child td:first-child{border-top-left-radius:.2rem}.text figure table thead:first-child tr:first-child,.text figure table thead:first-child tr:first-child th:last-child,.text figure table thead:first-child tr:first-child td:last-child{border-top-right-radius:.2rem}.text figure table tbody:last-child tr:last-child,.text figure table tbody:last-child tr:last-child td:first-child{border-bottom-left-radius:.2rem}.text figure table tbody:last-child tr:last-child,.text figure table tbody:last-child tr:last-child td:last-child{border-bottom-right-radius:.2rem}.text figure ul{text-align:left}.text figure ul.tree{padding-top:1.5em;padding-bottom:1.5em;border-radius:.2rem;background:#fff}.text figure ul.tree li{list-style-type:none}.text figure ul.tree .tree__item--folder::before{content:"📁";margin-right:.2em}.text figure ul.tree .tree__item--file::before{content:"📝";margin-right:.2em}.text figure figcaption{font-style:italic}.text pre{margin-top:1.5rem;font-size:inherit;line-height:1.5rem;padding:1.5rem 1.5rem .75rem;white-space:pre;overflow-x:scroll;overflow-y:hidden;scrollbar-color:#cccccc transparent;scrollbar-width:.75rem}.text pre::-webkit-scrollbar{margin-top:-.75rem;height:.75rem}.text pre::-webkit-scrollbar-track{background:0 0}.text pre::-webkit-scrollbar-thumb{height:.1rem;border-radius:.2rem;background:#ccc}.text hr{border:0;height:.2rem;background:#004966;margin-top:1.3rem}.text .admonition{position:relative}.text .admonition>*{padding-left:2rem}.text .admonition>:first-child::before{display:block;text-align:left;position:absolute;top:0;left:0;width:.75rem;font-size:1rem;line-height:1.5rem;height:1.5rem}.text .admonition--tip>:first-child::before{content:"☛";color:#fefefe;font-size:1.5rem;line-height:1.5rem;height:1.5rem}.text .admonition--warning>:first-child::before{content:"⚠️";color:#fefefe}.text .admonition--info>:first-child::before{content:"ⓘ";color:#004966;font-weight:700}@media print{.text h1{margin-left:auto;margin-right:auto;margin-top:9rem;width:80%;font-variant:small-caps;text-align:center}.text--simple h1{margin-top:0}.text .meta{page-break-after:always;text-align:center;font-size:1.2rem;margin-top:1.5rem}.text .meta a{text-decoration:none}.text .meta time{display:none}.text .body p:first-of-type{margin-top:0}.text pre{padding:0;font-size:inherit;line-height:1.5rem;overflow:hidden;white-space:pre-wrap;word-break:break-all}}.text .podcasts{margin-top:1.5rem;text-align:center}.text a.podcast{display:block;height:3rem}.text a.podcast img{width:50%;max-width:200px}@media screen and (min-width:768px){.text .podcasts{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));grid-gap:1.5rem}.text a.podcast img{width:100%}}.text .tombstone{opacity:0}html,body{min-height:100vh}body{text-align:center}@media screen{body{color:#333;background-color:#fefefe}}@media print{body{color:#000;background:#fff}}@media screen{body{display:flex;flex-direction:column}main.page{width:100%;flex:1}}header.page,main.page,footer.page{text-align:left}.page-main,.contentblock{max-width:1200px;padding-left:1.5rem;padding-right:1.5rem;margin-left:auto;margin-right:auto}@media print{.page-main,.contentblock{padding:0}}@page{size:A4;padding:0;margin:3rem}.highlight{color:#004966}.nobr{white-space:nowrap}.aria-only{display:none}@media aural{.aria-only{display:block}}.cmp-revoke-consent{bottom:0!important;left:0!important;position:relative!important;padding:0!important}footer.page{margin-top:1.5rem}footer.page h2{font-size:1rem}@media not print{footer.page{margin-top:1.5rem/2;padding-top:1.5rem/2;padding-bottom:1.5rem/2}.page-footer{max-width:1200px;padding-left:1.5rem;padding-right:1.5rem;margin-left:auto;margin-right:auto;font-size:.7rem;line-height:1.5rem}}@media not print{.page-footer ul{margin-bottom:1.5rem}.page-footer a{display:block;text-decoration:none;height:2.6rem;line-height:2.6rem;border-top:.2rem solid transparent;border-bottom:.2rem solid transparent}.page-footer a,.page-footer a span{transition:color .233s ease-in-out,border-bottom .233s,margin-bottom .233s}.page-footer a:hover{color:#004966;border-bottom:.2rem solid #004966}.page-footer a:hover span{color:#004966}.page-footer a img{height:2.6rem}.page-footer nav ul{display:flex;flex-direction:row;align-items:center;justify-content:center;flex-wrap:wrap;margin-bottom:0;height:1.5rem;line-height:.5rem}.page-footer nav ul a{height:1.3rem;line-height:1.3rem;text-align:center;display:block;padding-left:.75rem;padding-right:.75rem;border-bottom:.2rem solid transparent}}@media print{footer.page nav{display:none}footer.page aside{border-top:.2rem solid #333;margin-top:.65rem;padding-top:.65rem}}footer.page{border-top:2px solid #fe7f2d;margin-top:-2px}footer.page aside{text-align:center;font-size:.6rem;line-height:1.5rem;color:#333}@media screen{footer.page{background-color:#fefefe}.page-footer a{color:#333;border-bottom:0 solid #fefefe}.page-footer a:hover{color:#004966;border-bottom-color:#004966}.page-footer a:visited{color:#333}}@media screen and (max-width:570px){footer.page aside{margin-top:10%}}@media screen and (max-width:370px){footer.page aside{margin-top:20%}}.youtubeList__container{display:flex;flex-direction:row;justify-content:flex-start;margin-bottom:1.5rem}.youtubeList__container .youtubeList__img{margin-right:1rem}.grid{display:grid;gap:1.5rem 1.5rem;font-size:.9rem;margin-bottom:1.5rem;margin-top:1.5rem}.grid--2{grid-template-columns:1fr 1fr}.grid--3{grid-template-columns:1fr 1fr 1fr}.grid--4{grid-template-columns:1fr 1fr 1fr 1fr}.grid img{max-width:100%}.grid h2{font-size:1rem;line-height:1.25rem;margin-bottom:.75rem}.grid p{font-size:.75rem;line-height:1rem;font-weight:400;margin-bottom:.75rem}.grid ul{margin-left:1rem}.grid ul li{list-style-type:disc}@media(max-width:768px){.grid__item{margin-bottom:1rem}.grid--2{display:block}}@media(max-width:1200px){.grid--3{display:block}}@media(max-width:1200px){.grid--4{display:block}}.grid-links{display:grid;gap:1.5rem 1.5rem;font-size:.9rem;margin-bottom:1.5rem;margin-top:1.5rem}.grid-links--2{grid-template-columns:1fr 1fr}.grid-links--3{grid-template-columns:1fr 1fr 1fr}.grid-links--4{grid-template-columns:1fr 1fr 1fr 1fr}.grid-links img{max-width:100%}.grid-links h2{font-size:1.2rem;margin-bottom:.75rem}.grid-links p{margin-bottom:.75rem}.grid-links ul{margin-left:1rem}.grid-links ul li{list-style-type:disc}@media(max-width:768px){.grid-links--2{display:block}}@media(max-width:1000px){.grid-links--3{display:block}}@media(max-width:1000px){.grid-links--4{display:block}}.post--preview{display:block;border-radius:.3rem;padding-bottom:.375rem}.post--preview img{margin-bottom:.375rem}.post--preview h2,.post--preview h3,.post--preview p{padding-left:.5rem;padding-right:.5rem}.post--preview :last-child{margin-bottom:0}.post--preview:hover{box-shadow:0 0 1.5rem #7f7f7f}a.post--preview,a.post--preview *{text-decoration:none;color:#333}a.post--preview .readmore,a.post--preview * .readmore{font-weight:700}.recommendations{margin-top:2rem}.text .grid h2{font-size:1rem;line-height:1.25rem;margin-bottom:.75rem;margin-top:0;font-weight:700}.text .post__content p{font-size:.75rem;line-height:1rem;font-weight:400}.text .post__content .readmore{font-weight:700}.comments .comment{padding:2em;background:#f5f5f5;border-radius:3%;margin-bottom:2em}.comments .info{margin-bottom:2em}.comments .info a{font-size:1.2em}.comments .info span{float:right;color:#9c98a8;font-style:italic}.home_banner .home_banner__content{max-width:1200px;padding-top:1rem;padding-bottom:.5rem;margin-left:auto;margin-right:auto}.banner{background-color:#004966;background-position:50%;background-repeat:no-repeat;background-size:cover;color:#fff}.banner h1{margin-bottom:1.5rem}.banner .banner__content{max-width:1200px;padding:1.5rem;margin-left:auto;margin-right:auto}.banner .banner__grid{display:grid;gap:1.5rem 1.5rem;grid-template-columns:9fr 3fr;margin-top:1.5rem;margin-bottom:1.5rem}@media screen and (max-width:1000px){.banner .banner__grid{display:block}}.banner .banner__text{font-size:1.2rem;background:rgba(0,0,0,.7);padding:1.5rem;border-radius:.75rem}.banner .banner__text h1{font-size:1.5rem}.banner .banner__text p{margin-top:1.5rem}.banner .banner__text p:first-child{margin-top:0}.banner .banner__text small{font-size:.8rem}.banner .banner__text.opaque{background:rgba(0,0,0,.95)}.banner .banner__text small{font-size:.8rem}.banner .banner__icon{float:right;text-align:center}@media screen and (max-width:1000px){.banner .banner__icon{display:none}}.banner a{color:#fff;font-weight:700;border-bottom:2px solid #004966;text-decoration:none;transition:color .233s ease-out,border-bottom-color .233s ease-out}.banner a:hover,.banner a:visited:hover{color:#fff;border-bottom-color:#fe7f2d}table{border:1px solid #ccc;border-collapse:collapse;margin-top:2rem;padding:0;width:100%;table-layout:fixed}table caption{font-size:1.5em;margin:.5em 0 .75em}table tr{background-color:#f8f8f8;border:1px solid #ddd;padding:.35em}table th,table td{padding:.625em;text-align:left}table th{font-size:1em;letter-spacing:.1em;text-transform:uppercase}@media screen and (max-width:600px){table{border:0}table caption{font-size:1.3em}table thead{border:none;clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}table tr{border-bottom:3px solid #ddd;display:block;margin-bottom:.625em}table td{border-bottom:1px solid #ddd;display:block;font-size:1em;text-align:left}table td::before{content:attr(data-label);float:left;font-weight:700;text-transform:uppercase}table td:last-child{border-bottom:0}}.hero{background-color:#004966;background-position:50%;background-repeat:no-repeat;background-size:cover;color:#fff}.hero h1{margin-bottom:1.5rem;line-height:2.5rem}.hero h2{margin-top:1rem;margin-bottom:1rem}.hero h2{margin-top:1rem;margin-bottom:1rem}.hero a{color:#fff;font-weight:700;border-bottom:2px solid #004966;text-decoration:none;transition:color .233s ease-out,border-bottom-color .233s ease-out}.hero a:hover,.hero a:visited:hover{color:#fff;border-bottom-color:#fe7f2d}@media screen and (max-width:767px){.hero figure{position:relative;text-align:center}}.hero img{float:left;margin-right:1.5rem;max-width:100%}@media screen and (max-width:767px){.hero img{float:none;margin-left:auto;margin-right:auto;display:block}}.hero h2+p+figure img{position:relative;top:-3rem}@media screen and (max-width:767px){.hero h2+p+figure img{top:0}}.hero:nth-child(4n+2),.hero:nth-child(4n+4){background-color:initial;color:#333}.hero:nth-child(4n+2) img,.hero:nth-child(4n+4) img{float:right;margin-right:0;margin-left:1.5rem}@media screen and (max-width:767px){.hero:nth-child(4n+2) img,.hero:nth-child(4n+4) img{float:none;margin-left:auto;margin-right:auto}}.hero:nth-child(4n+2) a,.hero:nth-child(4n+4) a{color:#333}.hero:nth-child(4n+2) a:hover,.hero:nth-child(4n+4) a:hover{color:#333}.hero:nth-child(4n+3){background-color:#fe7f2d}.hero--bio .contentblock{text-align:center}.hero--bio .contentblock img{text-align:center;float:none;margin-bottom:1.5rem}.hero--bio .contentblock p{text-align:left}@media(min-width:769px){.hero--bio .contentblock{min-height:240px;text-align:left}.hero--bio .contentblock img{float:right;margin-left:1.5rem;margin-bottom:0}}.contentblock{padding-top:2rem;padding-bottom:2rem}.herotext{font-size:1.2rem;background:rgba(0,0,0,.7);padding:1.5rem;border-radius:.75rem}.herotext p{margin-top:1.5rem}.herotext p:first-child{margin-top:0}.herotext small{font-size:.8rem}.herotext.opaque{background:rgba(0,0,0,.95)}html,body{font-family:Arial,sans-serif;scroll-behavior:smooth;text-rendering:optimizeSpeed;-webkit-font-smoothing:antialiased;line-height:1.5rem;font-feature-settings:"liga" 1;font-weight:400;font-size:18px}@media(min-width:900px){html,body{font-size:20px}}@media(min-width:1100px){html,body{font-size:22px}}@media(min-width:1800px){html,body{font-size:24px}}@media print{html,body{font-size:18px}}hr{border:0;height:2px;background-color:#fe7f2d;margin-top:1.5rem;margin-bottom:1.5rem}.text{position:relative}.text .meta{font-variant:small-caps}.text .meta .byline{display:none}.text .meta .line{display:inline-block}.text .meta .calendar{display:none}.text h1,.text h2,.text h3,.text h4,.text h5,.text h6{font-family:Georgia,palatino linotype,book antiqua,Palatino,times new roman,serif;font-weight:400;page-break-after:avoid}.text h1 a,.text h1 a:visited,.text h2 a,.text h2 a:visited,.text h3 a,.text h3 a:visited,.text h4 a,.text h4 a:visited,.text h5 a,.text h5 a:visited,.text h6 a,.text h6 a:visited{color:#333;text-decoration:none}.text p,.text ul,.text ol,.text figure,.text dl,.text hr{margin-top:.75rem;font-size:1rem;line-height:1.75rem}.text q{font-style:italic}.text ul ul{margin-top:0}.text p>code,.text ul>code,.text ol>code,.text dt>code,.text dd>code,.text li>code{color:#004966}.text audio{display:block;width:100%;height:1.5rem;outline:none}.text audio span{line-height:1.5rem}.text dl{overflow:auto;position:relative}.text dt{font-weight:700}.text dd{padding-left:2rem}.text dd+dt{margin-top:1.5rem}.text ul{list-style-type:disc;padding-left:1.5rem}.text ol{list-style-type:decimal;padding-left:1.5rem}.text p{overflow-wrap:break-word;word-wrap:break-word;-webkit-hyphens:auto;-moz-hyphens:auto;-ms-hyphens:auto;hyphens:auto}.text h1{font-size:2rem;font-weight:400;line-height:2.5rem;margin-top:1.5rem;margin-bottom:0}@media screen and (min-width:760px){.text h1{font-size:2rem;line-height:2.5rem;margin-top:1.5rem}}@media screen and (min-width:900px){.text h1{font-size:2.5rem;line-height:3rem;margin-top:3rem}}@media screen and (min-width:1200px){.text h1{font-size:3rem;line-height:4rem;margin-top:3rem}}.text h2{font-size:1.5rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem}.text h3{font-size:1.25rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem}.text h4{font-size:1rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem;font-size:1.1rem}.text h5{font-size:.8rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem}.text h6{font-size:.6rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem}.text strong{font-weight:700}.text em{font-style:italic}.text code{font-family:lucida console,Monaco,monospace;speak:literal-punctuation}.text abbr,.text acronym{speak:spell-out}.text del{text-decoration:line-through}.text ins{text-decoration:none;font-style:italic}.text figure{position:relative;text-align:center}.text figure img{background:#fff;border-radius:.2rem;max-width:100%}.text figure table{min-width:75%;border-radius:.2rem;margin-left:auto;margin-right:auto;border:#004966;border-collapse:separate;border-spacing:0;background:#fff;margin-bottom:-.1em}.text figure table th,.text figure table td{padding-left:.75rem;padding-right:.75rem;line-height:1.3rem;border-left:.1rem solid #004966;border-top:.1rem solid #004966}.text figure table thead{background-color:#fff}.text figure table tr td:last-child,.text figure table tr th:last-child{border-right:.1rem solid #004966}.text figure table tbody:last-child tr:last-child td{border-bottom:.1rem solid #004966}.text figure table thead:first-child tr:first-child th:first-child,.text figure table thead:first-child tr:first-child td:first-child{border-top-left-radius:.2rem}.text figure table thead:first-child tr:first-child,.text figure table thead:first-child tr:first-child th:last-child,.text figure table thead:first-child tr:first-child td:last-child{border-top-right-radius:.2rem}.text figure table tbody:last-child tr:last-child,.text figure table tbody:last-child tr:last-child td:first-child{border-bottom-left-radius:.2rem}.text figure table tbody:last-child tr:last-child,.text figure table tbody:last-child tr:last-child td:last-child{border-bottom-right-radius:.2rem}.text figure ul{text-align:left}.text figure ul.tree{padding-top:1.5em;padding-bottom:1.5em;border-radius:.2rem;background:#fff}.text figure ul.tree li{list-style-type:none}.text figure ul.tree .tree__item--folder::before{content:"📁";margin-right:.2em}.text figure ul.tree .tree__item--file::before{content:"📝";margin-right:.2em}.text figure figcaption{font-style:italic}.text pre{margin-top:1.5rem;font-size:inherit;line-height:1.5rem;padding:1.5rem 1.5rem .75rem;white-space:pre;overflow-x:scroll;overflow-y:hidden;scrollbar-color:#cccccc transparent;scrollbar-width:.75rem}.text pre::-webkit-scrollbar{margin-top:-.75rem;height:.75rem}.text pre::-webkit-scrollbar-track{background:0 0}.text pre::-webkit-scrollbar-thumb{height:.1rem;border-radius:.2rem;background:#ccc}.text hr{border:0;height:.2rem;background:#004966;margin-top:1.3rem}.text .admonition{position:relative}.text .admonition>*{padding-left:2rem}.text .admonition>:first-child::before{display:block;text-align:left;position:absolute;top:0;left:0;width:.75rem;font-size:1rem;line-height:1.5rem;height:1.5rem}.text .admonition--tip>:first-child::before{content:"☛";color:#fefefe;font-size:1.5rem;line-height:1.5rem;height:1.5rem}.text .admonition--warning>:first-child::before{content:"⚠️";color:#fefefe}.text .admonition--info>:first-child::before{content:"ⓘ";color:#004966;font-weight:700}@media print{.text h1{margin-left:auto;margin-right:auto;margin-top:9rem;width:80%;font-variant:small-caps;text-align:center}.text--simple h1{margin-top:0}.text .meta{page-break-after:always;text-align:center;font-size:1.2rem;margin-top:1.5rem}.text .meta a{text-decoration:none}.text .meta time{display:none}.text .body p:first-of-type{margin-top:0}.text pre{padding:0;font-size:inherit;line-height:1.5rem;overflow:hidden;white-space:pre-wrap;word-break:break-all}}.text .podcasts{margin-top:1.5rem;text-align:center}.text a.podcast{display:block;height:3rem}.text a.podcast img{width:50%;max-width:200px}@media screen and (min-width:768px){.text .podcasts{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));grid-gap:1.5rem}.text a.podcast img{width:100%}}.text .tombstone{opacity:0}.paginator{margin-top:1.5rem;text-align:center}.paginator a{display:inline-block;text-decoration:none;border-radius:3px;color:#333;border:1px solid #333;transition:.2s background-color ease-in-out,.2s color ease-in-out,.2s border-color ease-in-out;height:1.5rem;width:1.5rem;line-height:1.5rem;font-size:1rem;margin-left:.2rem;margin-right:.2rem}.paginator a:hover,.paginator a.active{background:#004966;color:#fefefe;border:1px solid #004966}@media screen and (min-width:768px){.paginator a{height:1.5rem;width:1.5rem;line-height:1.5rem;font-size:1rem}}@media screen and (min-width:900px){.paginator a{height:3rem;width:3rem;line-height:3rem;font-size:1.2rem}}html,body{font-family:Arial,sans-serif;scroll-behavior:smooth;text-rendering:optimizeSpeed;-webkit-font-smoothing:antialiased;line-height:1.5rem;font-feature-settings:"liga" 1;font-weight:400;font-size:18px}@media(min-width:900px){html,body{font-size:20px}}@media(min-width:1100px){html,body{font-size:22px}}@media(min-width:1800px){html,body{font-size:24px}}@media print{html,body{font-size:18px}}hr{border:0;height:2px;background-color:#fe7f2d;margin-top:1.5rem;margin-bottom:1.5rem}.text{position:relative}.text .meta{font-variant:small-caps}.text .meta .byline{display:none}.text .meta .line{display:inline-block}.text .meta .calendar{display:none}.text h1,.text h2,.text h3,.text h4,.text h5,.text h6{font-family:Georgia,palatino linotype,book antiqua,Palatino,times new roman,serif;font-weight:400;page-break-after:avoid}.text h1 a,.text h1 a:visited,.text h2 a,.text h2 a:visited,.text h3 a,.text h3 a:visited,.text h4 a,.text h4 a:visited,.text h5 a,.text h5 a:visited,.text h6 a,.text h6 a:visited{color:#333;text-decoration:none}.text p,.text ul,.text ol,.text figure,.text dl,.text hr{margin-top:.75rem;font-size:1rem;line-height:1.75rem}.text q{font-style:italic}.text ul ul{margin-top:0}.text p>code,.text ul>code,.text ol>code,.text dt>code,.text dd>code,.text li>code{color:#004966}.text audio{display:block;width:100%;height:1.5rem;outline:none}.text audio span{line-height:1.5rem}.text dl{overflow:auto;position:relative}.text dt{font-weight:700}.text dd{padding-left:2rem}.text dd+dt{margin-top:1.5rem}.text ul{list-style-type:disc;padding-left:1.5rem}.text ol{list-style-type:decimal;padding-left:1.5rem}.text p{overflow-wrap:break-word;word-wrap:break-word;-webkit-hyphens:auto;-moz-hyphens:auto;-ms-hyphens:auto;hyphens:auto}.text h1{font-size:2rem;font-weight:400;line-height:2.5rem;margin-top:1.5rem;margin-bottom:0}@media screen and (min-width:760px){.text h1{font-size:2rem;line-height:2.5rem;margin-top:1.5rem}}@media screen and (min-width:900px){.text h1{font-size:2.5rem;line-height:3rem;margin-top:3rem}}@media screen and (min-width:1200px){.text h1{font-size:3rem;line-height:4rem;margin-top:3rem}}.text h2{font-size:1.5rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem}.text h3{font-size:1.25rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem}.text h4{font-size:1rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem;font-size:1.1rem}.text h5{font-size:.8rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem}.text h6{font-size:.6rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem}.text strong{font-weight:700}.text em{font-style:italic}.text code{font-family:lucida console,Monaco,monospace;speak:literal-punctuation}.text abbr,.text acronym{speak:spell-out}.text del{text-decoration:line-through}.text ins{text-decoration:none;font-style:italic}.text figure{position:relative;text-align:center}.text figure img{background:#fff;border-radius:.2rem;max-width:100%}.text figure table{min-width:75%;border-radius:.2rem;margin-left:auto;margin-right:auto;border:#004966;border-collapse:separate;border-spacing:0;background:#fff;margin-bottom:-.1em}.text figure table th,.text figure table td{padding-left:.75rem;padding-right:.75rem;line-height:1.3rem;border-left:.1rem solid #004966;border-top:.1rem solid #004966}.text figure table thead{background-color:#fff}.text figure table tr td:last-child,.text figure table tr th:last-child{border-right:.1rem solid #004966}.text figure table tbody:last-child tr:last-child td{border-bottom:.1rem solid #004966}.text figure table thead:first-child tr:first-child th:first-child,.text figure table thead:first-child tr:first-child td:first-child{border-top-left-radius:.2rem}.text figure table thead:first-child tr:first-child,.text figure table thead:first-child tr:first-child th:last-child,.text figure table thead:first-child tr:first-child td:last-child{border-top-right-radius:.2rem}.text figure table tbody:last-child tr:last-child,.text figure table tbody:last-child tr:last-child td:first-child{border-bottom-left-radius:.2rem}.text figure table tbody:last-child tr:last-child,.text figure table tbody:last-child tr:last-child td:last-child{border-bottom-right-radius:.2rem}.text figure ul{text-align:left}.text figure ul.tree{padding-top:1.5em;padding-bottom:1.5em;border-radius:.2rem;background:#fff}.text figure ul.tree li{list-style-type:none}.text figure ul.tree .tree__item--folder::before{content:"📁";margin-right:.2em}.text figure ul.tree .tree__item--file::before{content:"📝";margin-right:.2em}.text figure figcaption{font-style:italic}.text pre{margin-top:1.5rem;font-size:inherit;line-height:1.5rem;padding:1.5rem 1.5rem .75rem;white-space:pre;overflow-x:scroll;overflow-y:hidden;scrollbar-color:#cccccc transparent;scrollbar-width:.75rem}.text pre::-webkit-scrollbar{margin-top:-.75rem;height:.75rem}.text pre::-webkit-scrollbar-track{background:0 0}.text pre::-webkit-scrollbar-thumb{height:.1rem;border-radius:.2rem;background:#ccc}.text hr{border:0;height:.2rem;background:#004966;margin-top:1.3rem}.text .admonition{position:relative}.text .admonition>*{padding-left:2rem}.text .admonition>:first-child::before{display:block;text-align:left;position:absolute;top:0;left:0;width:.75rem;font-size:1rem;line-height:1.5rem;height:1.5rem}.text .admonition--tip>:first-child::before{content:"☛";color:#fefefe;font-size:1.5rem;line-height:1.5rem;height:1.5rem}.text .admonition--warning>:first-child::before{content:"⚠️";color:#fefefe}.text .admonition--info>:first-child::before{content:"ⓘ";color:#004966;font-weight:700}@media print{.text h1{margin-left:auto;margin-right:auto;margin-top:9rem;width:80%;font-variant:small-caps;text-align:center}.text--simple h1{margin-top:0}.text .meta{page-break-after:always;text-align:center;font-size:1.2rem;margin-top:1.5rem}.text .meta a{text-decoration:none}.text .meta time{display:none}.text .body p:first-of-type{margin-top:0}.text pre{padding:0;font-size:inherit;line-height:1.5rem;overflow:hidden;white-space:pre-wrap;word-break:break-all}}.text .podcasts{margin-top:1.5rem;text-align:center}.text a.podcast{display:block;height:3rem}.text a.podcast img{width:50%;max-width:200px}@media screen and (min-width:768px){.text .podcasts{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));grid-gap:1.5rem}.text a.podcast img{width:100%}}.text .tombstone{opacity:0}html,body{min-height:100vh}body{text-align:center}@media screen{body{color:#333;background-color:#fefefe}}@media print{body{color:#000;background:#fff}}@media screen{body{display:flex;flex-direction:column}main.page{width:100%;flex:1}}header.page,main.page,footer.page{text-align:left}.page-main,.contentblock{max-width:1200px;padding-left:1.5rem;padding-right:1.5rem;margin-left:auto;margin-right:auto}@media print{.page-main,.contentblock{padding:0}}@page{size:A4;padding:0;margin:3rem}.highlight{color:#004966}.nobr{white-space:nowrap}.aria-only{display:none}@media aural{.aria-only{display:block}}.edit-on-github{font-size:.8rem;text-align:right;padding-top:1.5rem}.edit-on-github .container{max-width:1200px;padding-left:1.5rem;padding-right:1.5rem;margin-left:auto;margin-right:auto}@media print{.edit-on-github .container{padding:0}}.edit-on-github a{background-color:#fe7f2d;color:#fefefe;text-decoration:none;display:inline-block;border-top-left-radius:.5rem;border-top-right-radius:.5rem;padding-left:.5rem;padding-right:.5rem;transition:.2s background-color ease-in-out}.edit-on-github a:hover{color:#fefefe;background-color:#004966}a.socialblock{display:block;border:0;line-height:1.5rem;position:relative;text-align:center}.hero a.socialblock img{float:none;display:block;margin-left:auto;margin-right:auto;height:3rem;width:3rem}.sharing{margin-top:1em}.sharing .resp-sharing-button__link,.sharing .resp-sharing-button__icon{display:inline-block}.sharing .resp-sharing-button__link{text-decoration:none;color:#fff;margin:.5em}.sharing .resp-sharing-button{border-radius:5px;transition:25ms ease-out;padding-right:.75em;padding-top:.1em}.sharing .resp-sharing-button span{font-size:.75em}@media screen and (max-width:798px){.sharing .resp-sharing-button span{display:none}}.sharing .resp-sharing-button__icon svg{width:1em;height:1em;margin:.4em;margin-top:.3em;vertical-align:top}.sharing .resp-sharing-button--small svg{margin:0;vertical-align:middle}.sharing .resp-sharing-button__icon{stroke:#fff;fill:none}.sharing .resp-sharing-button__icon--solid,.sharing .resp-sharing-button__icon--solidcircle{fill:#fff;stroke:none}.sharing .resp-sharing-button--twitter{background-color:#55acee}.sharing .resp-sharing-button--twitter:hover{background-color:#2795e9}.sharing .resp-sharing-button--pinterest{background-color:#bd081c}.sharing .resp-sharing-button--pinterest:hover{background-color:#8c0615}.sharing .resp-sharing-button--facebook{background-color:#3b5998}.sharing .resp-sharing-button--facebook:hover{background-color:#2d4373}.sharing .resp-sharing-button--tumblr{background-color:#35465c}.sharing .resp-sharing-button--tumblr:hover{background-color:#222d3c}.sharing .resp-sharing-button--reddit{background-color:#5f99cf}.sharing .resp-sharing-button--reddit:hover{background-color:#3a80c1}.sharing .resp-sharing-button--google{background-color:#dd4b39}.sharing .resp-sharing-button--google:hover{background-color:#c23321}.sharing .resp-sharing-button--linkedin{background-color:#0077b5}.sharing .resp-sharing-button--linkedin:hover{background-color:#046293}.sharing .resp-sharing-button--email{background-color:#777}.sharing .resp-sharing-button--email:hover{background-color:#5e5e5e}.sharing .resp-sharing-button--xing{background-color:#1a7576}.sharing .resp-sharing-button--xing:hover{background-color:#114c4c}.sharing .resp-sharing-button--whatsapp{background-color:#25d366}.sharing .resp-sharing-button--whatsapp:hover{background-color:#1da851}.sharing .resp-sharing-button--hackernews{background-color:#f60}.sharing .resp-sharing-button--hackernews:hover,.sharing .resp-sharing-button--hackernews:focus{background-color:#fb6200}.sharing .resp-sharing-button--vk{background-color:#507299}.sharing .resp-sharing-button--vk:hover{background-color:#43648c}.sharing .resp-sharing-button--facebook{background-color:#3b5998;border-color:#3b5998}.sharing .resp-sharing-button--facebook:hover,.sharing .resp-sharing-button--facebook:active{background-color:#2d4373;border-color:#2d4373}.sharing .resp-sharing-button--twitter{background-color:#55acee;border-color:#55acee}.sharing .resp-sharing-button--twitter:hover,.sharing .resp-sharing-button--twitter:active{background-color:#2795e9;border-color:#2795e9}.sharing .resp-sharing-button--linkedin{background-color:#0077b5;border-color:#0077b5}.sharing .resp-sharing-button--linkedin:hover,.sharing .resp-sharing-button--linkedin:active{background-color:#046293;border-color:#046293}.sharing .resp-sharing-button--telegram{background-color:#54a9eb}.sharing .resp-sharing-button--telegram:hover{background-color:#4b97d1}html,body{font-family:Arial,sans-serif;scroll-behavior:smooth;text-rendering:optimizeSpeed;-webkit-font-smoothing:antialiased;line-height:1.5rem;font-feature-settings:"liga" 1;font-weight:400;font-size:18px}@media(min-width:900px){html,body{font-size:20px}}@media(min-width:1100px){html,body{font-size:22px}}@media(min-width:1800px){html,body{font-size:24px}}@media print{html,body{font-size:18px}}hr{border:0;height:2px;background-color:#fe7f2d;margin-top:1.5rem;margin-bottom:1.5rem}.text{position:relative}.text .meta{font-variant:small-caps}.text .meta .byline{display:none}.text .meta .line{display:inline-block}.text .meta .calendar{display:none}.text h1,.text h2,.text h3,.text h4,.text h5,.text h6{font-family:Georgia,palatino linotype,book antiqua,Palatino,times new roman,serif;font-weight:400;page-break-after:avoid}.text h1 a,.text h1 a:visited,.text h2 a,.text h2 a:visited,.text h3 a,.text h3 a:visited,.text h4 a,.text h4 a:visited,.text h5 a,.text h5 a:visited,.text h6 a,.text h6 a:visited{color:#333;text-decoration:none}.text p,.text ul,.text ol,.text figure,.text dl,.text hr{margin-top:.75rem;font-size:1rem;line-height:1.75rem}.text q{font-style:italic}.text ul ul{margin-top:0}.text p>code,.text ul>code,.text ol>code,.text dt>code,.text dd>code,.text li>code{color:#004966}.text audio{display:block;width:100%;height:1.5rem;outline:none}.text audio span{line-height:1.5rem}.text dl{overflow:auto;position:relative}.text dt{font-weight:700}.text dd{padding-left:2rem}.text dd+dt{margin-top:1.5rem}.text ul{list-style-type:disc;padding-left:1.5rem}.text ol{list-style-type:decimal;padding-left:1.5rem}.text p{overflow-wrap:break-word;word-wrap:break-word;-webkit-hyphens:auto;-moz-hyphens:auto;-ms-hyphens:auto;hyphens:auto}.text h1{font-size:2rem;font-weight:400;line-height:2.5rem;margin-top:1.5rem;margin-bottom:0}@media screen and (min-width:760px){.text h1{font-size:2rem;line-height:2.5rem;margin-top:1.5rem}}@media screen and (min-width:900px){.text h1{font-size:2.5rem;line-height:3rem;margin-top:3rem}}@media screen and (min-width:1200px){.text h1{font-size:3rem;line-height:4rem;margin-top:3rem}}.text h2{font-size:1.5rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem}.text h3{font-size:1.25rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem}.text h4{font-size:1rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem;font-size:1.1rem}.text h5{font-size:.8rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem}.text h6{font-size:.6rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem}.text strong{font-weight:700}.text em{font-style:italic}.text code{font-family:lucida console,Monaco,monospace;speak:literal-punctuation}.text abbr,.text acronym{speak:spell-out}.text del{text-decoration:line-through}.text ins{text-decoration:none;font-style:italic}.text figure{position:relative;text-align:center}.text figure img{background:#fff;border-radius:.2rem;max-width:100%}.text figure table{min-width:75%;border-radius:.2rem;margin-left:auto;margin-right:auto;border:#004966;border-collapse:separate;border-spacing:0;background:#fff;margin-bottom:-.1em}.text figure table th,.text figure table td{padding-left:.75rem;padding-right:.75rem;line-height:1.3rem;border-left:.1rem solid #004966;border-top:.1rem solid #004966}.text figure table thead{background-color:#fff}.text figure table tr td:last-child,.text figure table tr th:last-child{border-right:.1rem solid #004966}.text figure table tbody:last-child tr:last-child td{border-bottom:.1rem solid #004966}.text figure table thead:first-child tr:first-child th:first-child,.text figure table thead:first-child tr:first-child td:first-child{border-top-left-radius:.2rem}.text figure table thead:first-child tr:first-child,.text figure table thead:first-child tr:first-child th:last-child,.text figure table thead:first-child tr:first-child td:last-child{border-top-right-radius:.2rem}.text figure table tbody:last-child tr:last-child,.text figure table tbody:last-child tr:last-child td:first-child{border-bottom-left-radius:.2rem}.text figure table tbody:last-child tr:last-child,.text figure table tbody:last-child tr:last-child td:last-child{border-bottom-right-radius:.2rem}.text figure ul{text-align:left}.text figure ul.tree{padding-top:1.5em;padding-bottom:1.5em;border-radius:.2rem;background:#fff}.text figure ul.tree li{list-style-type:none}.text figure ul.tree .tree__item--folder::before{content:"📁";margin-right:.2em}.text figure ul.tree .tree__item--file::before{content:"📝";margin-right:.2em}.text figure figcaption{font-style:italic}.text pre{margin-top:1.5rem;font-size:inherit;line-height:1.5rem;padding:1.5rem 1.5rem .75rem;white-space:pre;overflow-x:scroll;overflow-y:hidden;scrollbar-color:#cccccc transparent;scrollbar-width:.75rem}.text pre::-webkit-scrollbar{margin-top:-.75rem;height:.75rem}.text pre::-webkit-scrollbar-track{background:0 0}.text pre::-webkit-scrollbar-thumb{height:.1rem;border-radius:.2rem;background:#ccc}.text hr{border:0;height:.2rem;background:#004966;margin-top:1.3rem}.text .admonition{position:relative}.text .admonition>*{padding-left:2rem}.text .admonition>:first-child::before{display:block;text-align:left;position:absolute;top:0;left:0;width:.75rem;font-size:1rem;line-height:1.5rem;height:1.5rem}.text .admonition--tip>:first-child::before{content:"☛";color:#fefefe;font-size:1.5rem;line-height:1.5rem;height:1.5rem}.text .admonition--warning>:first-child::before{content:"⚠️";color:#fefefe}.text .admonition--info>:first-child::before{content:"ⓘ";color:#004966;font-weight:700}@media print{.text h1{margin-left:auto;margin-right:auto;margin-top:9rem;width:80%;font-variant:small-caps;text-align:center}.text--simple h1{margin-top:0}.text .meta{page-break-after:always;text-align:center;font-size:1.2rem;margin-top:1.5rem}.text .meta a{text-decoration:none}.text .meta time{display:none}.text .body p:first-of-type{margin-top:0}.text pre{padding:0;font-size:inherit;line-height:1.5rem;overflow:hidden;white-space:pre-wrap;word-break:break-all}}.text .podcasts{margin-top:1.5rem;text-align:center}.text a.podcast{display:block;height:3rem}.text a.podcast img{width:50%;max-width:200px}@media screen and (min-width:768px){.text .podcasts{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));grid-gap:1.5rem}.text a.podcast img{width:100%}}.text .tombstone{opacity:0}.event h1{font-size:2rem;line-height:2.5rem;margin-top:1.5rem;margin-bottom:1rem;font-weight:400}@media screen and (min-width:760px){.event h1{font-size:2.5rem;line-height:3rem;margin-top:1.5rem}}@media screen and (min-width:900px){.event h1{font-size:2.5rem;line-height:3rem;margin-top:3rem}}@media screen and (min-width:1400px){.event h1{font-size:3rem;line-height:3.5rem;margin-top:3rem}}.text .chroma{font-size:.8rem;border-radius:.2rem}.text .chroma .lntd{vertical-align:top;padding:0;margin:0;border:0}.text .chroma .lntable{border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block}.text .chroma .hl{display:block;width:100%}.text .chroma .lnt{margin-right:.4em;padding:0 .4em}.text .chroma{color:#272822}@media screen{.text .chroma{background-color:#fafafa}}.text .chroma .err{color:#960050}.text .chroma .hl{background-color:#ffc}.text .chroma .lnt{margin-right:.4em;padding:0 .4em;color:#7f7f7f}.text .chroma .ln{color:#7f7f7f}.text .chroma .k{color:#00a8c8}.text .chroma .kc{color:#00a8c8}.text .chroma .kd{color:#00a8c8}.text .chroma .kn{color:#f92672}.text .chroma .kp{color:#00a8c8}.text .chroma .kr{color:#00a8c8}.text .chroma .kt{color:#00a8c8}.text .chroma .n{color:#111}.text .chroma .na{color:#75af00}.text .chroma .nb{color:#111}.text .chroma .bp{color:#111}.text .chroma .nc{color:#75af00}.text .chroma .no{color:#00a8c8}.text .chroma .nd{color:#75af00}.text .chroma .ni{color:#111}.text .chroma .ne{color:#75af00}.text .chroma .nf{color:#75af00}.text .chroma .fm{color:#111}.text .chroma .nl{color:#111}.text .chroma .nn{color:#111}.text .chroma .nx{color:#75af00}.text .chroma .py{color:#111}.text .chroma .nt{color:#f92672}.text .chroma .nv{color:#111}.text .chroma .vc{color:#111}.text .chroma .vg{color:#111}.text .chroma .vi{color:#111}.text .chroma .vm{color:#111}.text .chroma .l{color:#ae81ff}.text .chroma .ld{color:#d88200}.text .chroma .s{color:#d88200}.text .chroma .sa{color:#d88200}.text .chroma .sb{color:#d88200}.text .chroma .sc{color:#d88200}.text .chroma .dl{color:#d88200}.text .chroma .sd{color:#d88200}.text .chroma .s2{color:#d88200}.text .chroma .se{color:#8045ff}.text .chroma .sh{color:#d88200}.text .chroma .si{color:#d88200}.text .chroma .sx{color:#d88200}.text .chroma .sr{color:#d88200}.text .chroma .s1{color:#d88200}.text .chroma .ss{color:#d88200}.text .chroma .m{color:#ae81ff}.text .chroma .mb{color:#ae81ff}.text .chroma .mf{color:#ae81ff}.text .chroma .mh{color:#ae81ff}.text .chroma .mi{color:#ae81ff}.text .chroma .il{color:#ae81ff}.text .chroma .mo{color:#ae81ff}.text .chroma .o{color:#f92672}.text .chroma .ow{color:#f92672}.text .chroma .p{color:#111}.text .chroma .c{color:#75715e}.text .chroma .ch{color:#75715e}.text .chroma .cm{color:#75715e}.text .chroma .c1{color:#75715e}.text .chroma .cs{color:#75715e}.text .chroma .cp{color:#75715e}.text .chroma .cpf{color:#75715e}.text .chroma .ge{font-style:italic}.text .chroma .gs{font-weight:700}.bios__bio{overflow-y:visible;margin-top:1.5rem;border-top:2px solid #fefefe;padding-top:1.5rem;margin-bottom:1.5rem;position:relative;display:flex;flex-direction:row-reverse}.bios__bio h2{line-height:3rem;margin-bottom:1.5rem;margin-top:0}.bios__bio img{margin-left:1.5rem;border-radius:50%;height:10.5rem;width:10.5rem}.bios__content{flex:1}@media screen and (max-width:768px){.bios__bio{display:block;position:relative;text-align:center}.bios__content{flex:none;text-align:left}.bios h2{text-align:center}.bios h2 span{display:block}}</style><script async src="https://www.googletagmanager.com/gtag/js?id=UA-343802-37"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','UA-343802-37')</script><meta name=color-scheme content="dark light"><link rel=stylesheet type=text/css href=https://cdn-prod.securiti.ai/consent/cookie-consent.css></head><body><script>(function(){var a=document.createElement('script'),b;a.src='https://cdn-prod.securiti.ai/consent/cookie-consent-sdk.js',a.setAttribute('data-tenant-uuid','2ea5dc1c-c928-410b-a379-78d825d2eb0c'),a.setAttribute('data-domain-uuid','2f40096a-75c8-4af2-aec3-42db0231a457'),a.setAttribute('data-backend-url','https://app.securiti.ai'),a.defer=!0,b=document.head||document.body,b.appendChild(a),a.addEventListener('load',function(){window.initCmp()})})()</script><header><div class=page-header><div class=logo><a href=/><img src="data:image/svg+xml,%3Csvg baseProfile=%22tiny%22 id=%22Capa_1%22 xmlns=%22http://www.w3.org/2000/svg%22 xmlns:xlink=%22http://www.w3.org/1999/xlink%22 viewBox=%220 0 650 210%22%3E%3Cg%3E%3Cg%3E%3Ccircle fill=%22%23fff%22 cx=%22100.91%22 cy=%22104.98%22 r=%2268.91%22/%3E%3Cg%3E%3Cpath fill=%22%23bf181a%22 d=%22M100.91 36.12C62.85 36.12 32 66.97 32 105.03c0 23.47 11.74 44.18 29.66 56.63v-56.63c0-21.68 17.57-39.25 39.25-39.25s39.25 17.57 39.25 39.25-17.57 39.25-39.25 39.25c-8.76.0-16.82-2.91-23.35-7.76v33.35c7.29 2.63 15.15 4.07 23.35 4.07 38.06.0 68.91-30.85 68.91-68.91s-30.86-68.91-68.91-68.91z%22/%3E%3Ccircle fill=%22%23efc700%22 cx=%22100.91%22 cy=%22105.03%22 r=%2222.96%22/%3E%3Cpath fill=%22%23e6b600%22 d=%22M100.91 84.32c12.3.0 22.31 9.68 22.9 21.83.02-.38.06-.75.06-1.13.0-12.68-10.28-22.96-22.96-22.96s-22.96 10.28-22.96 22.96c0 .38.04.75.06 1.13C78.6 94 88.61 84.32 100.91 84.32z%22/%3E%3C/g%3E%3C/g%3E%3Cpath fill=%22%233c3c3c%22 d=%22M213.3 128.11V81.98h19.29c10.51.0 17.3 6.16 17.3 15.7.0 9.39-7.11 15.95-17.3 15.95h-9.02v14.47H213.3zm18.71-23.13c4.84.0 7.61-2.66 7.61-7.29.0-4.54-2.7-7.04-7.61-7.04h-8.45v14.33H232.01z%22/%3E%3Cpolygon fill=%22%233c3c3c%22 points=%22272.12,128.11 272.12,81.98 304.8,81.98 304.8,90.71 282.39,90.71 282.39,100.36 302.88,100.36 302.88,109.15 282.39,109.15 282.39,119.38 304.87,119.38 304.87,128.11%22/%3E%3Cpath fill=%22%233c3c3c%22 d=%22M354.71 128.11l-8.2-14.35h-8.39v14.35h-10.26V81.98h20.89c10.24.0 16.85 6.24 16.85 15.89.0 6.29-3.19 11.52-8.56 14.12l9.56 16.11H354.71zM347.66 105.23c4.81.0 7.68-2.77 7.68-7.42.0-4.59-2.8-7.23-7.68-7.23h-9.53v14.65H347.66z%22/%3E%3Cpath fill=%22%233c3c3c%22 d=%22M470.47 129.01c-12.53.0-20.63-8.12-20.63-20.69v-6.53c0-12.57 8.1-20.69 20.63-20.69 12.72.0 20.63 7.93 20.63 20.69v6.53C491.1 121.08 483.19 129.01 470.47 129.01zm0-39.2c-6.59.0-10.37 4.2-10.37 11.52v7.43c0 7.32 3.78 11.52 10.37 11.52 6.59.0 10.36-4.2 10.36-11.52v-7.43C480.83 94.01 477.06 89.81 470.47 89.81z%22/%3E%3Cpolygon fill=%22%233c3c3c%22 points=%22543.01,128.11 524.48,99.79 524.48,128.11 514.41,128.11 514.41,81.98 523.93,81.98 542.46,110.3 542.46,81.98 552.53,81.98 552.53,128.11%22/%3E%3Cpath fill=%22%233c3c3c%22 d=%22M607.7 128.11l-3.01-9.41h-16.47l-3.01 9.41h-10.29l16.54-46.13h10.01L618 128.11H607.7zM601.98 110.29l-5.52-17.45-5.58 17.45h11.1z%22/%3E%3Cg%3E%3Cpath fill=%22%233c3c3c%22 d=%22M418.62 111.85c-.77 5.33-4.37 8.5-9.73 8.5-8.74.0-10.05-7.3-10.05-11.65v-7.3c0-4.35 1.31-11.65 10.05-11.65 5.35.0 8.95 3.15 9.73 8.45l9.52-1.42c-1.28-9.33-8.95-15.7-19.24-15.7-12.68.0-20.24 7.76-20.24 20.76v6.4c0 13 7.57 20.76 20.24 20.76 10.3.0 17.98-6.39 19.25-15.74L418.62 111.85z%22/%3E%3C/g%3E%3C/g%3E%3C/svg%3E" alt=Percona></a></div><input type=checkbox id=show-mobile-menu value=1 aria-hidden=true><div class=mobile-toggle aria-controls=mobile-menu aria-label="Open navigation" role=button><label for=show-mobile-menu id=hamburger><span class=hamburger-bar></span><span class=hamburger-bar></span><span class=hamburger-bar></span></label></div><div class=mobile-menu id=mobile-menu aria-labelledby=navigation-header role=dialog aria-modal=false aria-hidden=true><nav><ul class=menu__list><li><a href=/mongodb><span>MongoDB</span></a></li><li><a href=/mysql><span>MySQL</span></a></li><li><a href=/postgresql><span>PostgreSQL</span></a></li><li><a href=/projects><span>Projects</span></a><ul class="submenu__list sub-menu"><li><a href=/projects/operators/><span>Kubernetes Operators</span></a></li><li><a href=/projects/pmm/><span>Percona Monitoring and Management</span></a></li><li><a href=/projects/toolkit/><span>Percona Toolkit</span></a></li><li><a href=/projects><span>All projects</span></a></li></ul></li><li><a href=/podcasts><span>Podcasts</span></a><ul class="submenu__list sub-menu"><li><a href=/podcasts/><span>HOSS Talks</span></a></li><li><a href=/events/dave-stokes-talks-open-percona-live-2022/><span>Dave Stokes</span></a></li></ul></li><li><a href=/events><span>Events</span></a><ul class="submenu__list sub-menu"><li><a href=/events><span>Community Events</span></a></li><li><a href=/contribute/engineeringmeetings><span>Engineering Meetings</span></a></li><li><a href=/speakers><span>Speakers</span></a></li></ul></li><li><a href=/blog><span>Blog</span></a><ul class="submenu__list sub-menu"><li><a href=/blog><span>Posts</span></a></li><li><a href=/authors><span>Authors</span></a></li></ul></li><li><a href=/contribute><span>Contribute</span></a><ul class="submenu__list sub-menu"><li><a href=/contribute/articles><span>Articles</span></a></li><li><a href=/contribute/opentopics><span>Open Topics</span></a></li><li><a href=/contribute/youtube_playlists><span>YouTube Playlists</span></a></li><li><a href=/contribute/testimonials><span>Testimonials & Surveys</span></a></li><li><a href=/contribute/coc><span>Code of Conduct</span></a></li><li><a href=/contribute/documentation><span>Documentation</span></a></li><li><a href=/contribute/help-wanted><span>Help Wanted</span></a></li><li><a href=/contribute/videos><span>Videos</span></a></li><li><a href=/contribute/dev><span>Repositories and Artifacts</span></a></li></ul></li></ul></nav></div></div></header><main class=page><div class=page-main><article class=text itemscope itemtype=https://schema.org/BlogPosting><meta itemprop=image content="https://percona.community/blog/2021/07/query-exporter.png"><meta itemprop=mainEntityOfPage content="https://percona.community/blog/2021/07/21/create-your-own-exporter-in-go/"><meta itemprop=keywords content="Exporter, Go, Query, MySQL, Prometheus, Programming"><h1 itemprop="name headline">Create your own Exporter in Go!</h1><div class=meta><time datetime="2021-07-21 00:00:00 +0000 UTC" itemprop=datePublished><span class=line>July 21, 2021</span>
<span class=calendar><span class=day>21</span>
<span class=month-year>Jul 2021</span></span></time>
<span class=authors>by <a href=/authors/dongchan_sung/>Dongchan Sung</a></span></div><div itemprop=articleBody class=body><h2 id=overview>Overview</h2><p>Hi, it’s too hot summer in Korea. Today I want to talk about an interesting and exciting topic. <strong>Try to making your own exporter in Go language</strong>.</p><p>If you register a specific query, it is a simple program that shows the result of this query as an exporter result metrics. Some of you may still be unfamiliar with what Expoter is.</p><p>I will explain about Exporter step by step in today’s post.</p><h2 id=exporter>Exporter?</h2><p>You can think of an <strong>Exporter as an HTTP server for pulling data from a time series database</strong> like Prometheus. Prometheus periodically calls the specific URL of the exporter and saves the result of metrics as a time series.</p><p><figure><img src=/blog/2021/07/prometheus-exporter.png alt="prometheus exporter"></figure></p><p>There are many exporters exist in the everywhere.</p><p>Typically, there is <a href=https://github.com/prometheus/mysqld_exporter target=_blank rel="noopener noreferrer">mysqld_expoter</a>, which is Prometheus’s Offcial projects, and <a href=https://github.com/percona/mysqld_exporter target=_blank rel="noopener noreferrer">mysqld_expoter</a>, which they fork and distribute additionally in Percona. Besides these, not only node_expoter for monitoring Linux nodes, but also memcached_expoter etc..</p><p>For reference, you can see various exporters from <a href=https://exporterhub.io target=_blank rel="noopener noreferrer">exporterhub</a>.</p><p>What I am going to present my Blog that is the process of adding my own new exporter among these various exporters. Let’s go!</p><h2 id=creating-a-go-project>Creating a Go project</h2><p>Exporter can be implemented in various languages, but today I will implement it with Go.</p><p>Personally, I think Go is very convenient in terms of distribution and compatibility. I will omit the go installation and environment configuration here.</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>$ <span class=nb>cd</span> ~/go/src
 
$ mkdir -p query-exporter-simple
 
$ <span class=nb>cd</span> query-exporter-simple
 
$ go mod init
go: creating new go.mod: module query-exporter-simple
 
$ ls -al
total <span class=m>8</span>
drwxr-xr-x   <span class=m>3</span> chan  staff   <span class=m>96</span>  <span class=m>7</span> <span class=m>12</span> 13:33 .
drwxr-xr-x  <span class=m>12</span> chan  staff  <span class=m>384</span>  <span class=m>7</span> <span class=m>12</span> 13:33 ..
-rw-r--r--   <span class=m>1</span> chan  staff   <span class=m>38</span>  <span class=m>7</span> <span class=m>12</span> 13:33 go.mod
 
$ cat go.mod
module query-exporter-simple
 
go 1.16
</code></pre></div><p>Although it is an fundamental project, now everything is ready to make your own exporter. From now on, package management is managed with <code>go mod</code>.</p><h2 id=try-empty-exporter>Try Empty Exporter</h2><p>Now, let’s start making the Exporter in earnest.</p><p>First, as a taster, let’s try to make an empty Exporter that has no function.. it simply outputs the exporter version only.</p><p>This is to read OS parameters using flags. The “bind” is server HTTP binding information when Exporter is started.</p><div class=highlight><pre class=chroma><code class=language-go data-lang=go><span class=kn>package</span> <span class=nx>main</span>
 
<span class=kn>import</span> <span class=p>(</span>
    <span class=s>&#34;flag&#34;</span>
<span class=p>)</span>
 
<span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
    <span class=c1>// =====================
</span><span class=c1></span>    <span class=c1>// Get OS parameter
</span><span class=c1></span>    <span class=c1>// =====================
</span><span class=c1></span>    <span class=kd>var</span> <span class=nx>bind</span> <span class=kt>string</span>
    <span class=nx>flag</span><span class=p>.</span><span class=nf>StringVar</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>bind</span><span class=p>,</span> <span class=s>&#34;bind&#34;</span><span class=p>,</span> <span class=s>&#34;0.0.0.0:9104&#34;</span><span class=p>,</span> <span class=s>&#34;bind&#34;</span><span class=p>)</span>
    <span class=nx>flag</span><span class=p>.</span><span class=nf>Parse</span><span class=p>()</span>
<span class=p>}</span>
</code></pre></div><p>Register Collector to collect and run Exporter with HTTP server. Collector is the concept of a thread that collects information, and it implements the Collector interface of Prometheus.</p><div class=highlight><pre class=chroma><code class=language-go data-lang=go><span class=kn>package</span> <span class=nx>main</span>
 
<span class=kn>import</span> <span class=p>(</span>
    <span class=s>&#34;flag&#34;</span>
    <span class=s>&#34;net/http&#34;</span>
 
    <span class=s>&#34;github.com/prometheus/client_golang/prometheus&#34;</span>
    <span class=s>&#34;github.com/prometheus/client_golang/prometheus/promhttp&#34;</span>
    <span class=s>&#34;github.com/prometheus/common/version&#34;</span>
    <span class=nx>log</span> <span class=s>&#34;github.com/sirupsen/logrus&#34;</span>
<span class=p>)</span>
 
<span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
    <span class=c1>// =====================
</span><span class=c1></span>    <span class=c1>// Get OS parameter
</span><span class=c1></span>    <span class=c1>// =====================
</span><span class=c1></span>    <span class=kd>var</span> <span class=nx>bind</span> <span class=kt>string</span>
    <span class=nx>flag</span><span class=p>.</span><span class=nf>StringVar</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>bind</span><span class=p>,</span> <span class=s>&#34;bind&#34;</span><span class=p>,</span> <span class=s>&#34;0.0.0.0:9104&#34;</span><span class=p>,</span> <span class=s>&#34;bind&#34;</span><span class=p>)</span>
    <span class=nx>flag</span><span class=p>.</span><span class=nf>Parse</span><span class=p>()</span>
 
    <span class=c1>// ========================
</span><span class=c1></span>    <span class=c1>// Regist handler
</span><span class=c1></span>    <span class=c1>// ========================
</span><span class=c1></span>    <span class=nx>prometheus</span><span class=p>.</span><span class=nf>Register</span><span class=p>(</span><span class=nx>version</span><span class=p>.</span><span class=nf>NewCollector</span><span class=p>(</span><span class=s>&#34;query_exporter&#34;</span><span class=p>))</span>
 
    <span class=c1>// Regist http handler
</span><span class=c1></span>    <span class=nx>http</span><span class=p>.</span><span class=nf>HandleFunc</span><span class=p>(</span><span class=s>&#34;/metrics&#34;</span><span class=p>,</span> <span class=kd>func</span><span class=p>(</span><span class=nx>w</span> <span class=nx>http</span><span class=p>.</span><span class=nx>ResponseWriter</span><span class=p>,</span> <span class=nx>r</span> <span class=o>*</span><span class=nx>http</span><span class=p>.</span><span class=nx>Request</span><span class=p>)</span> <span class=p>{</span>
        <span class=nx>h</span> <span class=o>:=</span> <span class=nx>promhttp</span><span class=p>.</span><span class=nf>HandlerFor</span><span class=p>(</span><span class=nx>prometheus</span><span class=p>.</span><span class=nx>Gatherers</span><span class=p>{</span>
            <span class=nx>prometheus</span><span class=p>.</span><span class=nx>DefaultGatherer</span><span class=p>,</span>
        <span class=p>},</span> <span class=nx>promhttp</span><span class=p>.</span><span class=nx>HandlerOpts</span><span class=p>{})</span>
        <span class=nx>h</span><span class=p>.</span><span class=nf>ServeHTTP</span><span class=p>(</span><span class=nx>w</span><span class=p>,</span> <span class=nx>r</span><span class=p>)</span>
    <span class=p>})</span>
 
    <span class=c1>// start server
</span><span class=c1></span>    <span class=nx>log</span><span class=p>.</span><span class=nf>Infof</span><span class=p>(</span><span class=s>&#34;Starting http server - %s&#34;</span><span class=p>,</span> <span class=nx>bind</span><span class=p>)</span>
    <span class=k>if</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>http</span><span class=p>.</span><span class=nf>ListenAndServe</span><span class=p>(</span><span class=nx>bind</span><span class=p>,</span> <span class=kc>nil</span><span class=p>);</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
        <span class=nx>log</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;Failed to start http server: %s&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>)</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div><p>Since the packages used by source code do not exist in the project yet, numerous errors will be occurred.</p><p>So, as below, get related packages through <code>go mod vendor</code>. Related packages are placed under the vendor directory.</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>$ go mod vendor
go: finding module <span class=k>for</span> package github.com/prometheus/common/version
go: finding module <span class=k>for</span> package github.com/prometheus/client_golang/prometheus
go: finding module <span class=k>for</span> package github.com/sirupsen/logrus
go: finding module <span class=k>for</span> package github.com/prometheus/client_golang/prometheus/promhttp
go: found github.com/prometheus/client_golang/prometheus in github.com/prometheus/client_golang v1.11.0
go: found github.com/prometheus/client_golang/prometheus/promhttp in github.com/prometheus/client_golang v1.11.0
go: found github.com/prometheus/common/version in github.com/prometheus/common v0.29.0
go: found github.com/sirupsen/logrus in github.com/sirupsen/logrus v1.8.1
 
$ ls -al
total <span class=m>112</span>
drwxr-xr-x   <span class=m>6</span> chan  staff    <span class=m>192</span>  <span class=m>7</span> <span class=m>13</span> 10:26 .
drwxr-xr-x  <span class=m>12</span> chan  staff    <span class=m>384</span>  <span class=m>7</span> <span class=m>12</span> 13:33 ..
-rw-r--r--   <span class=m>1</span> chan  staff    <span class=m>169</span>  <span class=m>7</span> <span class=m>13</span> 10:26 go.mod
-rw-r--r--   <span class=m>1</span> chan  staff  <span class=m>45722</span>  <span class=m>7</span> <span class=m>13</span> 10:26 go.sum
-rw-r--r--   <span class=m>1</span> chan  staff   <span class=m>1163</span>  <span class=m>7</span> <span class=m>13</span> 10:34 main.go
drwxr-xr-x   <span class=m>6</span> chan  staff    <span class=m>192</span>  <span class=m>7</span> <span class=m>13</span> 10:26 vendor
</code></pre></div><p>If you start the Exporter server, the server will be run on port 9104 (the port specified by default in flag).</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>$ go run .
INFO<span class=o>[</span>0000<span class=o>]</span> Regist version collector - query_exporter
INFO<span class=o>[</span>0000<span class=o>]</span> HTTP handler path - /metrics
INFO<span class=o>[</span>0000<span class=o>]</span> Starting http server - 0.0.0.0:9104
</code></pre></div><p>If you want to change the port, give the bind OS parameter as below, then, the server will run with that port.</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>$ go run . --bind<span class=o>=</span>0.0.0.0:9105
INFO<span class=o>[</span>0000<span class=o>]</span> Regist version collector - query_exporter
INFO<span class=o>[</span>0000<span class=o>]</span> HTTP handler path - /metrics
INFO<span class=o>[</span>0000<span class=o>]</span> Starting http server - 0.0.0.0:9105
</code></pre></div><p>Even though it is an empty Exporter.. You can see that a lot of information is extracted through the Exporter. (Most of the information is about go itself..)</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>$ curl 127.0.0.1:9104/metrics
<span class=c1># HELP go_gc_duration_seconds A summary of the pause duration of garbage collection cycles.</span>
<span class=c1># TYPE go_gc_duration_seconds summary</span>
go_gc_duration_seconds<span class=o>{</span><span class=nv>quantile</span><span class=o>=</span><span class=s2>&#34;0&#34;</span><span class=o>}</span> <span class=m>0</span>
go_gc_duration_seconds<span class=o>{</span><span class=nv>quantile</span><span class=o>=</span><span class=s2>&#34;0.25&#34;</span><span class=o>}</span> <span class=m>0</span>
 
.. skip ..
 
<span class=c1># HELP go_threads Number of OS threads created.</span>
<span class=c1># TYPE go_threads gauge</span>
go_threads <span class=m>7</span>
<span class=c1># HELP query_exporter_build_info A metric with a constant &#39;1&#39; value labeled by version, revision, branch, and goversion from which query_exporter was built.</span>
<span class=c1># TYPE query_exporter_build_info gauge</span>
query_exporter_build_info<span class=o>{</span><span class=nv>branch</span><span class=o>=</span><span class=s2>&#34;&#34;</span>,goversion<span class=o>=</span><span class=s2>&#34;go1.16.5&#34;</span>,revision<span class=o>=</span><span class=s2>&#34;&#34;</span>,version<span class=o>=</span><span class=s2>&#34;&#34;</span><span class=o>}</span> <span class=m>1</span>
</code></pre></div><p>At the very bottom, there is the query_exporter_build_info metric, which is the information collected by the Collector that we added in the previous section. This is the moment we created the new Exporter collecting version information!</p><h2 id=creating-an-exporter-in-earnest>Creating an Exporter in earnest</h2><p>I made an empty Exporter that specifies only the exporter version. Is that easy, right? 🙂</p><p>From now on, I’m going to implement a Collector that collects the information we really need from database and sends the result to the HTTP GET method.</p><p><figure><img src=/blog/2021/07/query-exporter.png alt="query exporter"></figure></p><h3 id=1-configuration-format-yaml>1. Configuration format (YAML)</h3><p>As I said before, I want to make something that passes the result of the registered query to the Exporter result metric. To do this, you need to know information about the target instance as well as the query to be executed.</p><p>Let’s set it up in the below format. MySQL connection information and the query to be executed. It will show two pieces of information as a result: <strong>“Connections per host”</strong> and <strong>“Connections per user”</strong>.</p><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=nt>dsn</span><span class=p>:</span><span class=w> </span><span class=l>test:test123@tcp(127.0.0.1:3306)/information_schema</span><span class=w>
</span><span class=w></span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>process_count_by_host</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>query</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;select user,
</span><span class=s2>                  substring_index(host, &#39;:&#39;, 1) host,
</span><span class=s2>                  count(*) sessions 
</span><span class=s2>            from information_schema.processlist
</span><span class=s2>            group by 1,2 &#34;</span><span class=w>
</span><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>gauge</span><span class=w>
</span><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;process count by host&#34;</span><span class=w>
</span><span class=w>    </span><span class=nt>labels</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&#34;user&#34;</span><span class=p>,</span><span class=s2>&#34;host&#34;</span><span class=p>]</span><span class=w>
</span><span class=w>    </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=l>sessions</span><span class=w>
</span><span class=w>  </span><span class=nt>process_count_by_user</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>query</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;select user, count(*) sessions 
</span><span class=s2>            from information_schema.processlist 
</span><span class=s2>            group by 1 &#34;</span><span class=w>
</span><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>gauge</span><span class=w>
</span><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;process count by user&#34;</span><span class=w>
</span><span class=w>    </span><span class=nt>labels</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&#34;user&#34;</span><span class=p>]</span><span class=w>
</span><span class=w>    </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=l>sessions</span><span class=w>
</span></code></pre></div><p>I tried defining the above yaml as Go structure.</p><div class=highlight><pre class=chroma><code class=language-go data-lang=go><span class=kd>type</span> <span class=nx>Config</span> <span class=kd>struct</span> <span class=p>{</span>
    <span class=nx>DSN</span>     <span class=kt>string</span>
    <span class=nx>Metrics</span> <span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kd>struct</span> <span class=p>{</span>
        <span class=nx>Query</span>       <span class=kt>string</span>
        <span class=nx>Type</span>        <span class=kt>string</span>
        <span class=nx>Description</span> <span class=kt>string</span>
        <span class=nx>Labels</span>      <span class=p>[]</span><span class=kt>string</span>
        <span class=nx>Value</span>       <span class=kt>string</span>
        <span class=nx>metricDesc</span>  <span class=o>*</span><span class=nx>prometheus</span><span class=p>.</span><span class=nx>Desc</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div><p>Here, metricDesc <code>*prometheus.Desc</code> can be understood as a specification used in Prometheus metrics. It also specifies any label and metric types such as Counter/Gauge.</p><p>Read the YAML file as below, and finally load the setting information into the structure defined below.</p><div class=highlight><pre class=chroma><code class=language-go data-lang=go><span class=kd>var</span> <span class=nx>b</span> <span class=p>[]</span><span class=kt>byte</span>
<span class=kd>var</span> <span class=nx>config</span> <span class=nx>Config</span>
<span class=k>if</span> <span class=nx>b</span><span class=p>,</span> <span class=nx>err</span> <span class=p>=</span> <span class=nx>ioutil</span><span class=p>.</span><span class=nf>ReadFile</span><span class=p>(</span><span class=s>&#34;config.yml&#34;</span><span class=p>);</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
    <span class=nx>log</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;Failed to read config file: %s&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>)</span>
    <span class=nx>os</span><span class=p>.</span><span class=nf>Exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
<span class=p>}</span>
 
<span class=c1>// Load yaml
</span><span class=c1></span><span class=k>if</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>yaml</span><span class=p>.</span><span class=nf>Unmarshal</span><span class=p>(</span><span class=nx>b</span><span class=p>,</span> <span class=o>&amp;</span><span class=nx>config</span><span class=p>);</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
    <span class=nx>log</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;Failed to load config: %s&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>)</span>
    <span class=nx>os</span><span class=p>.</span><span class=nf>Exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
<span class=p>}</span>
</code></pre></div><p>In this way, we can now put the necessary information in the Config structure and use it to implement the desired implementation.</p><div class=highlight><pre class=chroma><code class=language-go data-lang=go><span class=kn>package</span> <span class=nx>main</span>
 
<span class=kn>import</span> <span class=p>(</span>
    <span class=s>&#34;flag&#34;</span>
    <span class=s>&#34;io/ioutil&#34;</span>
    <span class=s>&#34;net/http&#34;</span>
    <span class=s>&#34;os&#34;</span>
 
    <span class=s>&#34;github.com/ghodss/yaml&#34;</span>
    <span class=s>&#34;github.com/prometheus/client_golang/prometheus&#34;</span>
    <span class=s>&#34;github.com/prometheus/client_golang/prometheus/promhttp&#34;</span>
    <span class=s>&#34;github.com/prometheus/common/version&#34;</span>
    <span class=nx>log</span> <span class=s>&#34;github.com/sirupsen/logrus&#34;</span>
<span class=p>)</span>
 
<span class=kd>var</span> <span class=nx>config</span> <span class=nx>Config</span>
 
<span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
    <span class=kd>var</span> <span class=nx>err</span> <span class=kt>error</span>
    <span class=kd>var</span> <span class=nx>configFile</span><span class=p>,</span> <span class=nx>bind</span> <span class=kt>string</span>
    <span class=c1>// =====================
</span><span class=c1></span>    <span class=c1>// Get OS parameter
</span><span class=c1></span>    <span class=c1>// =====================
</span><span class=c1></span>    <span class=nx>flag</span><span class=p>.</span><span class=nf>StringVar</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>configFile</span><span class=p>,</span> <span class=s>&#34;config&#34;</span><span class=p>,</span> <span class=s>&#34;config.yml&#34;</span><span class=p>,</span> <span class=s>&#34;configuration file&#34;</span><span class=p>)</span>
    <span class=nx>flag</span><span class=p>.</span><span class=nf>StringVar</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>bind</span><span class=p>,</span> <span class=s>&#34;bind&#34;</span><span class=p>,</span> <span class=s>&#34;0.0.0.0:9104&#34;</span><span class=p>,</span> <span class=s>&#34;bind&#34;</span><span class=p>)</span>
    <span class=nx>flag</span><span class=p>.</span><span class=nf>Parse</span><span class=p>()</span>
 
    <span class=c1>// =====================
</span><span class=c1></span>    <span class=c1>// Load config &amp; yaml
</span><span class=c1></span>    <span class=c1>// =====================
</span><span class=c1></span>    <span class=kd>var</span> <span class=nx>b</span> <span class=p>[]</span><span class=kt>byte</span>
    <span class=k>if</span> <span class=nx>b</span><span class=p>,</span> <span class=nx>err</span> <span class=p>=</span> <span class=nx>ioutil</span><span class=p>.</span><span class=nf>ReadFile</span><span class=p>(</span><span class=nx>configFile</span><span class=p>);</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
        <span class=nx>log</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;Failed to read config file: %s&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>)</span>
        <span class=nx>os</span><span class=p>.</span><span class=nf>Exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
    <span class=p>}</span>
 
    <span class=c1>// Load yaml
</span><span class=c1></span>    <span class=k>if</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>yaml</span><span class=p>.</span><span class=nf>Unmarshal</span><span class=p>(</span><span class=nx>b</span><span class=p>,</span> <span class=o>&amp;</span><span class=nx>config</span><span class=p>);</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
        <span class=nx>log</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;Failed to load config: %s&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>)</span>
        <span class=nx>os</span><span class=p>.</span><span class=nf>Exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
    <span class=p>}</span>
 
    <span class=c1>// ========================
</span><span class=c1></span>    <span class=c1>// Regist handler
</span><span class=c1></span>    <span class=c1>// ========================
</span><span class=c1></span>    <span class=nx>log</span><span class=p>.</span><span class=nf>Infof</span><span class=p>(</span><span class=s>&#34;Regist version collector - %s&#34;</span><span class=p>,</span> <span class=s>&#34;query_exporter&#34;</span><span class=p>)</span>
    <span class=nx>prometheus</span><span class=p>.</span><span class=nf>Register</span><span class=p>(</span><span class=nx>version</span><span class=p>.</span><span class=nf>NewCollector</span><span class=p>(</span><span class=s>&#34;query_exporter&#34;</span><span class=p>))</span>
 
    <span class=c1>// Regist http handler
</span><span class=c1></span>    <span class=nx>log</span><span class=p>.</span><span class=nf>Infof</span><span class=p>(</span><span class=s>&#34;HTTP handler path - %s&#34;</span><span class=p>,</span> <span class=s>&#34;/metrics&#34;</span><span class=p>)</span>
    <span class=nx>http</span><span class=p>.</span><span class=nf>HandleFunc</span><span class=p>(</span><span class=s>&#34;/metrics&#34;</span><span class=p>,</span> <span class=kd>func</span><span class=p>(</span><span class=nx>w</span> <span class=nx>http</span><span class=p>.</span><span class=nx>ResponseWriter</span><span class=p>,</span> <span class=nx>r</span> <span class=o>*</span><span class=nx>http</span><span class=p>.</span><span class=nx>Request</span><span class=p>)</span> <span class=p>{</span>
        <span class=nx>h</span> <span class=o>:=</span> <span class=nx>promhttp</span><span class=p>.</span><span class=nf>HandlerFor</span><span class=p>(</span><span class=nx>prometheus</span><span class=p>.</span><span class=nx>Gatherers</span><span class=p>{</span>
            <span class=nx>prometheus</span><span class=p>.</span><span class=nx>DefaultGatherer</span><span class=p>,</span>
        <span class=p>},</span> <span class=nx>promhttp</span><span class=p>.</span><span class=nx>HandlerOpts</span><span class=p>{})</span>
        <span class=nx>h</span><span class=p>.</span><span class=nf>ServeHTTP</span><span class=p>(</span><span class=nx>w</span><span class=p>,</span> <span class=nx>r</span><span class=p>)</span>
    <span class=p>})</span>
 
    <span class=c1>// start server
</span><span class=c1></span>    <span class=nx>log</span><span class=p>.</span><span class=nf>Infof</span><span class=p>(</span><span class=s>&#34;Starting http server - %s&#34;</span><span class=p>,</span> <span class=nx>bind</span><span class=p>)</span>
    <span class=k>if</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>http</span><span class=p>.</span><span class=nf>ListenAndServe</span><span class=p>(</span><span class=nx>bind</span><span class=p>,</span> <span class=kc>nil</span><span class=p>);</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
        <span class=nx>log</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;Failed to start http server: %s&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>)</span>
    <span class=p>}</span>
<span class=p>}</span>
 
<span class=c1>// =============================
</span><span class=c1>// Config config structure
</span><span class=c1>// =============================
</span><span class=c1></span><span class=kd>type</span> <span class=nx>Config</span> <span class=kd>struct</span> <span class=p>{</span>
    <span class=nx>DSN</span>     <span class=kt>string</span>
    <span class=nx>Metrics</span> <span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kd>struct</span> <span class=p>{</span>
        <span class=nx>Query</span>       <span class=kt>string</span>
        <span class=nx>Type</span>        <span class=kt>string</span>
        <span class=nx>Description</span> <span class=kt>string</span>
        <span class=nx>Labels</span>      <span class=p>[]</span><span class=kt>string</span>
        <span class=nx>Value</span>       <span class=kt>string</span>
        <span class=nx>metricDesc</span>  <span class=o>*</span><span class=nx>prometheus</span><span class=p>.</span><span class=nx>Desc</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div><h3 id=2-implement-collector>2. Implement Collector</h3><p>The highlight of today’s post is the implementing a Collector to collect the desired information from database.</p><p>All the processes I implemented so far is to get the results as an HTTP result. Collector actually connect to the database and delivering the specified metric result based on the result of executing the specified query.</p><div class=highlight><pre class=chroma><code class=language-go data-lang=go><span class=kd>type</span> <span class=nx>QueryCollector</span> <span class=kd>struct</span><span class=p>{}</span>
 
<span class=c1>// Describe prometheus describe
</span><span class=c1></span><span class=kd>func</span> <span class=p>(</span><span class=nx>e</span> <span class=o>*</span><span class=nx>QueryCollector</span><span class=p>)</span> <span class=nf>Describe</span><span class=p>(</span><span class=nx>ch</span> <span class=kd>chan</span><span class=o>&lt;-</span> <span class=o>*</span><span class=nx>prometheus</span><span class=p>.</span><span class=nx>Desc</span><span class=p>)</span> <span class=p>{</span>
<span class=p>}</span>
 
<span class=c1>// Collect prometheus collect
</span><span class=c1></span><span class=kd>func</span> <span class=p>(</span><span class=nx>e</span> <span class=o>*</span><span class=nx>QueryCollector</span><span class=p>)</span> <span class=nf>Collect</span><span class=p>(</span><span class=nx>ch</span> <span class=kd>chan</span><span class=o>&lt;-</span> <span class=nx>prometheus</span><span class=p>.</span><span class=nx>Metric</span><span class=p>)</span> <span class=p>{</span>
<span class=p>}</span>
</code></pre></div><p>As I have mentioned earlier, Collector is kind of a thread concept that collects information, and is a structure that implements the Collector interface of Prometheus. In other words, this story means that if you want to create another Collector of your own, <strong>you must implement two of the Describe and Collect defined by the prometheus.Collector interface</strong>.</p><p>Register the Collector defined as below.</p><div class=highlight><pre class=chroma><code class=language-go data-lang=go><span class=kd>func</span> <span class=nf>main</span><span class=p>(){</span>
    <span class=p>..</span> <span class=nx>skip</span> <span class=p>..</span>
    <span class=c1>// ========================
</span><span class=c1></span>    <span class=c1>// Regist handler
</span><span class=c1></span>    <span class=c1>// ========================
</span><span class=c1></span>    <span class=nx>log</span><span class=p>.</span><span class=nf>Infof</span><span class=p>(</span><span class=s>&#34;Regist version collector - %s&#34;</span><span class=p>,</span> <span class=s>&#34;query_exporter&#34;</span><span class=p>)</span>
    <span class=nx>prometheus</span><span class=p>.</span><span class=nf>Register</span><span class=p>(</span><span class=nx>version</span><span class=p>.</span><span class=nf>NewCollector</span><span class=p>(</span><span class=s>&#34;query_exporter&#34;</span><span class=p>))</span>
    <span class=nx>prometheus</span><span class=p>.</span><span class=nf>Register</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>QueryCollector</span><span class=p>{})</span>
    <span class=p>..</span> <span class=nx>skip</span> <span class=p>..</span>
<span class=p>}</span>
</code></pre></div><p>The Version Collector added to the can exporter created earlier and the QueryCollector newly added this time are registered. When an http request comes in to “/metric”, the above two Collectors are finally executed by each thread.</p><h4 id=2-1-create-the-describe-function>2-1. Create the Describe function</h4><p><strong>This is the part that defines the specifications of each metric.</strong> Actually, it is not necessary to define the specification of the metric here, but it is useful if you consider the case of creating and operating multiple Collectors. This method is executed only once when a Collector is registered with prometheus.Register.</p><div class=highlight><pre class=chroma><code class=language-go data-lang=go><span class=kd>func</span> <span class=p>(</span><span class=nx>e</span> <span class=o>*</span><span class=nx>QueryCollector</span><span class=p>)</span> <span class=nf>Describe</span><span class=p>(</span><span class=nx>ch</span> <span class=kd>chan</span><span class=o>&lt;-</span> <span class=o>*</span><span class=nx>prometheus</span><span class=p>.</span><span class=nx>Desc</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>for</span> <span class=nx>metricName</span><span class=p>,</span> <span class=nx>metric</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>config</span><span class=p>.</span><span class=nx>Metrics</span> <span class=p>{</span>
        <span class=nx>metric</span><span class=p>.</span><span class=nx>metricDesc</span> <span class=p>=</span> <span class=nx>prometheus</span><span class=p>.</span><span class=nf>NewDesc</span><span class=p>(</span>
            <span class=nx>prometheus</span><span class=p>.</span><span class=nf>BuildFQName</span><span class=p>(</span><span class=s>&#34;query_exporter&#34;</span><span class=p>,</span> <span class=s>&#34;&#34;</span><span class=p>,</span> <span class=nx>metricName</span><span class=p>),</span>
            <span class=nx>metric</span><span class=p>.</span><span class=nx>Description</span><span class=p>,</span>
            <span class=nx>metric</span><span class=p>.</span><span class=nx>Labels</span><span class=p>,</span> <span class=kc>nil</span><span class=p>,</span>
        <span class=p>)</span>
        <span class=nx>config</span><span class=p>.</span><span class=nx>Metrics</span><span class=p>[</span><span class=nx>metricName</span><span class=p>]</span> <span class=p>=</span> <span class=nx>metric</span>
        <span class=nx>log</span><span class=p>.</span><span class=nf>Infof</span><span class=p>(</span><span class=s>&#34;metric description for \&#34;%s\&#34; registerd&#34;</span><span class=p>,</span> <span class=nx>metricName</span><span class=p>)</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div><p>Here, I have defined the specification of the metric with the information related to Query in the setting information read earlier.</p><ul><li>prometheus.BuildFQName: name of metric</li><li>metric.Description: Description</li><li>metric.Labels: Array of label names, label values should be mapped later in this order</li></ul><p>If you look at the config.yml, each mapping will be as follows.</p><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=c># metricName</span><span class=w>
</span><span class=w>  </span><span class=nt>process_count_by_user</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=c>## metric.Description</span><span class=w>
</span><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;process count by user&#34;</span><span class=w>
</span><span class=w>    </span><span class=c>## metric.Labels</span><span class=w>
</span><span class=w>    </span><span class=nt>labels</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&#34;user&#34;</span><span class=p>]</span><span class=w>
</span></code></pre></div><h4 id=2-2-create-the-collect-function>2-2. Create the Collect function</h4><p>This is the part that connects to the DB, executes the registered SQL, and makes it a metric.</p><p><figure><img sizes=100vw srcset="/blog/2021/07/metric-results_hub77fca3a1a5735cecae55a62f4904901_85736_480x0_resize_lanczos_2.png 480w, /blog/2021/07/metric-results_hub77fca3a1a5735cecae55a62f4904901_85736_768x0_resize_lanczos_2.png 768w, /blog/2021/07/metric-results_hub77fca3a1a5735cecae55a62f4904901_85736_1400x0_resize_lanczos_2.png 1400w" src=/blog/2021/07/metric-results.png alt="metric results"></figure></p><p>The execution results(rows) of each query are displayed as a metric name and values as shown in the figure above.</p><div class=highlight><pre class=chroma><code class=language-go data-lang=go><span class=kd>func</span> <span class=p>(</span><span class=nx>e</span> <span class=o>*</span><span class=nx>QueryCollector</span><span class=p>)</span> <span class=nf>Collect</span><span class=p>(</span><span class=nx>ch</span> <span class=kd>chan</span><span class=o>&lt;-</span> <span class=nx>prometheus</span><span class=p>.</span><span class=nx>Metric</span><span class=p>)</span> <span class=p>{</span>
 
    <span class=c1>// Connect to database
</span><span class=c1></span>    <span class=nx>db</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>sql</span><span class=p>.</span><span class=nf>Open</span><span class=p>(</span><span class=s>&#34;mysql&#34;</span><span class=p>,</span> <span class=nx>config</span><span class=p>.</span><span class=nx>DSN</span><span class=p>)</span>
    <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
        <span class=nx>log</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;Connect to database failed: %s&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>)</span>
        <span class=k>return</span>
    <span class=p>}</span>
    <span class=k>defer</span> <span class=nx>db</span><span class=p>.</span><span class=nf>Close</span><span class=p>()</span>
 
    <span class=c1>// Execute each queries in metrics
</span><span class=c1></span>    <span class=k>for</span> <span class=nx>name</span><span class=p>,</span> <span class=nx>metric</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>config</span><span class=p>.</span><span class=nx>Metrics</span> <span class=p>{</span>
 
        <span class=c1>// Execute query
</span><span class=c1></span>        <span class=nx>rows</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>db</span><span class=p>.</span><span class=nf>Query</span><span class=p>(</span><span class=nx>metric</span><span class=p>.</span><span class=nx>Query</span><span class=p>)</span>
        <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
            <span class=nx>log</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;Failed to execute query: %s&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>)</span>
            <span class=k>continue</span>
        <span class=p>}</span>
 
        <span class=c1>// Get column info
</span><span class=c1></span>        <span class=nx>cols</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>rows</span><span class=p>.</span><span class=nf>Columns</span><span class=p>()</span>
        <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
            <span class=nx>log</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;Failed to get column meta: %s&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>)</span>
            <span class=k>continue</span>
        <span class=p>}</span>
 
        <span class=nx>des</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>([]</span><span class=kd>interface</span><span class=p>{},</span> <span class=nb>len</span><span class=p>(</span><span class=nx>cols</span><span class=p>))</span>
        <span class=nx>res</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>([][]</span><span class=kt>byte</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=nx>cols</span><span class=p>))</span>
        <span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>cols</span> <span class=p>{</span>
            <span class=nx>des</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span> <span class=p>=</span> <span class=o>&amp;</span><span class=nx>res</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span>
        <span class=p>}</span>
 
        <span class=c1>// fetch database
</span><span class=c1></span>        <span class=k>for</span> <span class=nx>rows</span><span class=p>.</span><span class=nf>Next</span><span class=p>()</span> <span class=p>{</span>
            <span class=nx>rows</span><span class=p>.</span><span class=nf>Scan</span><span class=p>(</span><span class=nx>des</span><span class=o>...</span><span class=p>)</span>
            <span class=nx>data</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>string</span><span class=p>)</span>
            <span class=k>for</span> <span class=nx>i</span><span class=p>,</span> <span class=nx>bytes</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>res</span> <span class=p>{</span>
                <span class=nx>data</span><span class=p>[</span><span class=nx>cols</span><span class=p>[</span><span class=nx>i</span><span class=p>]]</span> <span class=p>=</span> <span class=nb>string</span><span class=p>(</span><span class=nx>bytes</span><span class=p>)</span>
            <span class=p>}</span>
 
            <span class=c1>// Metric labels
</span><span class=c1></span>            <span class=nx>labelVals</span> <span class=o>:=</span> <span class=p>[]</span><span class=kt>string</span><span class=p>{}</span>
            <span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>label</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>metric</span><span class=p>.</span><span class=nx>Labels</span> <span class=p>{</span>
                <span class=nx>labelVals</span> <span class=p>=</span> <span class=nb>append</span><span class=p>(</span><span class=nx>labelVals</span><span class=p>,</span> <span class=nx>data</span><span class=p>[</span><span class=nx>label</span><span class=p>])</span>
            <span class=p>}</span>
 
            <span class=c1>// Metric value
</span><span class=c1></span>            <span class=nx>val</span><span class=p>,</span> <span class=nx>_</span> <span class=o>:=</span> <span class=nx>strconv</span><span class=p>.</span><span class=nf>ParseFloat</span><span class=p>(</span><span class=nx>data</span><span class=p>[</span><span class=nx>metric</span><span class=p>.</span><span class=nx>Value</span><span class=p>],</span> <span class=mi>64</span><span class=p>)</span>
 
            <span class=c1>// Add metric
</span><span class=c1></span>            <span class=k>switch</span> <span class=nx>strings</span><span class=p>.</span><span class=nf>ToLower</span><span class=p>(</span><span class=nx>metric</span><span class=p>.</span><span class=nx>Type</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>case</span> <span class=s>&#34;counter&#34;</span><span class=p>:</span>
                <span class=nx>ch</span> <span class=o>&lt;-</span> <span class=nx>prometheus</span><span class=p>.</span><span class=nf>MustNewConstMetric</span><span class=p>(</span><span class=nx>metric</span><span class=p>.</span><span class=nx>metricDesc</span><span class=p>,</span> <span class=nx>prometheus</span><span class=p>.</span><span class=nx>CounterValue</span><span class=p>,</span> <span class=nx>val</span><span class=p>,</span> <span class=nx>labelVals</span><span class=o>...</span><span class=p>)</span>
            <span class=k>case</span> <span class=s>&#34;gauge&#34;</span><span class=p>:</span>
                <span class=nx>ch</span> <span class=o>&lt;-</span> <span class=nx>prometheus</span><span class=p>.</span><span class=nf>MustNewConstMetric</span><span class=p>(</span><span class=nx>metric</span><span class=p>.</span><span class=nx>metricDesc</span><span class=p>,</span> <span class=nx>prometheus</span><span class=p>.</span><span class=nx>GaugeValue</span><span class=p>,</span> <span class=nx>val</span><span class=p>,</span> <span class=nx>labelVals</span><span class=o>...</span><span class=p>)</span>
            <span class=k>default</span><span class=p>:</span>
                <span class=nx>log</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;Fail to add metric for %s: %s is not valid type&#34;</span><span class=p>,</span> <span class=nx>name</span><span class=p>,</span> <span class=nx>metric</span><span class=p>.</span><span class=nx>Type</span><span class=p>)</span>
                <span class=k>continue</span>
            <span class=p>}</span>
        <span class=p>}</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div><p>As you can see from the labelVals value, you need to pass the label values in the order of Labels of the specification defined in Describe earlier. There are two metric types here: <strong>counter</strong> and <strong>gauge</strong>. Each type has the following meaning.</p><ul><li><strong>COUNTER</strong>: A value that only increases. In prometheus, the indicator is displayed as a change calculation function such as rate/irate.</li><li><strong>GAUGE</strong>: A type whose value can increase/decrease, such as like car gauge. In general, it is used to save the current metric value as it is, such as process count.</li></ul><div class=highlight><pre class=chroma><code class=language-go data-lang=go><span class=c1>// COUNTER
</span><span class=c1></span><span class=nx>ch</span> <span class=o>&lt;-</span> <span class=nx>prometheus</span><span class=p>.</span><span class=nf>MustNewConstMetric</span><span class=p>(</span><span class=nx>metric</span><span class=p>.</span><span class=nx>metricDesc</span><span class=p>,</span> <span class=nx>prometheus</span><span class=p>.</span><span class=nx>CounterValue</span><span class=p>,</span> <span class=nx>val</span><span class=p>,</span> <span class=nx>labelVals</span><span class=o>...</span><span class=p>)</span>

<span class=c1>// GAUGE
</span><span class=c1></span><span class=nx>ch</span> <span class=o>&lt;-</span> <span class=nx>prometheus</span><span class=p>.</span><span class=nf>MustNewConstMetric</span><span class=p>(</span><span class=nx>metric</span><span class=p>.</span><span class=nx>metricDesc</span><span class=p>,</span> <span class=nx>prometheus</span><span class=p>.</span><span class=nx>GaugeValue</span><span class=p>,</span> <span class=nx>val</span><span class=p>,</span> <span class=nx>labelVals</span><span class=o>...</span><span class=p>)</span>
</code></pre></div><p>For the value to be displayed as a metric, the value item specified in the setting is retrieved from the query result.</p><h2 id=queryexporter-source>QueryExporter Source</h2><p>Here’s the everything that I’ve done so far:</p><div class=highlight><pre class=chroma><code class=language-go data-lang=go><span class=kn>package</span> <span class=nx>main</span>
 
<span class=kn>import</span> <span class=p>(</span>
    <span class=s>&#34;database/sql&#34;</span>
    <span class=s>&#34;flag&#34;</span>
    <span class=s>&#34;io/ioutil&#34;</span>
    <span class=s>&#34;net/http&#34;</span>
    <span class=s>&#34;os&#34;</span>
    <span class=s>&#34;strconv&#34;</span>
    <span class=s>&#34;strings&#34;</span>
 
    <span class=s>&#34;github.com/ghodss/yaml&#34;</span>
    <span class=nx>_</span> <span class=s>&#34;github.com/go-sql-driver/mysql&#34;</span>
    <span class=s>&#34;github.com/prometheus/client_golang/prometheus&#34;</span>
    <span class=s>&#34;github.com/prometheus/client_golang/prometheus/promhttp&#34;</span>
    <span class=s>&#34;github.com/prometheus/common/version&#34;</span>
    <span class=nx>log</span> <span class=s>&#34;github.com/sirupsen/logrus&#34;</span>
<span class=p>)</span>
 
<span class=kd>var</span> <span class=nx>config</span> <span class=nx>Config</span>
 
<span class=kd>const</span> <span class=p>(</span>
    <span class=nx>collector</span> <span class=p>=</span> <span class=s>&#34;query_exporter&#34;</span>
<span class=p>)</span>
 
<span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
    <span class=kd>var</span> <span class=nx>err</span> <span class=kt>error</span>
    <span class=kd>var</span> <span class=nx>configFile</span><span class=p>,</span> <span class=nx>bind</span> <span class=kt>string</span>
    <span class=c1>// =====================
</span><span class=c1></span>    <span class=c1>// Get OS parameter
</span><span class=c1></span>    <span class=c1>// =====================
</span><span class=c1></span>    <span class=nx>flag</span><span class=p>.</span><span class=nf>StringVar</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>configFile</span><span class=p>,</span> <span class=s>&#34;config&#34;</span><span class=p>,</span> <span class=s>&#34;config.yml&#34;</span><span class=p>,</span> <span class=s>&#34;configuration file&#34;</span><span class=p>)</span>
    <span class=nx>flag</span><span class=p>.</span><span class=nf>StringVar</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>bind</span><span class=p>,</span> <span class=s>&#34;bind&#34;</span><span class=p>,</span> <span class=s>&#34;0.0.0.0:9104&#34;</span><span class=p>,</span> <span class=s>&#34;bind&#34;</span><span class=p>)</span>
    <span class=nx>flag</span><span class=p>.</span><span class=nf>Parse</span><span class=p>()</span>
 
    <span class=c1>// =====================
</span><span class=c1></span>    <span class=c1>// Load config &amp; yaml
</span><span class=c1></span>    <span class=c1>// =====================
</span><span class=c1></span>    <span class=kd>var</span> <span class=nx>b</span> <span class=p>[]</span><span class=kt>byte</span>
    <span class=k>if</span> <span class=nx>b</span><span class=p>,</span> <span class=nx>err</span> <span class=p>=</span> <span class=nx>ioutil</span><span class=p>.</span><span class=nf>ReadFile</span><span class=p>(</span><span class=nx>configFile</span><span class=p>);</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
        <span class=nx>log</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;Failed to read config file: %s&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>)</span>
        <span class=nx>os</span><span class=p>.</span><span class=nf>Exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
    <span class=p>}</span>
 
    <span class=c1>// Load yaml
</span><span class=c1></span>    <span class=k>if</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>yaml</span><span class=p>.</span><span class=nf>Unmarshal</span><span class=p>(</span><span class=nx>b</span><span class=p>,</span> <span class=o>&amp;</span><span class=nx>config</span><span class=p>);</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
        <span class=nx>log</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;Failed to load config: %s&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>)</span>
        <span class=nx>os</span><span class=p>.</span><span class=nf>Exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
    <span class=p>}</span>
 
    <span class=c1>// ========================
</span><span class=c1></span>    <span class=c1>// Regist handler
</span><span class=c1></span>    <span class=c1>// ========================
</span><span class=c1></span>    <span class=nx>log</span><span class=p>.</span><span class=nf>Infof</span><span class=p>(</span><span class=s>&#34;Regist version collector - %s&#34;</span><span class=p>,</span> <span class=nx>collector</span><span class=p>)</span>
    <span class=nx>prometheus</span><span class=p>.</span><span class=nf>Register</span><span class=p>(</span><span class=nx>version</span><span class=p>.</span><span class=nf>NewCollector</span><span class=p>(</span><span class=nx>collector</span><span class=p>))</span>
    <span class=nx>prometheus</span><span class=p>.</span><span class=nf>Register</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>QueryCollector</span><span class=p>{})</span>
 
    <span class=c1>// Regist http handler
</span><span class=c1></span>    <span class=nx>log</span><span class=p>.</span><span class=nf>Infof</span><span class=p>(</span><span class=s>&#34;HTTP handler path - %s&#34;</span><span class=p>,</span> <span class=s>&#34;/metrics&#34;</span><span class=p>)</span>
    <span class=nx>http</span><span class=p>.</span><span class=nf>HandleFunc</span><span class=p>(</span><span class=s>&#34;/metrics&#34;</span><span class=p>,</span> <span class=kd>func</span><span class=p>(</span><span class=nx>w</span> <span class=nx>http</span><span class=p>.</span><span class=nx>ResponseWriter</span><span class=p>,</span> <span class=nx>r</span> <span class=o>*</span><span class=nx>http</span><span class=p>.</span><span class=nx>Request</span><span class=p>)</span> <span class=p>{</span>
        <span class=nx>h</span> <span class=o>:=</span> <span class=nx>promhttp</span><span class=p>.</span><span class=nf>HandlerFor</span><span class=p>(</span><span class=nx>prometheus</span><span class=p>.</span><span class=nx>Gatherers</span><span class=p>{</span>
            <span class=nx>prometheus</span><span class=p>.</span><span class=nx>DefaultGatherer</span><span class=p>,</span>
        <span class=p>},</span> <span class=nx>promhttp</span><span class=p>.</span><span class=nx>HandlerOpts</span><span class=p>{})</span>
        <span class=nx>h</span><span class=p>.</span><span class=nf>ServeHTTP</span><span class=p>(</span><span class=nx>w</span><span class=p>,</span> <span class=nx>r</span><span class=p>)</span>
    <span class=p>})</span>
 
    <span class=c1>// start server
</span><span class=c1></span>    <span class=nx>log</span><span class=p>.</span><span class=nf>Infof</span><span class=p>(</span><span class=s>&#34;Starting http server - %s&#34;</span><span class=p>,</span> <span class=nx>bind</span><span class=p>)</span>
    <span class=k>if</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>http</span><span class=p>.</span><span class=nf>ListenAndServe</span><span class=p>(</span><span class=nx>bind</span><span class=p>,</span> <span class=kc>nil</span><span class=p>);</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
        <span class=nx>log</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;Failed to start http server: %s&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>)</span>
    <span class=p>}</span>
<span class=p>}</span>
 
<span class=c1>// =============================
</span><span class=c1>// Config config structure
</span><span class=c1>// =============================
</span><span class=c1></span><span class=kd>type</span> <span class=nx>Config</span> <span class=kd>struct</span> <span class=p>{</span>
    <span class=nx>DSN</span>     <span class=kt>string</span>
    <span class=nx>Metrics</span> <span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kd>struct</span> <span class=p>{</span>
        <span class=nx>Query</span>       <span class=kt>string</span>
        <span class=nx>Type</span>        <span class=kt>string</span>
        <span class=nx>Description</span> <span class=kt>string</span>
        <span class=nx>Labels</span>      <span class=p>[]</span><span class=kt>string</span>
        <span class=nx>Value</span>       <span class=kt>string</span>
        <span class=nx>metricDesc</span>  <span class=o>*</span><span class=nx>prometheus</span><span class=p>.</span><span class=nx>Desc</span>
    <span class=p>}</span>
<span class=p>}</span>
 
<span class=c1>// =============================
</span><span class=c1>// QueryCollector exporter
</span><span class=c1>// =============================
</span><span class=c1></span><span class=kd>type</span> <span class=nx>QueryCollector</span> <span class=kd>struct</span><span class=p>{}</span>
 
<span class=c1>// Describe prometheus describe
</span><span class=c1></span><span class=kd>func</span> <span class=p>(</span><span class=nx>e</span> <span class=o>*</span><span class=nx>QueryCollector</span><span class=p>)</span> <span class=nf>Describe</span><span class=p>(</span><span class=nx>ch</span> <span class=kd>chan</span><span class=o>&lt;-</span> <span class=o>*</span><span class=nx>prometheus</span><span class=p>.</span><span class=nx>Desc</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>for</span> <span class=nx>metricName</span><span class=p>,</span> <span class=nx>metric</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>config</span><span class=p>.</span><span class=nx>Metrics</span> <span class=p>{</span>
        <span class=nx>metric</span><span class=p>.</span><span class=nx>metricDesc</span> <span class=p>=</span> <span class=nx>prometheus</span><span class=p>.</span><span class=nf>NewDesc</span><span class=p>(</span>
            <span class=nx>prometheus</span><span class=p>.</span><span class=nf>BuildFQName</span><span class=p>(</span><span class=nx>collector</span><span class=p>,</span> <span class=s>&#34;&#34;</span><span class=p>,</span> <span class=nx>metricName</span><span class=p>),</span>
            <span class=nx>metric</span><span class=p>.</span><span class=nx>Description</span><span class=p>,</span>
            <span class=nx>metric</span><span class=p>.</span><span class=nx>Labels</span><span class=p>,</span> <span class=kc>nil</span><span class=p>,</span>
        <span class=p>)</span>
        <span class=nx>config</span><span class=p>.</span><span class=nx>Metrics</span><span class=p>[</span><span class=nx>metricName</span><span class=p>]</span> <span class=p>=</span> <span class=nx>metric</span>
        <span class=nx>log</span><span class=p>.</span><span class=nf>Infof</span><span class=p>(</span><span class=s>&#34;metric description for \&#34;%s\&#34; registerd&#34;</span><span class=p>,</span> <span class=nx>metricName</span><span class=p>)</span>
    <span class=p>}</span>
<span class=p>}</span>
 
<span class=c1>// Collect prometheus collect
</span><span class=c1></span><span class=kd>func</span> <span class=p>(</span><span class=nx>e</span> <span class=o>*</span><span class=nx>QueryCollector</span><span class=p>)</span> <span class=nf>Collect</span><span class=p>(</span><span class=nx>ch</span> <span class=kd>chan</span><span class=o>&lt;-</span> <span class=nx>prometheus</span><span class=p>.</span><span class=nx>Metric</span><span class=p>)</span> <span class=p>{</span>
 
    <span class=c1>// Connect to database
</span><span class=c1></span>    <span class=nx>db</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>sql</span><span class=p>.</span><span class=nf>Open</span><span class=p>(</span><span class=s>&#34;mysql&#34;</span><span class=p>,</span> <span class=nx>config</span><span class=p>.</span><span class=nx>DSN</span><span class=p>)</span>
    <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
        <span class=nx>log</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;Connect to database failed: %s&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>)</span>
        <span class=k>return</span>
    <span class=p>}</span>
    <span class=k>defer</span> <span class=nx>db</span><span class=p>.</span><span class=nf>Close</span><span class=p>()</span>
 
    <span class=c1>// Execute each queries in metrics
</span><span class=c1></span>    <span class=k>for</span> <span class=nx>name</span><span class=p>,</span> <span class=nx>metric</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>config</span><span class=p>.</span><span class=nx>Metrics</span> <span class=p>{</span>
 
        <span class=c1>// Execute query
</span><span class=c1></span>        <span class=nx>rows</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>db</span><span class=p>.</span><span class=nf>Query</span><span class=p>(</span><span class=nx>metric</span><span class=p>.</span><span class=nx>Query</span><span class=p>)</span>
        <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
            <span class=nx>log</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;Failed to execute query: %s&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>)</span>
            <span class=k>continue</span>
        <span class=p>}</span>
 
        <span class=c1>// Get column info
</span><span class=c1></span>        <span class=nx>cols</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>rows</span><span class=p>.</span><span class=nf>Columns</span><span class=p>()</span>
        <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
            <span class=nx>log</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;Failed to get column meta: %s&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>)</span>
            <span class=k>continue</span>
        <span class=p>}</span>
 
        <span class=nx>des</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>([]</span><span class=kd>interface</span><span class=p>{},</span> <span class=nb>len</span><span class=p>(</span><span class=nx>cols</span><span class=p>))</span>
        <span class=nx>res</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>([][]</span><span class=kt>byte</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=nx>cols</span><span class=p>))</span>
        <span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>cols</span> <span class=p>{</span>
            <span class=nx>des</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span> <span class=p>=</span> <span class=o>&amp;</span><span class=nx>res</span><span class=p>[</span><span class=nx>i</span><span class=p>]</span>
        <span class=p>}</span>
 
        <span class=c1>// fetch database
</span><span class=c1></span>        <span class=k>for</span> <span class=nx>rows</span><span class=p>.</span><span class=nf>Next</span><span class=p>()</span> <span class=p>{</span>
            <span class=nx>rows</span><span class=p>.</span><span class=nf>Scan</span><span class=p>(</span><span class=nx>des</span><span class=o>...</span><span class=p>)</span>
            <span class=nx>data</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>string</span><span class=p>)</span>
            <span class=k>for</span> <span class=nx>i</span><span class=p>,</span> <span class=nx>bytes</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>res</span> <span class=p>{</span>
                <span class=nx>data</span><span class=p>[</span><span class=nx>cols</span><span class=p>[</span><span class=nx>i</span><span class=p>]]</span> <span class=p>=</span> <span class=nb>string</span><span class=p>(</span><span class=nx>bytes</span><span class=p>)</span>
            <span class=p>}</span>
 
            <span class=c1>// Metric labels
</span><span class=c1></span>            <span class=nx>labelVals</span> <span class=o>:=</span> <span class=p>[]</span><span class=kt>string</span><span class=p>{}</span>
            <span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>label</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>metric</span><span class=p>.</span><span class=nx>Labels</span> <span class=p>{</span>
                <span class=nx>labelVals</span> <span class=p>=</span> <span class=nb>append</span><span class=p>(</span><span class=nx>labelVals</span><span class=p>,</span> <span class=nx>data</span><span class=p>[</span><span class=nx>label</span><span class=p>])</span>
            <span class=p>}</span>
 
            <span class=c1>// Metric value
</span><span class=c1></span>            <span class=nx>val</span><span class=p>,</span> <span class=nx>_</span> <span class=o>:=</span> <span class=nx>strconv</span><span class=p>.</span><span class=nf>ParseFloat</span><span class=p>(</span><span class=nx>data</span><span class=p>[</span><span class=nx>metric</span><span class=p>.</span><span class=nx>Value</span><span class=p>],</span> <span class=mi>64</span><span class=p>)</span>
 
            <span class=c1>// Add metric
</span><span class=c1></span>            <span class=k>switch</span> <span class=nx>strings</span><span class=p>.</span><span class=nf>ToLower</span><span class=p>(</span><span class=nx>metric</span><span class=p>.</span><span class=nx>Type</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>case</span> <span class=s>&#34;counter&#34;</span><span class=p>:</span>
                <span class=nx>ch</span> <span class=o>&lt;-</span> <span class=nx>prometheus</span><span class=p>.</span><span class=nf>MustNewConstMetric</span><span class=p>(</span><span class=nx>metric</span><span class=p>.</span><span class=nx>metricDesc</span><span class=p>,</span> <span class=nx>prometheus</span><span class=p>.</span><span class=nx>CounterValue</span><span class=p>,</span> <span class=nx>val</span><span class=p>,</span> <span class=nx>labelVals</span><span class=o>...</span><span class=p>)</span>
            <span class=k>case</span> <span class=s>&#34;gauge&#34;</span><span class=p>:</span>
                <span class=nx>ch</span> <span class=o>&lt;-</span> <span class=nx>prometheus</span><span class=p>.</span><span class=nf>MustNewConstMetric</span><span class=p>(</span><span class=nx>metric</span><span class=p>.</span><span class=nx>metricDesc</span><span class=p>,</span> <span class=nx>prometheus</span><span class=p>.</span><span class=nx>GaugeValue</span><span class=p>,</span> <span class=nx>val</span><span class=p>,</span> <span class=nx>labelVals</span><span class=o>...</span><span class=p>)</span>
            <span class=k>default</span><span class=p>:</span>
                <span class=nx>log</span><span class=p>.</span><span class=nf>Errorf</span><span class=p>(</span><span class=s>&#34;Fail to add metric for %s: %s is not valid type&#34;</span><span class=p>,</span> <span class=nx>name</span><span class=p>,</span> <span class=nx>metric</span><span class=p>.</span><span class=nx>Type</span><span class=p>)</span>
                <span class=k>continue</span>
            <span class=p>}</span>
        <span class=p>}</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div><p>If the package does not exist, run <code>go mod vendor</code> to download the necessary packages.</p><p>Start the server and check the information collected by the actual exporter.</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>$ go run .
INFO<span class=o>[</span>0000<span class=o>]</span> Regist version collector - query_exporter
INFO<span class=o>[</span>0000<span class=o>]</span> metric description <span class=k>for</span> <span class=s2>&#34;process_count_by_host&#34;</span> registerd
INFO<span class=o>[</span>0000<span class=o>]</span> metric description <span class=k>for</span> <span class=s2>&#34;process_count_by_user&#34;</span> registerd
INFO<span class=o>[</span>0000<span class=o>]</span> HTTP handler path - /metrics
INFO<span class=o>[</span>0000<span class=o>]</span> Starting http server - 0.0.0.0:9104
</code></pre></div><p>If you run it with curl, you can see that the session count per user/host defined in the settings is displayed.</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>$ curl 127.0.0.1:9104/metrics
<span class=c1># HELP go_gc_duration_seconds A summary of the pause duration of garbage collection cycles.</span>
<span class=c1># TYPE go_gc_duration_seconds summary</span>
go_gc_duration_seconds<span class=o>{</span><span class=nv>quantile</span><span class=o>=</span><span class=s2>&#34;0&#34;</span><span class=o>}</span> <span class=m>0</span>
go_gc_duration_seconds<span class=o>{</span><span class=nv>quantile</span><span class=o>=</span><span class=s2>&#34;0.25&#34;</span><span class=o>}</span> <span class=m>0</span>
 
.. skip ..
 
<span class=c1># HELP query_exporter_build_info A metric with a constant &#39;1&#39; value labeled by version, revision, branch, and goversion from which query_exporter was built.</span>
<span class=c1># TYPE query_exporter_build_info gauge</span>
query_exporter_build_info<span class=o>{</span><span class=nv>branch</span><span class=o>=</span><span class=s2>&#34;&#34;</span>,goversion<span class=o>=</span><span class=s2>&#34;go1.16.5&#34;</span>,revision<span class=o>=</span><span class=s2>&#34;&#34;</span>,version<span class=o>=</span><span class=s2>&#34;&#34;</span><span class=o>}</span> <span class=m>1</span>
<span class=c1># HELP query_exporter_process_count_by_host process count by host</span>
<span class=c1># TYPE query_exporter_process_count_by_host gauge</span>
query_exporter_process_count_by_host<span class=o>{</span><span class=nv>host</span><span class=o>=</span><span class=s2>&#34;localhost&#34;</span>,user<span class=o>=</span><span class=s2>&#34;event_scheduler&#34;</span><span class=o>}</span> <span class=m>1</span>
query_exporter_process_count_by_host<span class=o>{</span><span class=nv>host</span><span class=o>=</span><span class=s2>&#34;localhost&#34;</span>,user<span class=o>=</span><span class=s2>&#34;test&#34;</span><span class=o>}</span> <span class=m>1</span>
<span class=c1># HELP query_exporter_process_count_by_user process count by user</span>
<span class=c1># TYPE query_exporter_process_count_by_user gauge</span>
query_exporter_process_count_by_user<span class=o>{</span><span class=nv>user</span><span class=o>=</span><span class=s2>&#34;event_scheduler&#34;</span><span class=o>}</span> <span class=m>1</span>
query_exporter_process_count_by_user<span class=o>{</span><span class=nv>user</span><span class=o>=</span><span class=s2>&#34;test&#34;</span><span class=o>}</span> <span class=m>1</span>
</code></pre></div><p>This is the moment when your own Exporter is created at final!. 🙂</p><h2 id=concluding>Concluding..</h2><p>The post was very long. I put the source code in the body several times.. I feel like the amount of text is getting longer.</p><p>Anyway, I’ve created my own unique Exporter! <strong>I implemented a simple function to simply register a query and extract this result as a metric result</strong>, but I think you can add more interesting elements according to your own thoughts as needed.</p><p>For reference, the source written above is organized in the following Git.</p><blockquote><p><a href=https://github.com/go-gywn/query-exporter-simple>https://github.com/go-gywn/query-exporter-simple</a></p></blockquote><p>Sometimes, when I need to monitor hundreds and thousands of servers from one monitoring server, it is sometimes useful to manage the collection of metrics. As of yet, only support with MySQL, I personally create another Query Exporter project. I implemented more parallel processing and timeouts in the above project base.</p><blockquote><p><a href=https://github.com/go-gywn/query-exporter>https://github.com/go-gywn/query-exporter</a></p></blockquote><p>It’s always been like that… If there is nothing, just create and it If there is, use it well!</p><p>I hope to all you have a nice summer. <span aria-label="End of article." role=text class=tombstone>∎</span></p></div><div class=bios><div class=bios__bio><img class=avatar src=https://percona.community/blog/authors/dongchan_sung_huf2e8cb469322af0881a41e1f22add22f_242669_240x240_fill_q90_bgffffff_lanczos_smart1_2.jpg alt><div class=bios__content><h2><span>Dongchan Sung</span></h2><p>MySQL DBA, KakaoBank</p><p>Dongchan is DBA at KakaoBank, the Korean internet bank. He is very interested in data efficient processing and automation. His final goal is building unbreakable data system. He is interested in all elements (monitoring, automation) for a stable system configuration. <a href=https://gywn.blog target=_blank rel="noopener noreferrer">https://gywn.blog</a></p><p><a href=/authors/dongchan_sung>See all posts by Dongchan Sung &#187;</a></p></div></div></div></article><h2>Comments</h2><div id=disqus_thread></div><script>var disqus_config=function(){this.page.url="https://percona.community/blog/2021/07/21/create-your-own-exporter-in-go/"};(function(){var a=document,b=a.createElement('script');b.src='https://percona-community01.disqus.com/embed.js',b.setAttribute('data-timestamp',+new Date),(a.head||a.body).appendChild(b)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><div class=sharing><a class=resp-sharing-button__link href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fpercona.community%2fblog%2f2021%2f07%2f21%2fcreate-your-own-exporter-in-go%2f" target=_blank rel=noopener aria-label="Share on Facebook"><div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--large"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18.77 7.46H14.5v-1.9c0-.9.6-1.1 1-1.1h3V.5h-4.33C10.24.5 9.5 3.44 9.5 5.32v2.15h-3v4h3v12h5v-12h3.85l.42-4z"/></svg></div><span>Share on Facebook</span></div></a><a class=resp-sharing-button__link href="https://twitter.com/intent/tweet/?text=Create%20your%20own%20Exporter%20in%20Go%21&url=https%3a%2f%2fpercona.community%2fblog%2f2021%2f07%2f21%2fcreate-your-own-exporter-in-go%2f" target=_blank rel=noopener aria-label="Share on Twitter"><div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--large"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M23.44 4.83c-.8.37-1.5.38-2.22.02.93-.56.98-.96 1.32-2.02-.88.52-1.86.9-2.9 1.1-.82-.88-2-1.43-3.3-1.43-2.5.0-4.55 2.04-4.55 4.54.0.36.03.7.1 1.04-3.77-.2-7.12-2-9.36-4.75-.4.67-.6 1.45-.6 2.3.0 1.56.8 2.95 2 3.77-.74-.03-1.44-.23-2.05-.57v.06c0 2.2 1.56 4.03 3.64 4.44-.67.2-1.37.2-2.06.08.58 1.8 2.26 3.12 4.25 3.16C5.78 18.1 3.37 18.74 1 18.46c2 1.3 4.4 2.04 6.97 2.04 8.35.0 12.92-6.92 12.92-12.93.0-.2.0-.4-.02-.6.9-.63 1.96-1.22 2.56-2.14z"/></svg></div><span>Share on Twitter</span></div></a><a class=resp-sharing-button__link href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fpercona.community%2fblog%2f2021%2f07%2f21%2fcreate-your-own-exporter-in-go%2f&title=Create%20your%20own%20Exporter%20in%20Go%21&source=https%3a%2f%2fpercona.community%2fblog%2f2021%2f07%2f21%2fcreate-your-own-exporter-in-go%2f" target=_blank rel=noopener aria-label="Share on LinkedIn"><div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--large"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6.5 21.5h-5v-13h5v13zM4 6.5C2.5 6.5 1.5 5.3 1.5 4s1-2.4 2.5-2.4c1.6.0 2.5 1 2.6 2.5.0 1.4-1 2.5-2.6 2.5zm11.5 6c-1 0-2 1-2 2v7h-5v-13h5V10s1.6-1.5 4-1.5c3 0 5 2.2 5 6.3v6.7h-5v-7c0-1-1-2-2-2z"/></svg></div><span>Share on LinkedIn</span></div></a><a class=resp-sharing-button__link href="https://telegram.me/share/url?text=Create%20your%20own%20Exporter%20in%20Go%21&url=https%3a%2f%2fpercona.community%2fblog%2f2021%2f07%2f21%2fcreate-your-own-exporter-in-go%2f" target=_blank rel=noopener aria-label="Share on Telegram"><div class="resp-sharing-button resp-sharing-button--telegram resp-sharing-button--large"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M.707 8.475C.275 8.64.0 9.508.0 9.508s.284.867.718 1.03l5.09 1.897 1.986 6.38a1.102 1.102.0 001.75.527l2.96-2.41a.405.405.0 01.494-.013l5.34 3.87a1.1 1.1.0 001.046.135 1.1 1.1.0 00.682-.803l3.91-18.795A1.102 1.102.0 0022.5.075L.706 8.475z"/></svg></div><span>Share on Telegram</span></div></a></div><div class=recommendations><h2>Did you like this post? Why not read more?</h2><div class="grid grid--3"><div class=grid__item><a href=/blog/2021/06/11/exporters-roadmap/ class="post post--preview"><img src=/blog/2021/06/pmm-exporters_hu5b65fe77de3d8ecbd49f54c34a05e94f_157505_682x384_fill_q90_lanczos_smart1.jpg alt><h3>Exporters Roadmap</h3><div class=post__content><p>Exporters Roadmap Goals Prometheus exports as a part of PMM are a big and valuable component.</p><p class=readmore>Read more &#187;</p></div></a></div><div class=grid__item><a href=/blog/2020/10/26/zero-downtime-schema-change-with-liquibase-percona/ class="post post--preview"><img src=/blog/2020/10/image1-1_hu39d62df260003be06185a1cbca157a95_85301_682x384_fill_q90_bgffffff_lanczos_smart1_2.jpg alt><h3>Zero downtime schema change with Liquibase & Percona</h3><div class=post__content><p>I am always surprised to learn something new whenever I talk to a member of the open-source community. No matter how much I think I have heard of every use case there is for Liquibase (and database change management in general), I always hear something that makes this space still feel new. There’s always something left to discover.</p><p class=readmore>Read more &#187;</p></div></a></div><div class=grid__item><a href=/blog/2020/10/23/mayastor-lightning-fast-storage-for-kubernetes/ class="post post--preview"><img src=/blog/2020/10/image1_hu0058aafb73561bafb40ca0ee88928b8e_244534_682x384_fill_q90_bgffffff_lanczos_smart1_2.jpg alt><h3>Mayastor: Lightning Fast Storage for Kubernetes</h3><div class=post__content><p>At MayaData we like new tech. Tech that makes our databases perform better. Tech like lockless ring buffers, NVMe-oF, and Kubernetes. In this blog post we’re going to see those technologies at work to give us awesome block storage performance with flexibility and simple operations.</p><p class=readmore>Read more &#187;</p></div></a></div></div></div></div></main><div class=img_banner><div class=img_banner__content><a href=https://www.perconalive.com/eSites/eventregistration/Homepage target=_blank><img style=width:100% src=/home/PL23-CFP-footer-web.jpg alt="Percona Live 2023 - CFP"></a></div></div><div class=edit-on-github><div class=container><a href=https://github.com/percona/community/edit/main/content/blog/2021-07-21-create-your-own-exporter-in-go.md target=_blank rel="noreferrer noopener">✎ Edit this page on GitHub</a></div></div><footer class=page><p class=aria-only id=footer-heading aria-hidden=false>Footer</p><div class=page-footer><nav class=footer><div class=abc><ul><li><a href=https://www.percona.com/about-percona target=_blank rel="noopener noreferrer"><span>About</span></a></li><li><a href=https://www.percona.com/legal target=_blank rel="noopener noreferrer"><span>Legal</span></a></li><li><a href=https://www.percona.com/about-percona/contact target=_blank rel="noopener noreferrer"><span>Contact</span></a></li><li><a href=https://forums.percona.com target=_blank rel="noopener noreferrer"><span>Forums</span></a></li><li><a href=http://per.co.na/discord target=_blank rel="noopener noreferrer"><span>Discord</span></a></li><li><a href=/map><span>Sitemap</span></a></li><li><a class=cmp-revoke-consent>Revoke Consent</a></li></ul></div></nav></div><div><aside>© Percona Community. MySQL, InnoDB, MariaDB and MongoDB are trademarks of their respective owners.</aside></div></footer><script type=text/javascript src=https://percona.community/js/aria.5f30892348d4662fe548bb410f15fc6fe2e1cbfd6473beb3c3ed1d6b362568bbea48896a9f2302a4f78f4614904ca3ef43155ae26f063ed84ae957f951e19647.js integrity="sha512-XzCJI0jUZi/lSLtBDxX8b+Lhy/1kc76zw+0dazYlaLvqSIlqnyMCpPePRhSQTKPvQxVa4m8GPthK6Vf5UeGWRw==" defer></script></body></html>