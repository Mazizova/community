<!doctype html><html lang=en prefix="og: https://ogp.me/ns#"><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1,minimum-scale=1"><title>The Anatomy of LuaJIT Tables and What's Special About Them | Percona Community</title><meta name=description content="I don&rsquo;t know about you, but I really like to get inside all sorts of systems. In this article, I’m going to tell you about the internals of Lua tables …"><link rel="shortcut icon" href=/icons/cropped-percona-favicon-32x32.png type=image/png><link rel=icon href=https://redesign.percona.com/wp-content/uploads/2023/01/cropped-percona-favicon-32x32.png sizes=32x32><link rel=icon href=https://redesign.percona.com/wp-content/uploads/2023/01/cropped-percona-favicon-192x192.png sizes=192x192><link rel=canonical href=https://percona.community/blog/2020/04/29/the-anatomy-of-luajit-tables-and-whats-special-about-them/><meta name=robots content="index,follow"><meta property="og:title" content="The Anatomy of LuaJIT Tables and What's Special About Them"><meta property="og:description" content="I don&rsquo;t know about you, but I really like to get inside all sorts of systems. In this article, I’m going to tell you about the internals of Lua tables and special considerations for their use. Lua is my primary professional programming language, and if one wants to write good code, one needs at least to peek behind the curtain. If you are curious, follow me.
  Lua has several implementations and several versions."><meta property="og:type" content="article"><meta property="og:url" content="https://percona.community/blog/2020/04/29/the-anatomy-of-luajit-tables-and-whats-special-about-them/"><meta name=image property="og:image" content="https://percona.community/blog/2020/04/xeyzb9g_fodczvifb-xym4-qdwa_hud2e36e00517dccce7bb36cc8d88a613c_49363_1200x0_resize_q90_bgffffff_lanczos_2.jpg"><meta property="article:published_time" content="2020-04-29T13:18:37+00:00"><meta property="article:modified_time" content="2020-04-29T13:18:37+00:00"><meta property="article:section" content="blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://percona.community/blog/2020/04/xeyzb9g_fodczvifb-xym4-qdwa.png"><meta name=twitter:title content="The Anatomy of LuaJIT Tables and What's Special About Them | Percona Community"><meta name=twitter:description content="I don&rsquo;t know about you, but I really like to get inside all sorts of systems. In this article, I’m going to tell you about the internals of Lua tables and special considerations for their use. Lua is my primary professional programming language, and if one wants to write good code, one needs at least to peek behind the curtain. If you are curious, follow me.
  Lua has several implementations and several versions."><meta name=twitter:site content="@Percona"><meta name=copyright content="© Percona Community. MySQL, InnoDB, MariaDB and MongoDB are trademarks of their respective owners.
"><meta name=author content="Yaroslav Dynnikov"><style>@charset "UTF-8";html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td,article,aside,canvas,details,embed,figure,figcaption,footer,header,hgroup,menu,nav,output,ruby,section,summary,time,mark,audio,video{margin:0;padding:0;border:0;vertical-align:baseline}article,aside,details,figcaption,figure,footer,header,hgroup,menu,nav,section{display:block}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after{content:none}q:before,q:after{content:none}table{border-collapse:collapse;border-spacing:0}html,body{font-family:poppins,Helvetica,Arial,Lucida,sans-serif;scroll-behavior:smooth;text-rendering:optimizeSpeed;-webkit-font-smoothing:antialiased;line-height:1.5rem;font-feature-settings:"liga" 1;font-weight:400;font-size:18px}@media(min-width:900px){html,body{font-size:20px}}@media(min-width:1100px){html,body{font-size:22px}}@media(min-width:1800px){html,body{font-size:24px}}@media print{html,body{font-size:18px}}.body .meta{padding-bottom:1rem}@media screen and (min-width:760px){.body{padding:2rem}.body .body{padding:1rem 4rem}}h1,h2,h3,h4{font-weight:400}p:empty{display:none}.branded h2{color:#697793}.branded .view-all{color:#00bda5;text-decoration-color:#00bda5}.view-all{font-size:.75rem;font-weight:400}hr{border:0;height:2px;background-color:#fe7f2d;margin-top:1.5rem;margin-bottom:1.5rem}.text{position:relative}.text h1,.text h2,.text h3,.text h4,.text h5,.text h6{font-family:poppins,Helvetica,Arial,Lucida,sans-serif;font-weight:400;page-break-after:avoid}.text h1 a,.text h1 a:visited,.text h2 a,.text h2 a:visited,.text h3 a,.text h3 a:visited,.text h4 a,.text h4 a:visited,.text h5 a,.text h5 a:visited,.text h6 a,.text h6 a:visited{color:#333;text-decoration:none}.text p,.text ul,.text ol,.text figure,.text dl,.text hr{margin-top:.75rem;font-size:.75rem;line-height:1.5rem}.text a{color:#00bda5;text-decoration-color:#00bda5}.text q{font-style:italic}.text ul ul{margin-top:0}.text p>code,.text ul>code,.text ol>code,.text dt>code,.text dd>code,.text li>code{color:#42536d}.text audio{display:block;width:100%;height:1.5rem;outline:none}.text audio span{line-height:1.5rem}.text dl{overflow:auto;position:relative}.text dt{font-weight:700}.text dd{padding-left:2rem}.text dd+dt{margin-top:1.5rem}.text ul{list-style-type:disc;padding-left:1.5rem}.text ol{list-style-type:decimal;padding-left:1.5rem}.text p{overflow-wrap:break-word;word-wrap:break-word;-webkit-hyphens:auto;-moz-hyphens:auto;-ms-hyphens:auto;hyphens:auto}.text h1{font-size:2rem;font-weight:600;line-height:2rem;margin-top:1.5rem;margin-bottom:1rem}@media screen and (min-width:760px){.text h1{font-size:2rem;line-height:2.5rem;margin-top:1.5rem}}@media screen and (min-width:900px){.text h1{font-size:2rem;line-height:2.5rem;margin-top:3rem}}.text h2{font-size:1.5rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem}.text h3{font-size:1.25rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem}.text h4{font-size:1rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem;font-size:1.1rem}.text h5{font-size:.8rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem}.text h6{font-size:.6rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem}.text strong{font-weight:700}.text em{font-style:italic}.text .meta{color:#8897b3;font-weight:600;font-variant:small-caps}.text .meta .byline{display:none}.text .meta .line{display:inline-block}.text .meta .calendar{display:none}.text .meta a{color:#8897b3;text-decoration-color:#8897b3}.text .meta a:hover{color:#42536d;text-decoration-color:#42536d}.text code{font-family:lucida console,Monaco,monospace;speak:literal-punctuation}.text abbr,.text acronym{speak:spell-out}.text del{text-decoration:line-through}.text ins{text-decoration:none;font-style:italic}.text figure{position:relative;text-align:center}.text figure img{background:#fff;border-radius:.2rem;max-width:100%}.text figure table{min-width:75%;border-radius:.2rem;margin-left:auto;margin-right:auto;border:#42536d;border-collapse:separate;border-spacing:0;background:#fff;margin-bottom:-.1em}.text figure table th,.text figure table td{padding-left:.75rem;padding-right:.75rem;line-height:1.3rem;border-left:.1rem solid #42536d;border-top:.1rem solid #42536d}.text figure table thead{background-color:#fff}.text figure table tr td:last-child,.text figure table tr th:last-child{border-right:.1rem solid #42536d}.text figure table tbody:last-child tr:last-child td{border-bottom:.1rem solid #42536d}.text figure table thead:first-child tr:first-child th:first-child,.text figure table thead:first-child tr:first-child td:first-child{border-top-left-radius:.2rem}.text figure table thead:first-child tr:first-child,.text figure table thead:first-child tr:first-child th:last-child,.text figure table thead:first-child tr:first-child td:last-child{border-top-right-radius:.2rem}.text figure table tbody:last-child tr:last-child,.text figure table tbody:last-child tr:last-child td:first-child{border-bottom-left-radius:.2rem}.text figure table tbody:last-child tr:last-child,.text figure table tbody:last-child tr:last-child td:last-child{border-bottom-right-radius:.2rem}.text figure ul{text-align:left}.text figure ul.tree{padding-top:1.5em;padding-bottom:1.5em;border-radius:.2rem;background:#fff}.text figure ul.tree li{list-style-type:none}.text figure ul.tree .tree__item--folder::before{content:"📁";margin-right:.2em}.text figure ul.tree .tree__item--file::before{content:"📝";margin-right:.2em}.text figure figcaption{font-style:italic}.text pre{margin-top:1.5rem;font-size:inherit;line-height:1.5rem;padding:1.5rem 1.5rem .75rem;white-space:pre;overflow-x:scroll;overflow-y:hidden;scrollbar-color:#cccccc transparent;scrollbar-width:.75rem}.text pre::-webkit-scrollbar{margin-top:-.75rem;height:.75rem}.text pre::-webkit-scrollbar-track{background:0 0}.text pre::-webkit-scrollbar-thumb{height:.1rem;border-radius:.2rem;background:#ccc}.text hr{border:0;height:.2rem;background:#42536d;margin-top:1.3rem}.text .admonition{position:relative}.text .admonition>*{padding-left:2rem}.text .admonition>:first-child::before{display:block;text-align:left;position:absolute;top:0;left:0;width:.75rem;font-size:1rem;line-height:1.5rem;height:1.5rem}.text .admonition--tip>:first-child::before{content:"☛";color:#fefefe;font-size:1.5rem;line-height:1.5rem;height:1.5rem}.text .admonition--warning>:first-child::before{content:"⚠️";color:#fefefe}.text .admonition--info>:first-child::before{content:"ⓘ";color:#42536d;font-weight:700}@media print{.text h1{margin-left:auto;margin-right:auto;margin-top:9rem;width:80%;font-variant:small-caps;text-align:center}.text--simple h1{margin-top:0}.text .meta{page-break-after:always;text-align:center;font-size:1.2rem;margin-top:1.5rem}.text .meta a{text-decoration:none}.text .meta time{display:none}.text .body p:first-of-type{margin-top:0}.text pre{padding:0;font-size:inherit;line-height:1.5rem;overflow:hidden;white-space:pre-wrap;word-break:break-all}}.text .podcasts{margin-top:1.5rem;text-align:center}.text a.podcast{display:block;height:3rem}.text a.podcast img{width:50%;max-width:200px}@media screen and (min-width:768px){.text .podcasts{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));grid-gap:1.5rem}.text a.podcast img{width:100%}}.text .tombstone{opacity:0}html,body{min-height:100vh}body{text-align:center}@media screen{body{color:#333;background-color:#fefefe}}@media print{body{color:#000;background:#fff}}@media screen{body{display:flex;flex-direction:column}main.page{width:100%;flex:1}}header.page,main.page,footer.page{text-align:left}.page-main,.contentblock{max-width:1200px;padding-left:1.5rem;padding-right:1.5rem;margin-left:auto;margin-right:auto}@media print{.page-main,.contentblock{padding:0}}@page{size:A4;padding:0;margin:3rem}.highlight{color:#42536d}.nobr{white-space:nowrap}.aria-only{display:none}@media aural{.aria-only{display:block}}button{cursor:pointer;display:block;font-weight:700;margin:0 auto;border:.1rem solid #fe7f2d;background-color:#fe7f2d;font-size:1.2rem;border-radius:.9rem;padding:.6rem;transition:color .233s ease-in-out,background-color .233s ease-in-out}button:hover{background-color:#42536d;border:.1rem solid #42536d}blockquote{padding:0 2rem;margin:0 2rem}blockquote:before{display:block;content:"\1f5e8";font-size:2rem;padding:1rem 0 0;margin:0 0 -1.8rem -2rem;height:max-content;color:#fe7f2d;font-weight:700}a{color:#42536d;font-weight:700;text-decoration-color:#42536d;transition:color .233s ease-out,text-decoration-color .233s ease-out}a:hover,a:visited:hover{color:#fe7f2d;text-decoration-color:#fe7f2d}a:active{color:#fe7f2d;text-decoration-color:#fe7f2d}a:visited{color:#333}a.downloadbtn{text-decoration:none}html,body{font-family:poppins,Helvetica,Arial,Lucida,sans-serif;scroll-behavior:smooth;text-rendering:optimizeSpeed;-webkit-font-smoothing:antialiased;line-height:1.5rem;font-feature-settings:"liga" 1;font-weight:400;font-size:18px}@media(min-width:900px){html,body{font-size:20px}}@media(min-width:1100px){html,body{font-size:22px}}@media(min-width:1800px){html,body{font-size:24px}}@media print{html,body{font-size:18px}}.body .meta{padding-bottom:1rem}@media screen and (min-width:760px){.body{padding:2rem}.body .body{padding:1rem 4rem}}h1,h2,h3,h4{font-weight:400}p:empty{display:none}.branded h2{color:#697793}.branded .view-all{color:#00bda5;text-decoration-color:#00bda5}.view-all{font-size:.75rem;font-weight:400}hr{border:0;height:2px;background-color:#fe7f2d;margin-top:1.5rem;margin-bottom:1.5rem}.text{position:relative}.text h1,.text h2,.text h3,.text h4,.text h5,.text h6{font-family:poppins,Helvetica,Arial,Lucida,sans-serif;font-weight:400;page-break-after:avoid}.text h1 a,.text h1 a:visited,.text h2 a,.text h2 a:visited,.text h3 a,.text h3 a:visited,.text h4 a,.text h4 a:visited,.text h5 a,.text h5 a:visited,.text h6 a,.text h6 a:visited{color:#333;text-decoration:none}.text p,.text ul,.text ol,.text figure,.text dl,.text hr{margin-top:.75rem;font-size:.75rem;line-height:1.5rem}.text a{color:#00bda5;text-decoration-color:#00bda5}.text q{font-style:italic}.text ul ul{margin-top:0}.text p>code,.text ul>code,.text ol>code,.text dt>code,.text dd>code,.text li>code{color:#42536d}.text audio{display:block;width:100%;height:1.5rem;outline:none}.text audio span{line-height:1.5rem}.text dl{overflow:auto;position:relative}.text dt{font-weight:700}.text dd{padding-left:2rem}.text dd+dt{margin-top:1.5rem}.text ul{list-style-type:disc;padding-left:1.5rem}.text ol{list-style-type:decimal;padding-left:1.5rem}.text p{overflow-wrap:break-word;word-wrap:break-word;-webkit-hyphens:auto;-moz-hyphens:auto;-ms-hyphens:auto;hyphens:auto}.text h1{font-size:2rem;font-weight:600;line-height:2rem;margin-top:1.5rem;margin-bottom:1rem}@media screen and (min-width:760px){.text h1{font-size:2rem;line-height:2.5rem;margin-top:1.5rem}}@media screen and (min-width:900px){.text h1{font-size:2rem;line-height:2.5rem;margin-top:3rem}}.text h2{font-size:1.5rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem}.text h3{font-size:1.25rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem}.text h4{font-size:1rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem;font-size:1.1rem}.text h5{font-size:.8rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem}.text h6{font-size:.6rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem}.text strong{font-weight:700}.text em{font-style:italic}.text .meta{color:#8897b3;font-weight:600;font-variant:small-caps}.text .meta .byline{display:none}.text .meta .line{display:inline-block}.text .meta .calendar{display:none}.text .meta a{color:#8897b3;text-decoration-color:#8897b3}.text .meta a:hover{color:#42536d;text-decoration-color:#42536d}.text code{font-family:lucida console,Monaco,monospace;speak:literal-punctuation}.text abbr,.text acronym{speak:spell-out}.text del{text-decoration:line-through}.text ins{text-decoration:none;font-style:italic}.text figure{position:relative;text-align:center}.text figure img{background:#fff;border-radius:.2rem;max-width:100%}.text figure table{min-width:75%;border-radius:.2rem;margin-left:auto;margin-right:auto;border:#42536d;border-collapse:separate;border-spacing:0;background:#fff;margin-bottom:-.1em}.text figure table th,.text figure table td{padding-left:.75rem;padding-right:.75rem;line-height:1.3rem;border-left:.1rem solid #42536d;border-top:.1rem solid #42536d}.text figure table thead{background-color:#fff}.text figure table tr td:last-child,.text figure table tr th:last-child{border-right:.1rem solid #42536d}.text figure table tbody:last-child tr:last-child td{border-bottom:.1rem solid #42536d}.text figure table thead:first-child tr:first-child th:first-child,.text figure table thead:first-child tr:first-child td:first-child{border-top-left-radius:.2rem}.text figure table thead:first-child tr:first-child,.text figure table thead:first-child tr:first-child th:last-child,.text figure table thead:first-child tr:first-child td:last-child{border-top-right-radius:.2rem}.text figure table tbody:last-child tr:last-child,.text figure table tbody:last-child tr:last-child td:first-child{border-bottom-left-radius:.2rem}.text figure table tbody:last-child tr:last-child,.text figure table tbody:last-child tr:last-child td:last-child{border-bottom-right-radius:.2rem}.text figure ul{text-align:left}.text figure ul.tree{padding-top:1.5em;padding-bottom:1.5em;border-radius:.2rem;background:#fff}.text figure ul.tree li{list-style-type:none}.text figure ul.tree .tree__item--folder::before{content:"📁";margin-right:.2em}.text figure ul.tree .tree__item--file::before{content:"📝";margin-right:.2em}.text figure figcaption{font-style:italic}.text pre{margin-top:1.5rem;font-size:inherit;line-height:1.5rem;padding:1.5rem 1.5rem .75rem;white-space:pre;overflow-x:scroll;overflow-y:hidden;scrollbar-color:#cccccc transparent;scrollbar-width:.75rem}.text pre::-webkit-scrollbar{margin-top:-.75rem;height:.75rem}.text pre::-webkit-scrollbar-track{background:0 0}.text pre::-webkit-scrollbar-thumb{height:.1rem;border-radius:.2rem;background:#ccc}.text hr{border:0;height:.2rem;background:#42536d;margin-top:1.3rem}.text .admonition{position:relative}.text .admonition>*{padding-left:2rem}.text .admonition>:first-child::before{display:block;text-align:left;position:absolute;top:0;left:0;width:.75rem;font-size:1rem;line-height:1.5rem;height:1.5rem}.text .admonition--tip>:first-child::before{content:"☛";color:#fefefe;font-size:1.5rem;line-height:1.5rem;height:1.5rem}.text .admonition--warning>:first-child::before{content:"⚠️";color:#fefefe}.text .admonition--info>:first-child::before{content:"ⓘ";color:#42536d;font-weight:700}@media print{.text h1{margin-left:auto;margin-right:auto;margin-top:9rem;width:80%;font-variant:small-caps;text-align:center}.text--simple h1{margin-top:0}.text .meta{page-break-after:always;text-align:center;font-size:1.2rem;margin-top:1.5rem}.text .meta a{text-decoration:none}.text .meta time{display:none}.text .body p:first-of-type{margin-top:0}.text pre{padding:0;font-size:inherit;line-height:1.5rem;overflow:hidden;white-space:pre-wrap;word-break:break-all}}.text .podcasts{margin-top:1.5rem;text-align:center}.text a.podcast{display:block;height:3rem}.text a.podcast img{width:50%;max-width:200px}@media screen and (min-width:768px){.text .podcasts{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));grid-gap:1.5rem}.text a.podcast img{width:100%}}.text .tombstone{opacity:0}html,body{font-family:poppins,Helvetica,Arial,Lucida,sans-serif;scroll-behavior:smooth;text-rendering:optimizeSpeed;-webkit-font-smoothing:antialiased;line-height:1.5rem;font-feature-settings:"liga" 1;font-weight:400;font-size:18px}@media(min-width:900px){html,body{font-size:20px}}@media(min-width:1100px){html,body{font-size:22px}}@media(min-width:1800px){html,body{font-size:24px}}@media print{html,body{font-size:18px}}.body .meta{padding-bottom:1rem}@media screen and (min-width:760px){.body{padding:2rem}.body .body{padding:1rem 4rem}}h1,h2,h3,h4{font-weight:400}p:empty{display:none}.branded h2{color:#697793}.branded .view-all{color:#00bda5;text-decoration-color:#00bda5}.view-all{font-size:.75rem;font-weight:400}hr{border:0;height:2px;background-color:#fe7f2d;margin-top:1.5rem;margin-bottom:1.5rem}.text{position:relative}.text h1,.text h2,.text h3,.text h4,.text h5,.text h6{font-family:poppins,Helvetica,Arial,Lucida,sans-serif;font-weight:400;page-break-after:avoid}.text h1 a,.text h1 a:visited,.text h2 a,.text h2 a:visited,.text h3 a,.text h3 a:visited,.text h4 a,.text h4 a:visited,.text h5 a,.text h5 a:visited,.text h6 a,.text h6 a:visited{color:#333;text-decoration:none}.text p,.text ul,.text ol,.text figure,.text dl,.text hr{margin-top:.75rem;font-size:.75rem;line-height:1.5rem}.text a{color:#00bda5;text-decoration-color:#00bda5}.text q{font-style:italic}.text ul ul{margin-top:0}.text p>code,.text ul>code,.text ol>code,.text dt>code,.text dd>code,.text li>code{color:#42536d}.text audio{display:block;width:100%;height:1.5rem;outline:none}.text audio span{line-height:1.5rem}.text dl{overflow:auto;position:relative}.text dt{font-weight:700}.text dd{padding-left:2rem}.text dd+dt{margin-top:1.5rem}.text ul{list-style-type:disc;padding-left:1.5rem}.text ol{list-style-type:decimal;padding-left:1.5rem}.text p{overflow-wrap:break-word;word-wrap:break-word;-webkit-hyphens:auto;-moz-hyphens:auto;-ms-hyphens:auto;hyphens:auto}.text h1{font-size:2rem;font-weight:600;line-height:2rem;margin-top:1.5rem;margin-bottom:1rem}@media screen and (min-width:760px){.text h1{font-size:2rem;line-height:2.5rem;margin-top:1.5rem}}@media screen and (min-width:900px){.text h1{font-size:2rem;line-height:2.5rem;margin-top:3rem}}.text h2{font-size:1.5rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem}.text h3{font-size:1.25rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem}.text h4{font-size:1rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem;font-size:1.1rem}.text h5{font-size:.8rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem}.text h6{font-size:.6rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem}.text strong{font-weight:700}.text em{font-style:italic}.text .meta{color:#8897b3;font-weight:600;font-variant:small-caps}.text .meta .byline{display:none}.text .meta .line{display:inline-block}.text .meta .calendar{display:none}.text .meta a{color:#8897b3;text-decoration-color:#8897b3}.text .meta a:hover{color:#42536d;text-decoration-color:#42536d}.text code{font-family:lucida console,Monaco,monospace;speak:literal-punctuation}.text abbr,.text acronym{speak:spell-out}.text del{text-decoration:line-through}.text ins{text-decoration:none;font-style:italic}.text figure{position:relative;text-align:center}.text figure img{background:#fff;border-radius:.2rem;max-width:100%}.text figure table{min-width:75%;border-radius:.2rem;margin-left:auto;margin-right:auto;border:#42536d;border-collapse:separate;border-spacing:0;background:#fff;margin-bottom:-.1em}.text figure table th,.text figure table td{padding-left:.75rem;padding-right:.75rem;line-height:1.3rem;border-left:.1rem solid #42536d;border-top:.1rem solid #42536d}.text figure table thead{background-color:#fff}.text figure table tr td:last-child,.text figure table tr th:last-child{border-right:.1rem solid #42536d}.text figure table tbody:last-child tr:last-child td{border-bottom:.1rem solid #42536d}.text figure table thead:first-child tr:first-child th:first-child,.text figure table thead:first-child tr:first-child td:first-child{border-top-left-radius:.2rem}.text figure table thead:first-child tr:first-child,.text figure table thead:first-child tr:first-child th:last-child,.text figure table thead:first-child tr:first-child td:last-child{border-top-right-radius:.2rem}.text figure table tbody:last-child tr:last-child,.text figure table tbody:last-child tr:last-child td:first-child{border-bottom-left-radius:.2rem}.text figure table tbody:last-child tr:last-child,.text figure table tbody:last-child tr:last-child td:last-child{border-bottom-right-radius:.2rem}.text figure ul{text-align:left}.text figure ul.tree{padding-top:1.5em;padding-bottom:1.5em;border-radius:.2rem;background:#fff}.text figure ul.tree li{list-style-type:none}.text figure ul.tree .tree__item--folder::before{content:"📁";margin-right:.2em}.text figure ul.tree .tree__item--file::before{content:"📝";margin-right:.2em}.text figure figcaption{font-style:italic}.text pre{margin-top:1.5rem;font-size:inherit;line-height:1.5rem;padding:1.5rem 1.5rem .75rem;white-space:pre;overflow-x:scroll;overflow-y:hidden;scrollbar-color:#cccccc transparent;scrollbar-width:.75rem}.text pre::-webkit-scrollbar{margin-top:-.75rem;height:.75rem}.text pre::-webkit-scrollbar-track{background:0 0}.text pre::-webkit-scrollbar-thumb{height:.1rem;border-radius:.2rem;background:#ccc}.text hr{border:0;height:.2rem;background:#42536d;margin-top:1.3rem}.text .admonition{position:relative}.text .admonition>*{padding-left:2rem}.text .admonition>:first-child::before{display:block;text-align:left;position:absolute;top:0;left:0;width:.75rem;font-size:1rem;line-height:1.5rem;height:1.5rem}.text .admonition--tip>:first-child::before{content:"☛";color:#fefefe;font-size:1.5rem;line-height:1.5rem;height:1.5rem}.text .admonition--warning>:first-child::before{content:"⚠️";color:#fefefe}.text .admonition--info>:first-child::before{content:"ⓘ";color:#42536d;font-weight:700}@media print{.text h1{margin-left:auto;margin-right:auto;margin-top:9rem;width:80%;font-variant:small-caps;text-align:center}.text--simple h1{margin-top:0}.text .meta{page-break-after:always;text-align:center;font-size:1.2rem;margin-top:1.5rem}.text .meta a{text-decoration:none}.text .meta time{display:none}.text .body p:first-of-type{margin-top:0}.text pre{padding:0;font-size:inherit;line-height:1.5rem;overflow:hidden;white-space:pre-wrap;word-break:break-all}}.text .podcasts{margin-top:1.5rem;text-align:center}.text a.podcast{display:block;height:3rem}.text a.podcast img{width:50%;max-width:200px}@media screen and (min-width:768px){.text .podcasts{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));grid-gap:1.5rem}.text a.podcast img{width:100%}}.text .tombstone{opacity:0}.cmp-revoke-consent{bottom:0!important;left:0!important;position:relative!important;padding:0!important}.call-to-action{padding-top:12px}.call-to-action a{font-size:14px;font-weight:600;padding:12px 19px;height:20px;line-height:1rem;background:#00bda5;border-radius:100px;border-bottom:none;border-top:none}.call-to-action a:hover{background:#fff;border-bottom:none;color:#00bda5}header{background-color:#00162b}.page-header a{display:block;text-decoration:none;height:2.8rem;line-height:2.8rem;border-top:.2rem solid transparent;border-bottom:.2rem solid transparent;color:#fff;border-bottom:0 solid #00162b}.page-header a,.page-header a span{transition:color .233s ease-in-out,border-bottom .233s,margin-bottom .233s}.page-header a:hover{color:#00bda5;border-bottom-color:#00bda5;border-bottom:.2rem solid #00bda5}.page-header a:hover span{color:#00bda5}.page-header a:visited{color:#fff}.page-header a img{height:1rem}.page-header a{display:block;border-bottom-width:.2rem;font-weight:400;font-size:.8rem}.page-header .logo{z-index:6;font-size:1.2rem;font-weight:700;font-variant:small-caps}.page-header .logo a{margin-top:.4rem;text-decoration:none;display:block;border:none}.page-header .logo a:visited{border:none}#show-mobile-menu{display:none}.mobile-toggle{display:none}@media screen and (max-width:999px){header.page{box-shadow:0 0 3px rgba(168,168,168,.5)}.logo a{position:absolute}.page-header{justify-content:space-between;z-index:1}.page-header a{border-bottom-width:0}.hamburger-bar{height:.2rem;background:#fff;margin-top:.2rem;display:block}#show-mobile-menu+.mobile-toggle+.mobile-menu nav{background:#00162b}#show-mobile-menu+.mobile-toggle .hamburger-bar{transform:translateY(0)rotate(0);opacity:1;transition:transform .233s ease-in-out,opacity .233s ease-in-out}#show-mobile-menu:checked+.mobile-toggle{position:fixed;right:1.5rem}#show-mobile-menu:checked+.mobile-toggle .hamburger-bar:nth-of-type(1){transform:translateY(.4rem)rotate(315deg)}#show-mobile-menu:checked+.mobile-toggle .hamburger-bar:nth-of-type(2){opacity:0}#show-mobile-menu:checked+.mobile-toggle .hamburger-bar:nth-of-type(3){transform:translateY(-.4rem)rotate(405deg)}.mobile-toggle{cursor:pointer;display:block;width:1.2rem;height:1rem;z-index:5;margin-top:.75rem}.mobile-toggle label,.mobile-toggle .hamburger-bar{cursor:pointer}.mobile-menu{overflow:hidden;position:fixed;top:0;left:0;right:0;bottom:100vh;opacity:0;background:rgba(0,0,0,.5);transition:opacity .233s ease-in-out,border-bottom-color .233s ease-in-out}#show-mobile-menu:checked+.mobile-toggle+.mobile-menu{opacity:1;bottom:0}.hide-mobile-menu{display:block;position:absolute;top:0;left:0;right:0;bottom:0;z-index:2}.mobile-menu nav{box-sizing:border-box;max-height:100%;position:absolute;top:0;left:0;right:0;z-index:3;font-size:1rem;line-height:3rem;padding:3rem 1.5rem 1.5rem;display:flex;flex-direction:column}.mobile-menu nav header{display:flex;flex-direction:row;font-size:inherit;line-height:inherit}.mobile-menu nav header h1{margin-top:0;font-size:1.2rem;line-height:1.5rem;flex:1;font-variant:small-caps}.mobile-menu nav header .hide-mobile-menu-aria{display:block;z-index:10;height:1.5rem;width:1.5rem}.mobile-menu nav ul{overflow-y:scroll;flex:1;scrollbar-width:none;-ms-overflow-style:none}.mobile-menu nav ul::-webkit-scrollbar{width:0;background:0 0}.mobile-menu nav a{font-weight:700;font-size:1rem}.mobile-menu nav a:hover{border-bottom:0;margin-bottom:0}}@media screen and (min-width:1000px){.page-header .mobile-toggle{display:none}.page-header .mobile-menu{flex:1}.page-header nav{flex:1}.page-header nav header{display:none}.page-header ul{list-style-type:none}.page-header nav ul{display:flex;align-items:end;justify-content:flex-end;flex-direction:row}.page-header nav li{padding-right:1.5rem}.page-header nav li.active a{border-bottom-width:3px;border-bottom-color:#42536d}}@media screen{.page-header{position:relative;max-width:1200px;margin-left:auto;margin-right:auto;padding-left:1.5rem;padding-right:1.5rem;height:3.2rem;display:flex;flex-direction:row}}@media print{header.page{display:none}}@media screen and (max-width:999px) and (prefers-reduced-motion:reduce){.mobile-menu{transition:none}#show-mobile-menu+.mobile-toggle .hamburger-bar{transition:none}}@media screen and (max-width:999px) and (prefers-reduced-transparency:reduce){.mobile-menu{background:gray}}.page-header nav li{position:relative}.page-header nav li:hover ul.submenu__list{display:flex;z-index:999}.page-header nav ul.submenu__list{display:none;flex-direction:column;background:#00162b;position:absolute;left:0;border-top:1px solid #aab7cf}.page-header nav ul.submenu__list li{padding:0 20px}.page-header nav ul.submenu__list li a{white-space:nowrap}@media(max-width:768px){.page-header nav ul.submenu__list{display:flex;position:static}.page-header nav ul.submenu__list li a{font-weight:400}}html,body{font-family:poppins,Helvetica,Arial,Lucida,sans-serif;scroll-behavior:smooth;text-rendering:optimizeSpeed;-webkit-font-smoothing:antialiased;line-height:1.5rem;font-feature-settings:"liga" 1;font-weight:400;font-size:18px}@media(min-width:900px){html,body{font-size:20px}}@media(min-width:1100px){html,body{font-size:22px}}@media(min-width:1800px){html,body{font-size:24px}}@media print{html,body{font-size:18px}}.body .meta{padding-bottom:1rem}@media screen and (min-width:760px){.body{padding:2rem}.body .body{padding:1rem 4rem}}h1,h2,h3,h4{font-weight:400}p:empty{display:none}.branded h2{color:#697793}.branded .view-all{color:#00bda5;text-decoration-color:#00bda5}.view-all{font-size:.75rem;font-weight:400}hr{border:0;height:2px;background-color:#fe7f2d;margin-top:1.5rem;margin-bottom:1.5rem}.text{position:relative}.text h1,.text h2,.text h3,.text h4,.text h5,.text h6{font-family:poppins,Helvetica,Arial,Lucida,sans-serif;font-weight:400;page-break-after:avoid}.text h1 a,.text h1 a:visited,.text h2 a,.text h2 a:visited,.text h3 a,.text h3 a:visited,.text h4 a,.text h4 a:visited,.text h5 a,.text h5 a:visited,.text h6 a,.text h6 a:visited{color:#333;text-decoration:none}.text p,.text ul,.text ol,.text figure,.text dl,.text hr{margin-top:.75rem;font-size:.75rem;line-height:1.5rem}.text a{color:#00bda5;text-decoration-color:#00bda5}.text q{font-style:italic}.text ul ul{margin-top:0}.text p>code,.text ul>code,.text ol>code,.text dt>code,.text dd>code,.text li>code{color:#42536d}.text audio{display:block;width:100%;height:1.5rem;outline:none}.text audio span{line-height:1.5rem}.text dl{overflow:auto;position:relative}.text dt{font-weight:700}.text dd{padding-left:2rem}.text dd+dt{margin-top:1.5rem}.text ul{list-style-type:disc;padding-left:1.5rem}.text ol{list-style-type:decimal;padding-left:1.5rem}.text p{overflow-wrap:break-word;word-wrap:break-word;-webkit-hyphens:auto;-moz-hyphens:auto;-ms-hyphens:auto;hyphens:auto}.text h1{font-size:2rem;font-weight:600;line-height:2rem;margin-top:1.5rem;margin-bottom:1rem}@media screen and (min-width:760px){.text h1{font-size:2rem;line-height:2.5rem;margin-top:1.5rem}}@media screen and (min-width:900px){.text h1{font-size:2rem;line-height:2.5rem;margin-top:3rem}}.text h2{font-size:1.5rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem}.text h3{font-size:1.25rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem}.text h4{font-size:1rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem;font-size:1.1rem}.text h5{font-size:.8rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem}.text h6{font-size:.6rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem}.text strong{font-weight:700}.text em{font-style:italic}.text .meta{color:#8897b3;font-weight:600;font-variant:small-caps}.text .meta .byline{display:none}.text .meta .line{display:inline-block}.text .meta .calendar{display:none}.text .meta a{color:#8897b3;text-decoration-color:#8897b3}.text .meta a:hover{color:#42536d;text-decoration-color:#42536d}.text code{font-family:lucida console,Monaco,monospace;speak:literal-punctuation}.text abbr,.text acronym{speak:spell-out}.text del{text-decoration:line-through}.text ins{text-decoration:none;font-style:italic}.text figure{position:relative;text-align:center}.text figure img{background:#fff;border-radius:.2rem;max-width:100%}.text figure table{min-width:75%;border-radius:.2rem;margin-left:auto;margin-right:auto;border:#42536d;border-collapse:separate;border-spacing:0;background:#fff;margin-bottom:-.1em}.text figure table th,.text figure table td{padding-left:.75rem;padding-right:.75rem;line-height:1.3rem;border-left:.1rem solid #42536d;border-top:.1rem solid #42536d}.text figure table thead{background-color:#fff}.text figure table tr td:last-child,.text figure table tr th:last-child{border-right:.1rem solid #42536d}.text figure table tbody:last-child tr:last-child td{border-bottom:.1rem solid #42536d}.text figure table thead:first-child tr:first-child th:first-child,.text figure table thead:first-child tr:first-child td:first-child{border-top-left-radius:.2rem}.text figure table thead:first-child tr:first-child,.text figure table thead:first-child tr:first-child th:last-child,.text figure table thead:first-child tr:first-child td:last-child{border-top-right-radius:.2rem}.text figure table tbody:last-child tr:last-child,.text figure table tbody:last-child tr:last-child td:first-child{border-bottom-left-radius:.2rem}.text figure table tbody:last-child tr:last-child,.text figure table tbody:last-child tr:last-child td:last-child{border-bottom-right-radius:.2rem}.text figure ul{text-align:left}.text figure ul.tree{padding-top:1.5em;padding-bottom:1.5em;border-radius:.2rem;background:#fff}.text figure ul.tree li{list-style-type:none}.text figure ul.tree .tree__item--folder::before{content:"📁";margin-right:.2em}.text figure ul.tree .tree__item--file::before{content:"📝";margin-right:.2em}.text figure figcaption{font-style:italic}.text pre{margin-top:1.5rem;font-size:inherit;line-height:1.5rem;padding:1.5rem 1.5rem .75rem;white-space:pre;overflow-x:scroll;overflow-y:hidden;scrollbar-color:#cccccc transparent;scrollbar-width:.75rem}.text pre::-webkit-scrollbar{margin-top:-.75rem;height:.75rem}.text pre::-webkit-scrollbar-track{background:0 0}.text pre::-webkit-scrollbar-thumb{height:.1rem;border-radius:.2rem;background:#ccc}.text hr{border:0;height:.2rem;background:#42536d;margin-top:1.3rem}.text .admonition{position:relative}.text .admonition>*{padding-left:2rem}.text .admonition>:first-child::before{display:block;text-align:left;position:absolute;top:0;left:0;width:.75rem;font-size:1rem;line-height:1.5rem;height:1.5rem}.text .admonition--tip>:first-child::before{content:"☛";color:#fefefe;font-size:1.5rem;line-height:1.5rem;height:1.5rem}.text .admonition--warning>:first-child::before{content:"⚠️";color:#fefefe}.text .admonition--info>:first-child::before{content:"ⓘ";color:#42536d;font-weight:700}@media print{.text h1{margin-left:auto;margin-right:auto;margin-top:9rem;width:80%;font-variant:small-caps;text-align:center}.text--simple h1{margin-top:0}.text .meta{page-break-after:always;text-align:center;font-size:1.2rem;margin-top:1.5rem}.text .meta a{text-decoration:none}.text .meta time{display:none}.text .body p:first-of-type{margin-top:0}.text pre{padding:0;font-size:inherit;line-height:1.5rem;overflow:hidden;white-space:pre-wrap;word-break:break-all}}.text .podcasts{margin-top:1.5rem;text-align:center}.text a.podcast{display:block;height:3rem}.text a.podcast img{width:50%;max-width:200px}@media screen and (min-width:768px){.text .podcasts{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));grid-gap:1.5rem}.text a.podcast img{width:100%}}.text .tombstone{opacity:0}html,body{min-height:100vh}body{text-align:center}@media screen{body{color:#333;background-color:#fefefe}}@media print{body{color:#000;background:#fff}}@media screen{body{display:flex;flex-direction:column}main.page{width:100%;flex:1}}header.page,main.page,footer.page{text-align:left}.page-main,.contentblock{max-width:1200px;padding-left:1.5rem;padding-right:1.5rem;margin-left:auto;margin-right:auto}@media print{.page-main,.contentblock{padding:0}}@page{size:A4;padding:0;margin:3rem}.highlight{color:#42536d}.nobr{white-space:nowrap}.aria-only{display:none}@media aural{.aria-only{display:block}}.cmp-revoke-consent{bottom:0!important;left:0!important;position:relative!important;padding:0!important}.call-to-action{padding-top:12px}.call-to-action a{font-size:14px;font-weight:600;padding:12px 19px;height:20px;line-height:1rem;background:#00bda5;border-radius:100px;border-bottom:none;border-top:none}.call-to-action a:hover{background:#fff;border-bottom:none;color:#00bda5}footer.page{margin-top:1.5rem}footer.page h2{font-size:1rem}.footer{margin-top:1rem;margin-bottom:1rem}@media not print{footer.page{margin-top:1.5rem/2;padding-top:1.5rem/2;padding-bottom:1.5rem/2}.page-footer{max-width:1200px;padding-left:1.5rem;padding-right:1.5rem;margin-left:auto;margin-right:auto;font-size:12px;line-height:1.5rem}}@media not print{.page-footer ul{margin-bottom:1.5rem}.page-footer nav ul{display:flex;flex-direction:row;align-items:center;justify-content:center;flex-wrap:wrap;margin-bottom:0;height:1.5rem;line-height:.5rem}.page-footer nav ul a{color:#fff;text-decoration:none;height:1.3rem;line-height:1.3rem;text-align:center;display:block;padding-left:.75rem;padding-right:.75rem}.page-footer nav ul a:visited{color:#00bda5}.page-footer nav ul a:hover{color:#fe7f2d;border-bottom:0}}@media print{footer.page nav{display:none}footer.page aside{border-top:.2rem solid #333;margin-top:.65rem;padding-top:.65rem}}footer.page{border-top:2px solid #aab7cf;margin-top:-2px}footer.page aside{text-align:center;font-size:.6rem;line-height:1.5rem;color:#aab7cf}@media screen{footer.page{background-color:#00162b}}@media screen and (max-width:570px){footer.page aside{margin-top:10%}}@media screen and (max-width:370px){footer.page aside{margin-top:20%}}.youtubeList__container{display:flex;flex-direction:row;justify-content:flex-start;margin-bottom:1.5rem}.youtubeList__container .youtubeList__img{margin-right:1rem}.grid{display:grid;gap:1.5rem 1.5rem;font-size:.9rem;margin-bottom:1.5rem;margin-top:1.5rem}.grid--2{grid-template-columns:1fr 1fr}.grid--3{grid-template-columns:1fr 1fr 1fr}.grid--4{grid-template-columns:1fr 1fr 1fr 1fr}.grid img{margin:auto;max-width:100%;display:block}.grid h2{font-size:1rem;line-height:1.25rem;margin-bottom:.75rem}.grid p{font-size:.75rem;line-height:1.5rem;font-weight:400;margin-bottom:.75rem}.grid ul{margin-left:1rem}.grid ul li{list-style-type:disc}.contentblock.branded{padding-top:1rem}.grid-3-6 .grid--2{grid-template-columns:3fr 6fr}.grid-6-3 .grid--2{grid-template-columns:6fr 3fr}.branded .grid{gap:1.5rem 0}@media screen and (min-width:760px){.branded .grid--2 .grid__item{border-right:1px solid #e8ecf3}.branded .grid--2 .grid__item:nth-child(2n){border:none}}@media screen and (min-width:760px){.branded .grid--3 .grid__item{border-right:1px solid #e8ecf3}.branded .grid--3 .grid__item:nth-child(3n){border:none}}@media screen and (min-width:760px){.branded .grid--4 .grid__item{border-right:1px solid #e8ecf3}.branded .grid--4 .grid__item:nth-child(4n){border:none}}@media(max-width:768px){.grid__item{margin-bottom:1rem}.grid--2{display:block}}@media(max-width:1200px){.grid--3{display:block}}@media(max-width:1200px){.grid--4{display:block}}.grid-links{display:grid;gap:1.5rem 0;font-size:.75rem;line-height:1.2rem;margin-bottom:1.5rem;margin-top:1.5rem}.grid-links--2{grid-template-columns:1fr 1fr}.grid-links--3{grid-template-columns:1fr 1fr 1fr}.grid-links--4{grid-template-columns:1fr 1fr 1fr 1fr}.grid-links img{max-width:100%}.grid-links h2{font-size:1.2rem;margin-bottom:.75rem}.grid-links p{margin-bottom:.75rem}.grid-links ul{margin-left:1rem}.grid-links ul li{list-style-type:disc}.grid-links .grid__item{padding:1rem}@media screen and (min-width:760px){.grid-links--4 .grid__item{border-right:1px solid #e8ecf3}.grid-links--4 .grid__item:nth-child(4n){border:none}}@media(max-width:768px){.grid-links--2{display:block}}@media(max-width:1000px){.grid-links--3{display:block}}@media(max-width:1000px){.grid-links--4{display:block}}.text .post h3{font-size:16px;font-weight:600;line-height:1.5em;margin:0}.post--preview{display:block;padding:1rem}@media screen and (max-width:760px){.post--preview{padding:1rem 0}}.post--preview img{margin-bottom:.375rem}.post--preview h3{font-size:16px;font-weight:600;line-height:1.5em}.post--preview :last-child{margin-bottom:0}.post--preview .post__content{margin-top:1rem}.post--preview .post__content p{color:#42536d;font-size:14px;line-height:1.5em;font-weight:400}.post--preview .post__content .bottom{display:flex;justify-content:space-between;align-items:center}.post--preview .post__content .bottom p{margin-bottom:0;padding:0;font-size:12px;font-weight:400;color:#8897b3}.post--preview .post__content .bottom .post-type{color:#00bda5;font-weight:600}.post--preview:hover h3{color:#00bda5}a.post--preview,a.post--preview *{text-decoration:none;color:#333}a.post--preview .readmore,a.post--preview * .readmore{color:#00bda5;font-weight:700}.recommendations{margin-top:2rem}.text .grid h2{font-size:1rem;line-height:1.25rem;margin-bottom:.75rem;margin-top:0;font-weight:700}.text .post__content p{font-size:.75rem;line-height:1rem;font-weight:400}.text .post__content .readmore{font-weight:700}.comments{padding-top:2em;font-family:poppins,Helvetica,Arial,Lucida,sans-serif}.comments h2{color:#697793;padding-bottom:1em}.comments .comment{padding:2em;background:#f5f5f5;border-radius:3%;margin-bottom:2em}.comments .info{margin-bottom:2em}.comments .info a{font-size:1.2em}.comments .info span{float:right;color:#9c98a8;font-style:italic}.blog__featured .grid{gap:1.5rem 1rem}.blog__featured .grid__item{position:relative;border-radius:.2rem;background-color:#fff;padding-bottom:35px}.blog__featured img{display:block;border-radius:.2rem .2rem 0 0;margin-bottom:0}.blog__featured a.post--preview{border-radius:.2rem .2rem 0 0}.blog__featured .post--preview{padding:0}.blog__featured .post__text{padding:1rem}.blog__featured .post__content{margin-top:0}.blog__featured .post__content p{font-weight:400;font-size:16px;line-height:150%;letter-spacing:.01em;color:#00162b}.blog__featured h3{font-weight:600;font-size:21px;line-height:150%;letter-spacing:.01em;color:#00162b;padding-bottom:12px}.blog__featured .bottom{position:absolute;bottom:20px;display:flex;justify-content:space-between;align-items:center;width:calc(100% - 48px);left:24px}.blog__featured .bottom p{color:#8897b3;padding:0;font-size:12px;font-weight:400;line-height:150%;letter-spacing:.01em}.featured__wrapper{margin-top:2.5rem}.featured__wrapper .featured__left,.featured__wrapper .featured__right{background-color:#fff;padding:20px;border-radius:4px}.featured__wrapper .title-wrap{font-size:14px;font-weight:600;color:#697793;padding:0;border-bottom:2px solid #e8ecf3;padding-bottom:10px;margin-bottom:20px;letter-spacing:.02em;display:block}@media(max-width:768px){.featured__wrapper .featured__left{margin-bottom:1rem}}.featured__one{position:relative;padding-bottom:35px}.featured__one .post--preview{display:block;padding:0}.featured__one img{width:100%;margin-bottom:20px;border-radius:4px;overflow:hidden}.featured__one .post--preview h3{font-size:21px;font-weight:600;line-height:1.4;transition:all .3s ease-in-out}.featured__one .post__content{height:calc(100% - 320px);display:flex;flex-direction:column;justify-content:space-between}.featured__one .post__content .bottom{bottom:20px;margin-top:20px;display:flex;justify-content:space-between;align-items:center;width:calc(100% - 48px)}.featured-grid-list-item:hover .featured-grid-list-inner .context h2{color:#00bda5!important}.featured__list .featured-grid-list-item{border-bottom:1px solid #e8ecf3;padding-bottom:15px;margin-bottom:15px}.featured__list .featured-grid-list-item:last-child{border-bottom:none;padding-bottom:0;margin-bottom:0}.featured-grid-list-inner{display:grid;gap:0 0;grid-template-columns:3fr 6fr}.featured-grid-list-inner .thumbnail{height:130px;border-radius:4px;overflow:hidden}.featured-grid-list-inner .thumbnail a{width:100%;display:block;height:100%}.featured-grid-list-inner .thumbnail img{object-fit:cover;width:100%;height:100%}.featured-grid-list-inner .context{display:flex;flex-direction:column;justify-content:space-between;padding:5px 20px}.featured-grid-list-inner .context a{text-decoration:none;color:#333}.featured-grid-list-inner .context h2{font-size:18px;font-weight:600;line-height:1.4;transition:all .3s ease-in-out}.featured-grid-list-inner .bottom{display:flex;justify-content:space-between;align-items:center;width:100%}.featured-grid-list-inner .bottom p{margin-bottom:0;padding:0;font-size:12px;font-weight:400;color:#8897b3}.youtube__block iframe{width:715px;height:400px}@media(max-width:768px){.youtube__block iframe{width:320px;height:180px}}.branded .grid__item{position:relative}.branded .bottom{position:absolute;bottom:0;width:calc(100% - 48px)}.banner .banner__content{max-width:1200px;padding:1.5rem;margin-left:auto;margin-right:auto}.banner .banner__grid{display:grid;gap:1.5rem 1.5rem;grid-template-columns:9fr 3fr;margin-top:1.5rem;margin-bottom:1.5rem}@media screen and (max-width:1000px){.banner .banner__grid{display:block}}.banner .banner__text{padding:1.5rem}.banner .banner__text h1{font-size:2rem;line-height:2rem}.banner .banner__text p{font-size:1rem;margin-top:1.5rem}.banner .banner__text p:first-child{margin-top:0}.banner .banner__text.opaque{background:rgba(0,0,0,.95)}.banner .banner__text small{font-size:.8rem}.banner .banner__icon{align-self:center;margin:auto}@media screen and (max-width:1000px){.banner .banner__icon{display:none}}.banner .banner__icon img{height:240px}.img_banner img{display:block}.block__content{max-width:1200px;padding-left:1.5rem;padding-right:1.5rem;margin-left:auto;margin-right:auto;padding-top:2rem;padding-bottom:1.5rem}@media print{.block__content{padding:0}}.block__content h2{margin-bottom:1rem}.block__content p{font-size:.75rem}.databases{color:#fff}.databases a{color:#00bda5;text-decoration-color:#00bda5}.databases .grid__item{background-color:#00162b;background-size:cover;background-position:50%;background-repeat:no-repeat;border:0 solid #333;border-radius:0;overflow:hidden;border-left-width:2px;border-left-color:#f7d592}.databases .database__grid{display:grid;gap:1.5rem 1.5rem;grid-template-columns:3fr 6fr;margin-top:1.5rem;margin-bottom:1.5rem}.databases .database__image{align-self:center;margin:auto;padding-left:1rem}.databases img{max-width:100%;display:block}.databases a.database__preview,.databases a.database__preview *{text-decoration:none}.databases .database__content{padding-right:1rem}.databases .database__content h4{font-weight:600}.databases .database__content p{margin-top:.5rem;color:#fff}.databases a.database__preview:hover p{color:#fe7f2d}.databases .post-type{margin-top:0;display:block;float:right}.databases .post-type small{color:#00bda5}.projects .post--preview{text-align:center}.projects .post--preview img{display:block;margin-bottom:1rem;margin-left:auto;margin-right:auto}table{border:1px solid #ccc;border-collapse:collapse;margin-top:2rem;padding:0;width:100%;table-layout:fixed}table caption{font-size:1.5em;margin:.5em 0 .75em}table tr{background-color:#f8f8f8;border:1px solid #ddd;padding:.35em}table th,table td{font-size:.75rem;padding:.625em;text-align:left}table th{letter-spacing:.1em;text-transform:uppercase}@media screen and (max-width:600px){table{border:0}table caption{font-size:1.3em}table thead{border:none;clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}table tr{border-bottom:3px solid #ddd;display:block;margin-bottom:.625em}table td{border-bottom:1px solid #ddd;display:block;font-size:1em;text-align:left}table td::before{content:attr(data-label);float:left;font-weight:700;text-transform:uppercase}table td:last-child{border-bottom:0}}.hero .contentblock{padding-top:2rem;padding-bottom:2rem}.hero-text{font-family:poppins,Helvetica,Arial,Lucida,sans-serif;text-align:center;padding:0 5%}.hero-text h1{font-size:3.2rem;line-height:1em;font-weight:400}.hero-text p{font-size:1rem;margin-top:1.5rem}.hero-text p:first-child{margin-top:0}.hero-text small{font-size:.8rem}.hero-text.opaque{background:rgba(0,0,0,.95);color:#fff}@media screen and (max-width:760px){.hero-text{text-align:left}.hero-text h1{font-size:2.5rem;line-height:1em}}.homepage-hero{position:relative;font-family:poppins,Helvetica,Arial,Lucida,sans-serif;color:#fff;margin-bottom:2rem}.homepage-hero .homepage-hero-icon{position:absolute;bottom:-3rem;right:-3rem}.homepage-hero .homepage-hero-icon img{height:320px;opacity:.4}@media screen and (max-width:900px){.homepage-hero .homepage-hero-icon img{height:200px}}@media screen and (max-width:760px){.homepage-hero .homepage-hero-icon{display:none}}.homepage-hero a{color:#e67117;text-decoration-color:#e67117}.homepage-hero h1{font-size:87px;line-height:1em;font-weight:400}.homepage-hero p{width:60%;font-size:1rem;margin-top:1.5rem}.homepage-hero p:first-child{margin-top:0}.homepage-hero small{font-size:.8rem}.homepage-hero.opaque{background:rgba(0,0,0,.95);color:#fff}@media screen and (max-width:760px){.homepage-hero p{width:100%}.homepage-hero h1{font-size:2.5rem;line-height:1em}}@media screen and (max-width:960px){.homepage-hero h1{font-size:2.5rem;line-height:1em}}.paginator{margin-top:1.5rem;margin-bottom:1rem;text-align:center}.paginator a{display:inline-block;text-decoration:none;border-radius:3px;color:#333;border:1px solid #333;transition:.2s background-color ease-in-out,.2s color ease-in-out,.2s border-color ease-in-out;height:1.5rem;width:1.5rem;line-height:1.5rem;font-size:1rem;margin-left:.2rem;margin-right:.2rem}.paginator a:hover,.paginator a.active{background:#42536d;color:#fefefe;border:1px solid #42536d}@media screen and (min-width:768px){.paginator a{height:1.5rem;width:1.5rem;line-height:1.5rem;font-size:1rem}}@media screen and (min-width:900px){.paginator a{height:3rem;width:3rem;line-height:3rem;font-size:1.2rem}}html,body{font-family:poppins,Helvetica,Arial,Lucida,sans-serif;scroll-behavior:smooth;text-rendering:optimizeSpeed;-webkit-font-smoothing:antialiased;line-height:1.5rem;font-feature-settings:"liga" 1;font-weight:400;font-size:18px}@media(min-width:900px){html,body{font-size:20px}}@media(min-width:1100px){html,body{font-size:22px}}@media(min-width:1800px){html,body{font-size:24px}}@media print{html,body{font-size:18px}}.body .meta{padding-bottom:1rem}@media screen and (min-width:760px){.body{padding:2rem}.body .body{padding:1rem 4rem}}h1,h2,h3,h4{font-weight:400}p:empty{display:none}.branded h2{color:#697793}.branded .view-all{color:#00bda5;text-decoration-color:#00bda5}.view-all{font-size:.75rem;font-weight:400}hr{border:0;height:2px;background-color:#fe7f2d;margin-top:1.5rem;margin-bottom:1.5rem}.text{position:relative}.text h1,.text h2,.text h3,.text h4,.text h5,.text h6{font-family:poppins,Helvetica,Arial,Lucida,sans-serif;font-weight:400;page-break-after:avoid}.text h1 a,.text h1 a:visited,.text h2 a,.text h2 a:visited,.text h3 a,.text h3 a:visited,.text h4 a,.text h4 a:visited,.text h5 a,.text h5 a:visited,.text h6 a,.text h6 a:visited{color:#333;text-decoration:none}.text p,.text ul,.text ol,.text figure,.text dl,.text hr{margin-top:.75rem;font-size:.75rem;line-height:1.5rem}.text a{color:#00bda5;text-decoration-color:#00bda5}.text q{font-style:italic}.text ul ul{margin-top:0}.text p>code,.text ul>code,.text ol>code,.text dt>code,.text dd>code,.text li>code{color:#42536d}.text audio{display:block;width:100%;height:1.5rem;outline:none}.text audio span{line-height:1.5rem}.text dl{overflow:auto;position:relative}.text dt{font-weight:700}.text dd{padding-left:2rem}.text dd+dt{margin-top:1.5rem}.text ul{list-style-type:disc;padding-left:1.5rem}.text ol{list-style-type:decimal;padding-left:1.5rem}.text p{overflow-wrap:break-word;word-wrap:break-word;-webkit-hyphens:auto;-moz-hyphens:auto;-ms-hyphens:auto;hyphens:auto}.text h1{font-size:2rem;font-weight:600;line-height:2rem;margin-top:1.5rem;margin-bottom:1rem}@media screen and (min-width:760px){.text h1{font-size:2rem;line-height:2.5rem;margin-top:1.5rem}}@media screen and (min-width:900px){.text h1{font-size:2rem;line-height:2.5rem;margin-top:3rem}}.text h2{font-size:1.5rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem}.text h3{font-size:1.25rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem}.text h4{font-size:1rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem;font-size:1.1rem}.text h5{font-size:.8rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem}.text h6{font-size:.6rem;line-height:2rem;margin-top:2rem;margin-bottom:1.5rem}.text strong{font-weight:700}.text em{font-style:italic}.text .meta{color:#8897b3;font-weight:600;font-variant:small-caps}.text .meta .byline{display:none}.text .meta .line{display:inline-block}.text .meta .calendar{display:none}.text .meta a{color:#8897b3;text-decoration-color:#8897b3}.text .meta a:hover{color:#42536d;text-decoration-color:#42536d}.text code{font-family:lucida console,Monaco,monospace;speak:literal-punctuation}.text abbr,.text acronym{speak:spell-out}.text del{text-decoration:line-through}.text ins{text-decoration:none;font-style:italic}.text figure{position:relative;text-align:center}.text figure img{background:#fff;border-radius:.2rem;max-width:100%}.text figure table{min-width:75%;border-radius:.2rem;margin-left:auto;margin-right:auto;border:#42536d;border-collapse:separate;border-spacing:0;background:#fff;margin-bottom:-.1em}.text figure table th,.text figure table td{padding-left:.75rem;padding-right:.75rem;line-height:1.3rem;border-left:.1rem solid #42536d;border-top:.1rem solid #42536d}.text figure table thead{background-color:#fff}.text figure table tr td:last-child,.text figure table tr th:last-child{border-right:.1rem solid #42536d}.text figure table tbody:last-child tr:last-child td{border-bottom:.1rem solid #42536d}.text figure table thead:first-child tr:first-child th:first-child,.text figure table thead:first-child tr:first-child td:first-child{border-top-left-radius:.2rem}.text figure table thead:first-child tr:first-child,.text figure table thead:first-child tr:first-child th:last-child,.text figure table thead:first-child tr:first-child td:last-child{border-top-right-radius:.2rem}.text figure table tbody:last-child tr:last-child,.text figure table tbody:last-child tr:last-child td:first-child{border-bottom-left-radius:.2rem}.text figure table tbody:last-child tr:last-child,.text figure table tbody:last-child tr:last-child td:last-child{border-bottom-right-radius:.2rem}.text figure ul{text-align:left}.text figure ul.tree{padding-top:1.5em;padding-bottom:1.5em;border-radius:.2rem;background:#fff}.text figure ul.tree li{list-style-type:none}.text figure ul.tree .tree__item--folder::before{content:"📁";margin-right:.2em}.text figure ul.tree .tree__item--file::before{content:"📝";margin-right:.2em}.text figure figcaption{font-style:italic}.text pre{margin-top:1.5rem;font-size:inherit;line-height:1.5rem;padding:1.5rem 1.5rem .75rem;white-space:pre;overflow-x:scroll;overflow-y:hidden;scrollbar-color:#cccccc transparent;scrollbar-width:.75rem}.text pre::-webkit-scrollbar{margin-top:-.75rem;height:.75rem}.text pre::-webkit-scrollbar-track{background:0 0}.text pre::-webkit-scrollbar-thumb{height:.1rem;border-radius:.2rem;background:#ccc}.text hr{border:0;height:.2rem;background:#42536d;margin-top:1.3rem}.text .admonition{position:relative}.text .admonition>*{padding-left:2rem}.text .admonition>:first-child::before{display:block;text-align:left;position:absolute;top:0;left:0;width:.75rem;font-size:1rem;line-height:1.5rem;height:1.5rem}.text .admonition--tip>:first-child::before{content:"☛";color:#fefefe;font-size:1.5rem;line-height:1.5rem;height:1.5rem}.text .admonition--warning>:first-child::before{content:"⚠️";color:#fefefe}.text .admonition--info>:first-child::before{content:"ⓘ";color:#42536d;font-weight:700}@media print{.text h1{margin-left:auto;margin-right:auto;margin-top:9rem;width:80%;font-variant:small-caps;text-align:center}.text--simple h1{margin-top:0}.text .meta{page-break-after:always;text-align:center;font-size:1.2rem;margin-top:1.5rem}.text .meta a{text-decoration:none}.text .meta time{display:none}.text .body p:first-of-type{margin-top:0}.text pre{padding:0;font-size:inherit;line-height:1.5rem;overflow:hidden;white-space:pre-wrap;word-break:break-all}}.text .podcasts{margin-top:1.5rem;text-align:center}.text a.podcast{display:block;height:3rem}.text a.podcast img{width:50%;max-width:200px}@media screen and (min-width:768px){.text .podcasts{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));grid-gap:1.5rem}.text a.podcast img{width:100%}}.text .tombstone{opacity:0}html,body{min-height:100vh}body{text-align:center}@media screen{body{color:#333;background-color:#fefefe}}@media print{body{color:#000;background:#fff}}@media screen{body{display:flex;flex-direction:column}main.page{width:100%;flex:1}}header.page,main.page,footer.page{text-align:left}.page-main,.contentblock{max-width:1200px;padding-left:1.5rem;padding-right:1.5rem;margin-left:auto;margin-right:auto}@media print{.page-main,.contentblock{padding:0}}@page{size:A4;padding:0;margin:3rem}.highlight{color:#42536d}.nobr{white-space:nowrap}.aria-only{display:none}@media aural{.aria-only{display:block}}.edit-on-github{font-size:.8rem;text-align:right;padding-top:1.5rem}.edit-on-github .container{max-width:1200px;padding-left:1.5rem;padding-right:1.5rem;margin-left:auto;margin-right:auto}@media print{.edit-on-github .container{padding:0}}.edit-on-github a{background-color:#fe7f2d;color:#fefefe;text-decoration:none;display:inline-block;border-top-left-radius:.5rem;border-top-right-radius:.5rem;padding-left:.5rem;padding-right:.5rem;transition:.2s background-color ease-in-out}.edit-on-github a:hover{color:#fefefe;background-color:#42536d}.grid--2 .social{grid-template-columns:1fr 1fr}@media(max-width:768px){.grid--2 .social{display:grid}}a.socialblock{display:block;border:0;line-height:1.5rem;position:relative;text-align:center}a.socialblock img{float:none;display:block;margin-left:auto;margin-right:auto;height:3rem;width:3rem}.sharing{margin-top:1em}.sharing .resp-sharing-button__link,.sharing .resp-sharing-button__icon{display:inline-block}.sharing .resp-sharing-button__link{text-decoration:none;color:#fff;margin:.5em}.sharing .resp-sharing-button{border-radius:5px;transition:25ms ease-out;padding-right:.75em;padding-top:.1em}.sharing .resp-sharing-button span{font-size:.75em}@media screen and (max-width:798px){.sharing .resp-sharing-button span{display:none}}.sharing .resp-sharing-button__icon svg{width:1em;height:1em;margin:.4em;margin-top:.3em;vertical-align:top}.sharing .resp-sharing-button--small svg{margin:0;vertical-align:middle}.sharing .resp-sharing-button__icon{stroke:#fff;fill:none}.sharing .resp-sharing-button__icon--solid,.sharing .resp-sharing-button__icon--solidcircle{fill:#fff;stroke:none}.sharing .resp-sharing-button--twitter{background-color:#55acee}.sharing .resp-sharing-button--twitter:hover{background-color:#2795e9}.sharing .resp-sharing-button--pinterest{background-color:#bd081c}.sharing .resp-sharing-button--pinterest:hover{background-color:#8c0615}.sharing .resp-sharing-button--facebook{background-color:#3b5998}.sharing .resp-sharing-button--facebook:hover{background-color:#2d4373}.sharing .resp-sharing-button--tumblr{background-color:#35465c}.sharing .resp-sharing-button--tumblr:hover{background-color:#222d3c}.sharing .resp-sharing-button--reddit{background-color:#5f99cf}.sharing .resp-sharing-button--reddit:hover{background-color:#3a80c1}.sharing .resp-sharing-button--google{background-color:#dd4b39}.sharing .resp-sharing-button--google:hover{background-color:#c23321}.sharing .resp-sharing-button--linkedin{background-color:#0077b5}.sharing .resp-sharing-button--linkedin:hover{background-color:#046293}.sharing .resp-sharing-button--email{background-color:#777}.sharing .resp-sharing-button--email:hover{background-color:#5e5e5e}.sharing .resp-sharing-button--xing{background-color:#1a7576}.sharing .resp-sharing-button--xing:hover{background-color:#114c4c}.sharing .resp-sharing-button--whatsapp{background-color:#25d366}.sharing .resp-sharing-button--whatsapp:hover{background-color:#1da851}.sharing .resp-sharing-button--hackernews{background-color:#f60}.sharing .resp-sharing-button--hackernews:hover,.sharing .resp-sharing-button--hackernews:focus{background-color:#fb6200}.sharing .resp-sharing-button--vk{background-color:#507299}.sharing .resp-sharing-button--vk:hover{background-color:#43648c}.sharing .resp-sharing-button--facebook{background-color:#3b5998;border-color:#3b5998}.sharing .resp-sharing-button--facebook:hover,.sharing .resp-sharing-button--facebook:active{background-color:#2d4373;border-color:#2d4373}.sharing .resp-sharing-button--twitter{background-color:#55acee;border-color:#55acee}.sharing .resp-sharing-button--twitter:hover,.sharing .resp-sharing-button--twitter:active{background-color:#2795e9;border-color:#2795e9}.sharing .resp-sharing-button--linkedin{background-color:#0077b5;border-color:#0077b5}.sharing .resp-sharing-button--linkedin:hover,.sharing .resp-sharing-button--linkedin:active{background-color:#046293;border-color:#046293}.sharing .resp-sharing-button--telegram{background-color:#54a9eb}.sharing .resp-sharing-button--telegram:hover{background-color:#4b97d1}.blue-linear{background:#232832;background:linear-gradient(171.89deg,#232832 -5.91%,#0070D8 97.54%)}.dark{background:linear-gradient(135.94deg,rgba(0,22,43,.55) 39.63%,rgba(53,35,76,.55) 99.19%),linear-gradient(180deg,#00162B 0%,#008E7C 31.77%,#00162B 67.19%,#A86FEF 100%)}.blue-yellow{background:linear-gradient(0,#E8ECF3,#E8ECF3),linear-gradient(155.02deg,#472F65 12.31%,#906B20 86.51%);background-blend-mode:multiply}.gray-blue{background:linear-gradient(168.28deg,#232832 35.64%,#5F3E86 100.45%);mix-blend-mode:normal}.dark-purlple{color:#ced5e3;background:linear-gradient(180deg,#35234C 0%,#232832 100%)}.dark-purlple a{color:#e67117;text-decoration-color:#e67117}.blue{color:#fff;background:linear-gradient(272.68deg,#00396F 12.61%,#0070D8 90.99%);background-blend-mode:multiply,multiply,normal}.blue a{color:#fff;text-decoration-color:#fff}.blue a:hover,.blue a:visited:hover{color:#ced5e3;text-decoration-color:#ced5e3}.night{background-color:#0e1a53;background-position:50%;background-repeat:no-repeat;background-size:cover;background:linear-gradient(168.7deg,#00162b 19.55%,#006a5d 110.59%);background-blend-mode:overlay,darken,normal;color:#ced5e3}.night a{color:#ced5e3;text-decoration-color:#ced5e3}.night a:hover,.night a:visited:hover{color:#fff;text-decoration-color:#fff}.aqua{background-color:#006a5d;background-position:50%;background-repeat:no-repeat;background-size:cover;background:linear-gradient(168.7deg,#006A5D -2.9%,#00162B 110.59%);background-blend-mode:darken;color:#fff}.aqua a{color:#fff;text-decoration-color:#fff}.aqua a:hover,.aqua a:visited:hover{color:#42536d;text-decoration-color:#42536d}.text .chroma{font-size:.8rem;border-radius:.2rem}.text .chroma .lntd{vertical-align:top;padding:0;margin:0;border:0}.text .chroma .lntable{border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block}.text .chroma .hl{display:block;width:100%}.text .chroma .lnt{margin-right:.4em;padding:0 .4em}.text .chroma{color:#272822}@media screen{.text .chroma{background-color:#fafafa}}.text .chroma .err{color:#960050}.text .chroma .hl{background-color:#ffc}.text .chroma .lnt{margin-right:.4em;padding:0 .4em;color:#7f7f7f}.text .chroma .ln{color:#7f7f7f}.text .chroma .k{color:#00a8c8}.text .chroma .kc{color:#00a8c8}.text .chroma .kd{color:#00a8c8}.text .chroma .kn{color:#f92672}.text .chroma .kp{color:#00a8c8}.text .chroma .kr{color:#00a8c8}.text .chroma .kt{color:#00a8c8}.text .chroma .n{color:#111}.text .chroma .na{color:#75af00}.text .chroma .nb{color:#111}.text .chroma .bp{color:#111}.text .chroma .nc{color:#75af00}.text .chroma .no{color:#00a8c8}.text .chroma .nd{color:#75af00}.text .chroma .ni{color:#111}.text .chroma .ne{color:#75af00}.text .chroma .nf{color:#75af00}.text .chroma .fm{color:#111}.text .chroma .nl{color:#111}.text .chroma .nn{color:#111}.text .chroma .nx{color:#75af00}.text .chroma .py{color:#111}.text .chroma .nt{color:#f92672}.text .chroma .nv{color:#111}.text .chroma .vc{color:#111}.text .chroma .vg{color:#111}.text .chroma .vi{color:#111}.text .chroma .vm{color:#111}.text .chroma .l{color:#ae81ff}.text .chroma .ld{color:#d88200}.text .chroma .s{color:#d88200}.text .chroma .sa{color:#d88200}.text .chroma .sb{color:#d88200}.text .chroma .sc{color:#d88200}.text .chroma .dl{color:#d88200}.text .chroma .sd{color:#d88200}.text .chroma .s2{color:#d88200}.text .chroma .se{color:#8045ff}.text .chroma .sh{color:#d88200}.text .chroma .si{color:#d88200}.text .chroma .sx{color:#d88200}.text .chroma .sr{color:#d88200}.text .chroma .s1{color:#d88200}.text .chroma .ss{color:#d88200}.text .chroma .m{color:#ae81ff}.text .chroma .mb{color:#ae81ff}.text .chroma .mf{color:#ae81ff}.text .chroma .mh{color:#ae81ff}.text .chroma .mi{color:#ae81ff}.text .chroma .il{color:#ae81ff}.text .chroma .mo{color:#ae81ff}.text .chroma .o{color:#f92672}.text .chroma .ow{color:#f92672}.text .chroma .p{color:#111}.text .chroma .c{color:#75715e}.text .chroma .ch{color:#75715e}.text .chroma .cm{color:#75715e}.text .chroma .c1{color:#75715e}.text .chroma .cs{color:#75715e}.text .chroma .cp{color:#75715e}.text .chroma .cpf{color:#75715e}.text .chroma .ge{font-style:italic}.text .chroma .gs{font-weight:700}.bios__bio{overflow-y:visible;margin-top:1.5rem;border-top:2px solid #fefefe;padding-top:1.5rem;margin-bottom:1.5rem;position:relative;display:flex;flex-direction:row-reverse}.bios__bio h2{line-height:3rem;margin-bottom:1.5rem;margin-top:0}.bios__bio img{margin-left:1.5rem;border-radius:50%;height:10.5rem;width:10.5rem}.bios__content{flex:1}@media screen and (max-width:768px){.bios__bio{display:block;position:relative;text-align:center}.bios__content{flex:none;text-align:left}.bios h2{text-align:center}.bios h2 span{display:block}}</style><link rel=stylesheet id=et-builder-googlefonts-cached-css href="https://fonts.googleapis.com/css?family=Poppins:100,100italic,200,200italic,300,300italic,regular,italic,500,500italic,600,600italic,700,700italic,800,800italic,900,900italic&subset=latin,latin-ext&display=swap" type=text/css media=all><script async src="https://www.googletagmanager.com/gtag/js?id=UA-343802-37"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','UA-343802-37')</script><meta name=color-scheme content="dark light"><link rel=stylesheet type=text/css href=https://cdn-prod.securiti.ai/consent/cookie-consent.css></head><body><script>(function(){var a=document.createElement('script'),b;a.src='https://cdn-prod.securiti.ai/consent/cookie-consent-sdk.js',a.setAttribute('data-tenant-uuid','2ea5dc1c-c928-410b-a379-78d825d2eb0c'),a.setAttribute('data-domain-uuid','2f40096a-75c8-4af2-aec3-42db0231a457'),a.setAttribute('data-backend-url','https://app.securiti.ai'),a.defer=!0,b=document.head||document.body,b.appendChild(a),a.addEventListener('load',function(){window.initCmp()})})()</script><header><div class=page-header><div class=logo><a href=/><img src="data:image/svg+xml,%3Csvg width=%22182%22 height=%2222%22 viewBox=%220 0 182 22%22 fill=%22none%22 xmlns=%22http://www.w3.org/2000/svg%22%3E%3Cg clip-path=%22url(%23clip0_14032_42272)%22%3E%3Cpath d=%22M20.3003 13.4672c2.6587-1.7379 3.5286-5.28282 1.9197-8.06895C21.4138 4.00073 20.1106 2.9999 18.5516 2.58198c-1.4445-.38779-2.9531-.22922-4.281.44163L12.4576-.114746 8.69437 6.40304-.00390625 21.4669H24.9192l-4.6189-7.9997zM18.1252 4.17857C19.2585 4.4804 20.2015 5.20806 20.7889 6.22124 21.9433 8.21847 21.3436 10.7517 19.4714 12.0311L15.0985 4.45817C16.0406 4.00518 17.1032 3.90638 18.1252 4.17857zm-5.6676-.98552L22.053 19.8126H16.4387L9.64927 8.05693 12.4571 3.19354 12.4576 3.19305zM2.86226 19.8126 8.69388 9.71429 14.5255 19.8126H2.86226z%22 fill=%22url(%23paint0_linear_14032_42272)%22/%3E%3Cpath d=%22M20.3198 13.4281c2.6587-1.7379 3.5287-5.28278 1.9197-8.06891C21.4333 3.96167 20.1301 2.96084 18.5711 2.54291c-1.4444-.38778-2.9531-.22921-4.281.44164L12.4772-.153809 8.7139 6.36397.015625 21.4279H24.9387l-4.6189-7.9998zm-2.175-9.28859C19.278 4.44134 20.221 5.169 20.8084 6.18218c1.1545 1.99723.5548 4.53042-1.3175 5.80992L15.1181 4.41911C16.0601 3.96612 17.1227 3.86732 18.1448 4.13951zm-5.6676-.98552L22.0725 19.7735H16.4583L9.6688 8.01787l2.8079-4.86339L12.4772 3.15399zM2.88179 19.7735 8.71341 9.67523 14.545 19.7735H2.88179z%22 fill=%22url(%23paint1_linear_14032_42272)%22/%3E%3Cpath d=%22M41.4618 15.1529H37.9504V21.436H33.3281V.484375h8.5884c5.014.0 8.0468 2.960975 8.0468 7.243045V7.78454C49.9633 12.6341 46.182 15.1474 41.4674 15.1474L41.4618 15.1529zm3.8109-7.33335c0-2.06549-1.4397-3.17286-3.7536-3.17286H37.9448V11.0495H41.606c2.3139.0 3.6612-1.37819 3.6612-3.17283V7.81955H45.2727z%22 fill=%22%23fff%22/%3E%3Cpath d=%22M52.543 21.4378V.484375H68.3964V4.58773H57.1375V8.84032h9.9061V12.9437H57.1375v4.4018H68.5461v4.1034H52.543V21.4378z%22 fill=%22%23fff%22/%3E%3Cpath d=%22M84.9239 21.4378l-4.5021-6.7032H76.7902v6.7032H72.168V.484375H81.7747C86.7314.484375 89.7014 3.08974 89.7014 7.39945V7.45657C89.7014 10.8376 87.8717 12.9658 85.1993 13.9534L90.3335 21.436H84.9221L84.9239 21.4378zM85.0163 7.64082C85.0163 5.66746 83.6339 4.64484 81.3847 4.64484H76.792V10.6608H81.4771C83.7282 10.6608 85.0163 9.46126 85.0163 7.69979V7.64267 7.64082z%22 fill=%22%23fff%22/%3E%3Cpath d=%22M102.952 21.9979c-6.2653.0-10.9208-4.8219-10.9208-10.9226V11.0164c0-6.03623 4.5613-10.9797789 11.1078-10.9797789C107.153.0366211 109.561 1.36878 111.538 3.31083L108.557 6.73612C106.913 5.24734 105.244 4.34081 103.109 4.34081 99.5218 4.34081 96.9307 7.31284 96.9307 10.9537V11.0127c0 3.6408 2.5264 6.67 6.17829999999999 6.67 2.432.0 3.926-.971 5.60000000000001-2.4893L111.69 18.1949C109.496 20.5331 107.064 21.9869 102.958 21.9869L102.952 21.9979z%22 fill=%22%23fff%22/%3E%3Cpath d=%22M124.054 21.9979c-6.574.0-11.288-4.8846-11.288-10.9226V11.0164c0-6.03623 4.777-10.9797789 11.345-10.9797789C130.68.0366211 135.4 4.92121 135.4 10.9592V11.0182C135.4 17.0544 130.622 21.9979 124.054 21.9979zm6.452-10.9797c0-3.64088-2.678-6.67002-6.452-6.67002s-6.387 2.97203-6.387 6.61292V11.02c0 3.6409 2.678 6.6701 6.452 6.6701s6.387-2.9721 6.387-6.6129V11.0182z%22 fill=%22%23fff%22/%3E%3Cpath d=%22M160.855 21.4544 171.198.0366211 181.54 21.4562H176.354L171.198 10.7971 166.06 21.4562H160.855V21.4544z%22 fill=%22%23fff%22/%3E%3Cpath d=%22M158.941.49173V21.9998L143.169 9.26409V21.4194H138.262V.0366211L154.034 12.7226V.49173H158.941z%22 fill=%22%23fff%22/%3E%3C/g%3E%3Cdefs%3E%3ClinearGradient id=%22paint0_linear_14032_42272%22 x1=%22-.113079%22 y1=%2223.6746%22 x2=%2220.3857%22 y2=%223.17583%22 gradientUnits=%22userSpaceOnUse%22%3E%3Cstop stop-color=%22%23fc3519%22/%3E%3Cstop offset=%221%22 stop-color=%22%23f0d136%22/%3E%3C/linearGradient%3E%3ClinearGradient id=%22paint1_linear_14032_42272%22 x1=%222.82663%22 y1=%2221.9045%22 x2=%2221.3237%22 y2=%223.40741%22 gradientUnits=%22userSpaceOnUse%22%3E%3Cstop stop-color=%22%23fc3519%22/%3E%3Cstop offset=%221%22 stop-color=%22%23f0d136%22/%3E%3C/linearGradient%3E%3CclipPath id=%22clip0_14032_42272%22%3E%3Crect width=%22181.538%22 height=%2222%22 fill=%22%23fff%22/%3E%3C/clipPath%3E%3C/defs%3E%3C/svg%3E" alt=Percona></a></div><input type=checkbox id=show-mobile-menu value=1 aria-hidden=true><div class=mobile-toggle aria-controls=mobile-menu aria-label="Open navigation" role=button><label for=show-mobile-menu id=hamburger><span class=hamburger-bar></span><span class=hamburger-bar></span><span class=hamburger-bar></span></label></div><div class=mobile-menu id=mobile-menu aria-labelledby=navigation-header role=dialog aria-modal=false aria-hidden=true><nav><ul class=menu__list><li><a href=/contribute><span>Contribute</span></a><ul class="submenu__list sub-menu"><li><a href=/contribute/how-to-get-involved><span>How to Get Involved</span></a></li><li><a href=/contribute/coc><span>Code of Conduct</span></a></li><li><a href=/contribute/opentopics><span>Open Topics</span></a></li><li><a href=/contribute/articles><span>Articles</span></a></li><li><a href=/contribute/youtube_playlists><span>YouTube Playlists</span></a></li><li><a href=/contribute/documentation><span>Documentation</span></a></li><li><a href=/contribute/testimonials><span>Testimonials & Surveys</span></a></li><li><a href=/contribute/videos><span>Videos</span></a></li><li><a href=/contribute/dev><span>Repositories and Artifacts</span></a></li></ul></li><li><a href=/events><span>Events</span></a><ul class="submenu__list sub-menu"><li><a href=/events><span>Community Events</span></a></li><li><a href=/speakers><span>Speakers</span></a></li><li><a href=/podcasts><span>Podcasts</span></a></li></ul></li><li><a href=/blog><span>Blog</span></a><ul class="submenu__list sub-menu"><li><a href=/blog><span>Posts</span></a></li><li><a href=/authors><span>Authors</span></a></li></ul></li><li><a href=/projects><span>Projects</span></a><ul class="submenu__list sub-menu"><li><a href=/projects/operators/><span>Kubernetes Operators</span></a></li><li><a href=/projects/pmm/><span>Percona Monitoring and Management</span></a></li><li><a href=/projects/platform/><span>Percona Platform</span></a></li><li><a href=/projects/toolkit/><span>Percona Toolkit</span></a></li><li><a href=/projects><span>All projects</span></a></li></ul></li><li><a href=/mysql><span>MySQL</span></a></li><li><a href=/postgresql><span>PostgreSQL</span></a></li><li><a href=/mongodb><span>MongoDB</span></a></li></ul></nav></div></div></header><main class=page><div class=page-main><article class="text blog-post" itemscope itemtype=https://schema.org/BlogPosting><meta itemprop=image content="https://percona.community/blog/2020/04/xeyzb9g_fodczvifb-xym4-qdwa.png"><meta itemprop=mainEntityOfPage content="https://percona.community/blog/2020/04/29/the-anatomy-of-luajit-tables-and-whats-special-about-them/"><meta itemprop=keywords content="rosik, Advanced Level, Lua, Tarantool, Tools"><h1 itemprop="name headline">The Anatomy of LuaJIT Tables and What's Special About Them</h1><div class=meta><time datetime="2020-04-29 13:18:37 +0000 UTC" itemprop=datePublished><span class=line>April 29, 2020</span>
<span class=calendar><span class=day>29</span>
<span class=month-year>Apr 2020</span></span></time>
<span class=authors>by <a href=/authors/yaroslav_dynnikov/>Yaroslav Dynnikov</a></span></div><div itemprop=articleBody class=body><p>I don&rsquo;t know about you, but I really like to get inside all sorts of systems. In this article, I’m going to tell you about the internals of Lua tables and special considerations for their use. Lua is my primary professional programming language, and if one wants to write good code, one needs at least to peek behind the curtain. If you are curious, follow me.</p><p><figure><img src=/blog/2020/04/xeyzb9g_fodczvifb-xym4-qdwa.png alt=&nbsp;></figure></p><p>Lua has several implementations and several versions. In this article, I&rsquo;m going to discuss mostly LuaJIT 2.1.0, which is used in Tarantool. Our version is a bit patched as compared to the authentic LuaJIT, but the differences don&rsquo;t impact tables.</p><p>There is another good presentation about tables in <a href=https://yszheda.github.io/lua-table-talk/ target=_blank rel="noopener noreferrer">PUC-Rio implementation</a>, if you&rsquo;re interested. You can also find this on <a href=https://www.slideshare.net/ShuaiYuan/the-basics-and-design-of-lua-table target=_blank rel="noopener noreferrer">slideshare.net.</a></p><h2 id=overview>Overview</h2><p>Tables in Lua are the only composite data type designed to suit any purpose. A table can be used both as a data array (if the keys are integer-valued) and as a key-value repository. Values of any type can be used as keys (except for nil). Scientifically speaking, a table is an <a href=https://www.lua.org/pil/2.5.html target=_blank rel="noopener noreferrer">associative array</a>.</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>-- Empty table
local t1 = {}

-- Table as an array
local t2 = { &#39;Sunday&#39;, &#39;Monday&#39;, &#39;Im tired&#39; }

-- Table as a hashtable
local t3 = {
    cat = &#39;meow&#39;,
    dog = &#39;woof&#39;,
    cow = &#39;moo&#39;,
}

-- Ordered map
local t4 = {
    &#39;k1&#39;, &#39;k2&#39;, &#39;k3&#39; -- stored in the array part
    [&#39;k1&#39;] = &#39;v1&#39;,   -- stored in the hash part
    [&#39;k2&#39;] = &#39;v2&#39;,   -- stored in the hash part
    [&#39;k3&#39;] = &#39;v3&#39;,   -- stored in the hash part
}
</code></pre></div><h2 id=anatomy-of-tables>Anatomy of tables</h2><p>In <a href=https://github.com/LuaJIT/LuaJIT/blob/v2.1/src/lj_obj.h#L482-L495 target=_blank rel="noopener noreferrer">LuaJIT sources</a>, a table is represented by the following structure (I&rsquo;ve omitted a part of fields which are not relevant here for simplicity):</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>typedef struct GCtab {
  /* GC stuff */
  MRef array;     /* Array part. */
  MRef node;      /* Hash part.  */
  uint32_t asize; /* Size of array part (keys [0, asize-1]). */
  uint32_t hmask; /* Hash part mask (size of hash part - 1). */
} GCtab;
</code></pre></div><p>A table has two parts: array and hashmap. Both are represented by continuous storage areas. I was about to describe the logic LuaJIT is guided by when new elements are inserted, but this a rather sophisticated algorithm. Moreover, as a Lua developer, I have no need to speculate about what a table looks like on the inside. There&rsquo;s something that is more important: two tables may contain the same keys and values, but differ in terms of internal representation. This internal representation will affect behaviors of some functions, which I&rsquo;m going to discuss here.</p><p>For demonstration, I took LuaJIT source code and patched the tostring() method a bit so that it would print out the size and all the contents of C structure to stdout using printf().</p><h3 id=what-the-patch-is-about>What the patch is about</h3><p>The most complete version of code from the publication, including all the experiments, can be found on <a href=https://github.com/rosik/luajit/compare/tarantool...rosik:habr-luajit-tables target=_blank rel="noopener noreferrer">GitHub</a>. Conceptually, this is what the code looks like:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>diff --git a/src/lj_strfmt.c b/src/lj_strfmt.c
index d7893ce..45df53c 100644
--- a/src/lj_strfmt.c
+++ b/src/lj_strfmt.c
@@ -392,6 +392,51 @@ GCstr * LJ_FASTCALL lj_strfmt_obj(lua_State *L, cTValue *o)
     if (tvisfunc(o) &amp;&amp; isffunc(funcV(o))) {
       p = lj_buf_wmem(p, &#34;builtin#&#34;, 8);
       p = lj_strfmt_wint(p, funcV(o)-&gt;c.ffid);
+    } else if (tvistab(o)) {
+      GCtab *t = tabV(o);
+      /* print array part */
+      printf(&#34;--  a[%d]: &#34;, asize);
+      for (i = 0; i &lt; asize; i++) {
+        // printf(...);
+      }
+
+      /* print hashmap part */
+      printf(&#34;--  h[%d]: &#34;, hmask+1);
+      for (i = 0; i &lt;= hmask; i++) {
+        // printf(...);
+      }
     } else {
       p = lj_strfmt_wptr(p, lj_obj_ptr(o));
     }
</code></pre></div><p>Let me show how this works:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>t = {}
tostring(t)
-- table: 0x40eae3a8
--  a[0]:
--  h[1]: nil=nil
</code></pre></div><p>We&rsquo;ve created an empty table, and LuaJIT has allocated storage space for 0 array elements and 1 element in hashmap, to which is placed nil key and nil value (i.e. nothing). Now let&rsquo;s try to populate this table:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>t[&#34;a&#34;] = &#34;A&#34;
t[&#34;b&#34;] = &#34;B&#34;
t[&#34;c&#34;] = &#34;C&#34;
tostring(t)
-- table: 0x40eae3a8
--  a[0]:
--  h[4]: b=B, nil=nil, a=A, c=C
</code></pre></div><p>String keys are added to hashmap as expected. Here the first reason becomes visible as to why the internal representation of tables may differ: hash collisions. To resolve hash collisions, LuaJIT uses a hybrid of open addressing and <a href=https://github.com/LuaJIT/LuaJIT/issues/494#issuecomment-487373965 target=_blank rel="noopener noreferrer">separate chaining methods</a> (thanks to <a href=https://imun.cloud/ target=_blank rel="noopener noreferrer">Igor Munkin</a> for clarification).</p><p>Depending on the order in which elements are added to the table, their order during integration will differ. For demonstration, I&rsquo;ve set up one more auxiliary function traverse(), which runs for cycle through the table and prints out its contents.</p><h3 id=implementation-of-traverse>Implementation of traverse</h3><p>A complete version of the code can still be found on <a href=https://github.com/rosik/luajit/compare/tarantool...rosik:habr-luajit-tables target=_blank rel="noopener noreferrer">GitHub</a>. For brevity, I&rsquo;m going to demonstrate only its operating principle here.</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>function traverse(fn, t)
    local str = &#39;&#39;
    for k, v, n in fn(t) do
        str = str .. string.format(&#39;%s=%s &#39;, k, v)
    end
    print(str)
end
</code></pre></div><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>t1 = {a = 1, b = 2, c = 3}
tostring(t1)
-- table: 0x40eaeb08
--  a[0]:
--  h[4]: b=2, nil=nil, a=1, c=3

t2 = {c = 3, b = 2, a = 1}
tostring(t2)
-- table: 0x40ea7e70
--  a[0]:
--  h[4]: b=2, nil=nil, c=3, a=1

traverse(pairs, t1)
-- b=2, a=1, c=3

traverse(pairs, t2)
-- b=2, c=3, a=1
</code></pre></div><p>One more interesting fact about the internals of tables: the deletion of a value does not lead to deletion of a key. Sounds like Captain Obvious, but it&rsquo;s true.</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>t2[&#34;c&#34;] = nil
traverse(pairs, t2)
-- b=2, a=1
tostring(t2)
-- table: 0x411c83c0
--  a[0]:
--  h[4]: b=2, nil=nil, c=nil, a=1

print(next(t2, &#34;c&#34;))
-- a
</code></pre></div><p>This is done for a reason, to make it possible to delete values and not disturb iteration order. What is strongly discouraged is to add new keys to the table within the cycle as reallocation or re-hashing may occur, and then iteration will bust.</p><p><em>An additional note</em> from <a href=https://imun.cloud/ target=_blank rel="noopener noreferrer">Igor Munkin</a>: the reason is lookup in general, not iteration. Collisions are resolved by the chain method. Generally, when the main node is deleted for the searched key, the link to the colliding element needs to be reassigned to the predecessor (if present) of this main node. Task O(n) to search for it needs to be performed when deleting. The cost of a search does not worsen when a dead node is present on the way to collision resolution. See also <a href=https://github.com/LuaJIT/LuaJIT/issues/494#issuecomment-487373965 target=_blank rel="noopener noreferrer">this reference.</a></p><h3 id=arrays>Arrays</h3><p>OK, iteration for string keys is clear, no more questions. Now let&rsquo;s talk about the second half of the table — the array.</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>t = {1, 2}
tostring(t)
-- table: 0x41735918
--  a[3]: nil, 1, 2
--  h[1]: nil=nil
</code></pre></div><p>Lua is often made fun of because indexation in this language starts with one. Interestingly, LuaJIT allocates space to store the null element anyway. This makes it easier for it to avoid multiple addition / deduction of one. If it appears to you that arrays don&rsquo;t have any surprises, then I&rsquo;m here to disappoint you (or to make you happy) — they do:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>t = {[2] = 2, 1}
tostring(t)
-- table: 0x416a3998
--  a[2]: nil, 1
--  h[2]: nil=nil, 2=2
</code></pre></div><p>I&rsquo;ve changed syntax a bit, so one element gets to the array, and another gets to the hashmap. So consider yourself warned: it&rsquo;s no use taking guesses about internal representation as your guess can turn out to be wrong at any time.</p><h4 id=faq-what>FAQ: WHAT?</h4><p><strong>Answer</strong>: the LuaJIT interpreter, just like regular Lua, generates a different bytecode in these two cases. In the first case, space is allocated to place two array elements, which is logical.</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>$ luac -l - &lt;&lt;&lt; &#34;t1 = {1, 2}&#34;

        1       [1]     NEWTABLE        0 2 0   -- 2 in array, 0 in hash-map
        ...
</code></pre></div><p>In the second case, one element in the array and one in the hashmap.</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>$ luac -l - &lt;&lt;&lt; &#34;t2 = {[2] = 2, 1}&#34;

        1       [1]     NEWTABLE        0 1 1   -- 1 in array, 1 in hash-map
        ...
</code></pre></div><p>But still, my primary concern as a developer is the correctness of my code. If LuaJIT is comfortable with presenting tables differently, it has the right to do it this way. For me, the main thing is that it is done seamlessly. So I suggest that we go over functions and spell out the expectations.</p><h3 id=iterator-pairs>Iterator pairs()</h3><p>Iterator pairs() has already been mentioned here earlier. It does not guarantee the iteration order. Even in an array. From the inside of LuaJIT, pairs() runs in sequence, first over the array, then over the hashmap. So if a numerical key gets to hashmap some way, then iteration order will be disturbed:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>t = table.new(4, 4)
for i = 1, 8 do t[i] = i end

tostring(t)
-- table: 0x412c6df0
--  a[5]: nil, 1, 2, 3, 4
--  h[4]: 7=7, 8=8, 5=5, 6=6
traverse(pairs, t)
-- 1=1, 2=2, 3=3, 4=4, 7=7, 8=8, 5=5, 6=6
</code></pre></div><h4 id=faq-what-1>FAQ: WHAT?</h4><p><strong>Answer</strong>: Function table.new(narr, nrec) pre-allocates the required storage space — this is the binding of the standard function lua_createtable(L, a, h) from Lua C API. If the table size is known beforehand (e.g. in the case of copying), this can be used to save on reallocations when the table is subsequently populated.</p><p>This trick works exclusively due to pre-allocation. Another element being added to the table and the following re-hashing (which is a rather expensive and complex operation) will totally remove the veil of mystery from the table:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>t[9] = 9
tostring(t)
-- table: 0x411e1e30
--  a[17]: nil, 1, 2, 3, 4, 5, 6, 7, 8, 9, nil, nil, nil, nil, nil, nil, nil
--  h[1]: nil=nil
</code></pre></div><p>By no means do I want to sound paranoid, and I consider this case highly implausible. In 99.9% of instances, &ldquo;arrays&rdquo; in Lua will really be represented by arrays, and the iteration order will be sequential.</p><h3 id=table-length-tablegetn>Table length table.getn()</h3><p>Much more often, errors occur because of array length being calculated incorrectly. The main thing one needs to know about it is this definition from <a href=https://www.lua.org/manual/5.2/manual.html#3.4.6 target=_blank rel="noopener noreferrer">Lua specification:</a></p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>3.4.6 – The Length Operator

The length of a table t is only defined if the table is a sequence, that is,
the set of its positive numeric keys is equal to {1..n} for some non-negative
integer n. In that case, n is its length. Note that a table like

    {10, 20, nil, 40}

is not a sequence, because it has the key 4 but does not have the key 3. (So,
there is no n such that the set {1..n} is equal to the set of positive numeric
keys of that table.) Note, however, that non-numeric keys do not interfere with
whether a table is a sequence.
</code></pre></div><p>That is to say, not every table has the property of length. Surprise — undefined behavior can occur in Lua. Tables with &ldquo;holes&rdquo; simply don&rsquo;t have such a property. In the LuaJIT implementation, <a href=https://github.com/LuaJIT/LuaJIT/blob/v2.1/src/lj_tab.c#L640-L686 target=_blank rel="noopener noreferrer">function lj_tab_len</a> is commented as follows:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>/*
** Try to find a boundary in table `t&#39;. A `boundary&#39; is an integer index
** such that t[i] is non-nil and t[i+1] is nil (and 0 if t[1] is nil).
*/
MSize LJ_FASTCALL lj_tab_len(GCtab *t);
</code></pre></div><p>LuaJIT searches for a &ldquo;boundary&rdquo; in the table. If there are missing values in the array, and thus several boundaries exist, then, depending on the circumstances, LuaJIT will be able to find any of those — and will be right:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>print(#{nil, 2})
-- 2

print(#{[2] = 2})
-- 0
</code></pre></div><h4 id=faq-what-2>FAQ: WHAT?</h4><p><strong>Answer</strong>: These two tables differ in terms of internal representation.</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>tostring({nil, 2})
-- table: 0x410d5528
--  a[3]: nil, nil, 2
--  h[1]: nil=nil

tostring({[2] = 2})
-- table: 0x410d5810
--  a[0]:
--  h[2]: nil=nil, 2=2
</code></pre></div><p>LuaJIT searches for a boundary with a binary search, and it first checks the last element in the array. If it exists, the search proceeds to the hashmap, otherwise it continues in the array.</p><p>And this definitely does not sound paranoid as there have been such errors in the past. Table length is implicitly used in other functions, so undefined behavior is something you don&rsquo;t want to play with. To be fair, it should be noted that in arrays without holes, the behavior is strictly determined and does not depend on internal representation.</p><h3 id=tablesort-sorting>Table.sort() sorting</h3><p>Table sorting always works within the range from 1 to #t, and there is no way to influence this. So it is helpful to check input values in those functions which deal with a table as an array:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>local function is_array(t)
    if type(t) ~= &#39;table&#39; then
        return false
    end

    local i = 0
    for _, _ in pairs(t) do
        i = i + 1
        if type(t[i]) == &#39;nil&#39; then
            return false
        end
    end
    return true
end
</code></pre></div><p>Lua allows length to exist though, even when string keys are present, but as far as we are talking about typical contracts of functions, hybrid tables rarely work.</p><h3 id=packunpack><strong>Pack/unpack</strong></h3><p>Where do those arrays with holes really come from? A rare weird case, as it might seem. But nope, there are dangers lurking every step of the way:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>local function vararg(...)
    local args = {...}
    -- #args == undefined behavior
end
</code></pre></div><p>The multiple periods here are not an ellipsis but rather a designation of a variable number of function arguments in Lua.</p><p>Then someone calls this function with arguments vararg(nil, &ldquo;err&rdquo;), and here you are: your function handles a holed array. If one calls unpack(t) after this, then the tail may fall off (or it may not, depends on luck, because this is UB).</p><p>The <a href=https://www.lua.org/manual/5.1/manual.html#pdf-unpack target=_blank rel="noopener noreferrer">Lua specification</a> reads:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>6.5 – Table Manipulation

unpack (list [, i [, j]])

Returns the elements from the given table. This function is equivalent to

    return list[i], list[i+1], ···, list[j]

except that the above code can be written only for a fixed number of elements.
By default, i is 1 and j is the length of the list, as defined by the length
operator #list.
</code></pre></div><p>To avoid the inadvertent loss of tail, instead of implicit unpack(t, 1, #t) always write explicitly unpack(t, 1, n). But where to take this n from? The answer depends on what kind of table you&rsquo;ve got. In the case of varargs, you can use table.pack() method, which returns a hybrid:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>t = table.pack(nil, 2)
tostring(t)
-- table: 0x41053540
--  a[3]: nil, nil, 2
--  h[2]: nil=nil, n=2

traverse(pairs, t)
-- 2=2, n=2
print(unpack(t, 1, t.n))
-- nil, 2 -- _It’s OK, it’s not UB_
</code></pre></div><p>In LuaJIT (and in Tarantool), the table.pack function is inaccessible by default, but it can be enabled with flag of -DLUAJIT_ENABLE_LUA52COMPAT compiler. But it is even easier to implement this functionality manually:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>function table.pack(...)
    return {..., n = select(&#39;#&#39;, ...)}
end
</code></pre></div><p>This is where black magic comes into play — <a href=https://www.lua.org/manual/5.1/manual.html#pdf-select target=_blank rel="noopener noreferrer">select('#', &mldr;)</a> — but a detailed description of its mechanism simply would not fit into this article. I&rsquo;d just give you a tip: this has to do with <a href=https://www.lua.org/manual/5.1/manual.html#3.1 target=_blank rel="noopener noreferrer">Lua stack</a> — the mechanism which provides an interface between Lua and C (Lua C API). Meanwhile, we&rsquo;ve got to move on.</p><h3 id=iterator-ipairs>Iterator ipairs()</h3><p>This one is a good operator, predictable enough. ipairs should be thought of as a shortened version of such while cycle as:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>local i = 1
while type(t[i]) ~= &#39;nil&#39; do
    -- do something
    i = i + 1
end
</code></pre></div><p>No internal representation differences can affect it, and &ldquo;holes&rdquo; don&rsquo;t lead to undefined behavior — iteration simply stops.</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>t = {1, 2, nil, 4}
print(#t) -- UB
-- 4
traverse(ipairs, t) -- Not UB
-- 1=1, 2=2
</code></pre></div><h3 id=pitfalls-of-ffi>Pitfalls of FFI</h3><p>An attentive reader could have noticed that I have already used twice a strange expression type(x) ~= &lsquo;nil&rsquo;. Why not just x == nil? This is because LuaJIT, unlike PUC-Rio Lua, has a magic type cdata:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>ffi = require(&#39;ffi&#39;)
NULL = ffi.new(&#39;void*&#39;, nil)

print(type(NULL))
-- cdata
print(type(nil))
-- nil

print(NULL == nil)
-- true

if NULL then print(&#39;NULL is not nil&#39;) end
-- NULL is not nil
</code></pre></div><p>This is a notorious pitfall in Tarantool named box.NULL. Note that condition if NULL is interpreted as true (unlike if nil), despite the fact that NULL == nil.</p><p>Another pitfall in LuaJIT is the use of FFI types as a table key. This issue is not so frequently discussed in Lua manuals because there are no FFI types in the vanilla version of Lua. But LuaJIT can surprise you and backfire. Here&rsquo;s what&rsquo;s <a href=https://github.com/LuaJIT/LuaJIT/blob/v2.1/doc/ext_ffi_semantics.html#L775-L789 target=_blank rel="noopener noreferrer">written in the manual</a>:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>Lua tables may be indexed by cdata objects, but this doesn&#39;t provide any useful
semantics — cdata objects are unsuitable as table keys!

A cdata object is treated like any other garbage-collected object and is hashed
and compared by its address for table indexing. Since there&#39;s no interning for
cdata value types, the same value may be boxed in different cdata objects with
different addresses. Thus t[1LL+1LL] and t[2LL] usually do not point to the
same hash slot and they certainly do not point to the same hash slot as t[2].
</code></pre></div><p>Simply put, for cdata-keys, hash is counted from the pointer (i.e. void*), so they show unpredictable behavior and should be avoided in practice at all cost. A joke from Tarantool life:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>tarantool&gt; t = {1}; t[1ULL] = 2; t[1ULL] = 3;
---
...

tarantool&gt; t
---
- 1: 1
  1: 3
  1: 2
...

tarantool&gt; t[1ULL]
---
- null
...
</code></pre></div><p>I hope no one in one&rsquo;s right mind would write things like this in code, but cdata is not infrequent, and this has occurred in the past. As an example, <a href=https://www.tarantool.io/en/doc/2.2/reference/reference_lua/uuid/#uuid-call target=_blank rel="noopener noreferrer">consider uuid</a> and clock.time64() from Tarantool. Or big values stored in spaces in unsigned format. As long as we are on this subject, note that it&rsquo;s possible to obtain unexpected results without using too, though I&rsquo;ve never seen this in practice:</p><div class=highlight><pre class=chroma><code class=language-fallback data-lang=fallback>tarantool&gt; t = {&#39;normal one&#39;}
    t[1.0 + 2^-52] = &#39;1.0 + 2^-52&#39;
    t[0.1 + 0.3*3] = &#39;0.1 + 0.3*3&#39;
---
...
tarantool&gt; t
---
- 1: normal one
  1: 1.0 + 2^-52
  1: 0.1 + 0.3*3
...
</code></pre></div><h2 id=summary>Summary</h2><ul><li>Table length operator #t is only defined for arrays without holes. All the rest is Undefined Behavior.</li><li>Function ipairs() is iterated as while type(t[i]) ~= &lsquo;nil&rsquo; — not for all keys, but, on the plus side, in a predictable way, and the order is guaranteed.</li><li>Function pairs() is iterated for all keys, but the iteration order is affected by the internal representation of table.</li><li>Functions unpack, table.sort, table.insert, and table.remove, once called with default arguments, hold undefined behavior in them due to implicit #t.</li><li>The use of &ldquo;strange&rdquo; (ffi) values in keys affords you plenty of ways to shoot yourself in the foot. They should be avoided.</li></ul><p>&ndash; <em>The content in this blog is provided in good faith by members of the open source community. Percona has not edited or tested the technical content. Views expressed are the authors’ own. When using the advice from this or any other online resource test ideas before applying them to your production systems, and always secure a working back up.</em> <span aria-label="End of article." role=text class=tombstone>∎</span></p></div><div class=bios><div class=bios__bio><img class=avatar src=https://percona.community/blog/authors/yaroslav_dynnikov_hu7189af5e6c82db2d57a264b7f0a43c7e_26479_240x240_fill_q90_lanczos_smart1.jpeg alt><div class=bios__content><h2><span>Yaroslav Dynnikov</span></h2><p>Tarantool Solution Engineer and Software Developer. I have used Lua since 2007. For the last three years this has been my primary programming language professionally. I used it for video streaming business logic and now within Tarantool to develop an in-memory database and a Lua application server.</p><p><a href=/authors/yaroslav_dynnikov>See all posts by Yaroslav Dynnikov &#187;</a></p></div></div></div></article><div class=comments><h2>Comments</h2><div id=disqus_thread></div><script>var disqus_config=function(){this.page.url="https://percona.community/blog/2020/04/29/the-anatomy-of-luajit-tables-and-whats-special-about-them/"};(function(){var a=document,b=a.createElement('script');b.src='https://percona-community01.disqus.com/embed.js',b.setAttribute('data-timestamp',+new Date),(a.head||a.body).appendChild(b)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div><div class=sharing><a class=resp-sharing-button__link href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fpercona.community%2fblog%2f2020%2f04%2f29%2fthe-anatomy-of-luajit-tables-and-whats-special-about-them%2f" target=_blank rel=noopener aria-label="Share on Facebook"><div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--large"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18.77 7.46H14.5v-1.9c0-.9.6-1.1 1-1.1h3V.5h-4.33C10.24.5 9.5 3.44 9.5 5.32v2.15h-3v4h3v12h5v-12h3.85l.42-4z"/></svg></div><span>Share on Facebook</span></div></a><a class=resp-sharing-button__link href="https://twitter.com/intent/tweet/?text=The%20Anatomy%20of%20LuaJIT%20Tables%20and%20What%27s%20Special%20About%20Them&url=https%3a%2f%2fpercona.community%2fblog%2f2020%2f04%2f29%2fthe-anatomy-of-luajit-tables-and-whats-special-about-them%2f" target=_blank rel=noopener aria-label="Share on Twitter"><div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--large"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M23.44 4.83c-.8.37-1.5.38-2.22.02.93-.56.98-.96 1.32-2.02-.88.52-1.86.9-2.9 1.1-.82-.88-2-1.43-3.3-1.43-2.5.0-4.55 2.04-4.55 4.54.0.36.03.7.1 1.04-3.77-.2-7.12-2-9.36-4.75-.4.67-.6 1.45-.6 2.3.0 1.56.8 2.95 2 3.77-.74-.03-1.44-.23-2.05-.57v.06c0 2.2 1.56 4.03 3.64 4.44-.67.2-1.37.2-2.06.08.58 1.8 2.26 3.12 4.25 3.16C5.78 18.1 3.37 18.74 1 18.46c2 1.3 4.4 2.04 6.97 2.04 8.35.0 12.92-6.92 12.92-12.93.0-.2.0-.4-.02-.6.9-.63 1.96-1.22 2.56-2.14z"/></svg></div><span>Share on Twitter</span></div></a><a class=resp-sharing-button__link href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fpercona.community%2fblog%2f2020%2f04%2f29%2fthe-anatomy-of-luajit-tables-and-whats-special-about-them%2f&title=The%20Anatomy%20of%20LuaJIT%20Tables%20and%20What%27s%20Special%20About%20Them&source=https%3a%2f%2fpercona.community%2fblog%2f2020%2f04%2f29%2fthe-anatomy-of-luajit-tables-and-whats-special-about-them%2f" target=_blank rel=noopener aria-label="Share on LinkedIn"><div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--large"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6.5 21.5h-5v-13h5v13zM4 6.5C2.5 6.5 1.5 5.3 1.5 4s1-2.4 2.5-2.4c1.6.0 2.5 1 2.6 2.5.0 1.4-1 2.5-2.6 2.5zm11.5 6c-1 0-2 1-2 2v7h-5v-13h5V10s1.6-1.5 4-1.5c3 0 5 2.2 5 6.3v6.7h-5v-7c0-1-1-2-2-2z"/></svg></div><span>Share on LinkedIn</span></div></a><a class=resp-sharing-button__link href="https://telegram.me/share/url?text=The%20Anatomy%20of%20LuaJIT%20Tables%20and%20What%27s%20Special%20About%20Them&url=https%3a%2f%2fpercona.community%2fblog%2f2020%2f04%2f29%2fthe-anatomy-of-luajit-tables-and-whats-special-about-them%2f" target=_blank rel=noopener aria-label="Share on Telegram"><div class="resp-sharing-button resp-sharing-button--telegram resp-sharing-button--large"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M.707 8.475C.275 8.64.0 9.508.0 9.508s.284.867.718 1.03l5.09 1.897 1.986 6.38a1.102 1.102.0 001.75.527l2.96-2.41a.405.405.0 01.494-.013l5.34 3.87a1.1 1.1.0 001.046.135 1.1 1.1.0 00.682-.803l3.91-18.795A1.102 1.102.0 0022.5.075L.706 8.475z"/></svg></div><span>Share on Telegram</span></div></a></div><div class="recommendations branded"><h2>Did you like this post? Why not read more?</h2><div class="grid grid--3"><div class=grid__item><a href=/blog/2020/04/01/deploying-tarantool-cartridge-applications-with-zero-effort-part-2/ class="post post--preview"><img src=/blog/2020/03/ycgmxxaqlvyslsrzoo6jnv1vmx0_hu2429a0eb1878d7ee502f453338519e79_38404_682x384_fill_q90_lanczos_smart1.jpeg alt><div class=post__text><h3>Deploying Tarantool Cartridge Applications with Zero Effort (Part 2)</h3><div class=post__content><p><small>...</small></p><div class=bottom><p></p><p class=post-type>Article</p></div></div></div></a></div><div class=grid__item><a href=/blog/2020/03/24/deploying-tarantool-cartridge-applications-with-zero-effort-part-1/ class="post post--preview"><img src=/blog/2020/02/tarantool-new-instances-scaled_huf1c0a5ad0843880587f62ac055c091c8_1471416_682x384_fill_q90_bgffffff_lanczos_smart1_2.jpg alt><div class=post__text><h3>Deploying Tarantool Cartridge Applications with Zero Effort (Part 1)</h3><div class=post__content><p>Tarantool is an open-source in-memory DB with a Lua application server on board. It’s best used for apps that require high performance and horizontal scaling. Out of the box we support horizontal scal<small>...</small></p><div class=bottom><p></p><p class=post-type>Article</p></div></div></div></a></div><div class=grid__item><a href=/blog/2020/01/28/how-to-contribute-to-pmm-documentation/ class="post post--preview"><img src=/blog/2020/01/PMM-Contribute-10_hu2d1370e5d7c1f2b049ee07e895fe1e48_116388_682x384_fill_q90_bgffffff_lanczos_smart1_2.jpg alt><div class=post__text><h3>How To Contribute to PMM Documentation</h3><div class=post__content><p>We’d love to see more contributions towards the development and improvement of Percona Monitoring and Management (PMM), one of Percona’s most valued projects. Like all of Percona’s software, PMM is fr<small>...</small></p><div class=bottom><p></p><p class=post-type>Article</p></div></div></div></a></div></div></div></div></main><div class=img_banner><div class=img_banner__content><a href=https://www.perconalive.com/eSites/eventregistration/Homepage target=_blank><img style=width:100% src=/home/PL23-CFP-footer-web.jpg alt="Percona Live 2023 - CFP"></a></div></div><div class=edit-on-github><div class=container><a href=https://github.com/percona/community/edit/main/content/blog/2020-04-29-the-anatomy-of-luajit-tables-and-whats-special-about-them.md target=_blank rel="noreferrer noopener">✎ Edit this page on GitHub</a></div></div><footer class=page><p class=aria-only id=footer-heading aria-hidden=false>Footer</p><div class=page-footer><nav class=footer><div class=abc><ul><li><a href=https://www.percona.com/about-percona target=_blank rel=" noreferrer"><span>About</span></a></li><li><a href=https://www.percona.com/legal target=_blank rel=" noreferrer"><span>Legal</span></a></li><li><a href=https://www.percona.com/about-percona/contact target=_blank rel=" noreferrer"><span>Contact</span></a></li><li><a href=https://forums.percona.com target=_blank rel=" noreferrer"><span>Forums</span></a></li><li><a href=http://per.co.na/discord target=_blank rel=" noreferrer"><span>Discord</span></a></li><li><a href=/map><span>Sitemap</span></a></li><li><a class=cmp-revoke-consent style=padding-left:.75rem!important;padding-right:.75rem!important>Revoke Consent</a></li></ul></div></nav></div><div><aside>© Percona Community. MySQL, InnoDB, MariaDB and MongoDB are trademarks of their respective owners.</aside></div></footer><script type=text/javascript src=https://percona.community/js/aria.5f30892348d4662fe548bb410f15fc6fe2e1cbfd6473beb3c3ed1d6b362568bbea48896a9f2302a4f78f4614904ca3ef43155ae26f063ed84ae957f951e19647.js integrity="sha512-XzCJI0jUZi/lSLtBDxX8b+Lhy/1kc76zw+0dazYlaLvqSIlqnyMCpPePRhSQTKPvQxVa4m8GPthK6Vf5UeGWRw==" defer></script></body></html>